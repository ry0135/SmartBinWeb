Index: src/main/java/com/example/service/TasksService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.service;\r\n\r\nimport com.example.dto.TaskSummaryDTO;\r\nimport com.example.model.Account;\r\nimport com.example.model.Bin;\r\nimport com.example.model.Task;\r\nimport com.example.repository.AccountRepository;\r\nimport com.example.repository.BinRepository;\r\nimport com.example.repository.TasksRepository;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.stereotype.Service;\r\nimport org.springframework.transaction.annotation.Transactional;\r\nimport org.springframework.web.multipart.MultipartFile;\r\n\r\nimport java.util.*;\r\nimport java.util.stream.Collectors;\r\n\r\n@Service\r\n@Transactional\r\npublic class TasksService {\r\n\r\n    @Autowired\r\n    private TasksRepository taskRepository;\r\n\r\n    @Autowired\r\n    private AccountRepository accountRepository;\r\n\r\n    @Autowired\r\n    private AccountService accountService;\r\n\r\n\r\n    @Autowired\r\n    private FcmService fcmService;\r\n    @Autowired\r\n    private BinRepository binRepository;\r\n\r\n    // Giao nhiều task cùng lúc\r\n    @Transactional\r\n    public List<Task> assignMultipleTasks(List<Integer> binIds, int workerId,\r\n                                          String taskType, int priority, String notes) throws Exception {\r\n\r\n        Account worker = accountRepository.findById(workerId)\r\n                .orElseThrow(() -> new RuntimeException(\"Không tìm thấy worker với ID = \" + workerId));\r\n\r\n        // Tạo batch ID duy nhất\r\n        String batchId = \"BATCH_\" + System.currentTimeMillis() + \"_\" + new Random().nextInt(1000);\r\n\r\n        List<Task> assignedTasks = new ArrayList<>();\r\n\r\n        for (Integer binId : binIds) {\r\n            Bin bin = binRepository.findById(binId)\r\n                    .orElseThrow(() -> new RuntimeException(\"Không tìm thấy bin với ID = \" + binId));\r\n\r\n            // Kiểm tra nếu bin đã có task đang mở\r\n            if (taskRepository.countOpenTasksByBin(binId) > 0) {\r\n                continue; // Bỏ qua bin này\r\n            }\r\n\r\n            Task task = new Task();\r\n            task.setBin(bin);\r\n            task.setAssignedTo(worker);\r\n            task.setTaskType(taskType);\r\n            task.setPriority(priority);\r\n            task.setStatus(\"OPEN\");\r\n            task.setNotes(notes);\r\n            task.setBatchId(batchId);\r\n\r\n            assignedTasks.add(taskRepository.save(task));\r\n        }\r\n\r\n        if (!assignedTasks.isEmpty()) {\r\n            String token = accountService.getFcmTokenByWorkerId(workerId);\r\n            if (token != null && !token.isEmpty()) {\r\n                String title = \"Nhiệm vụ mới được giao\";\r\n                String body = notes;\r\n\r\n                fcmService.sendNotification(token, title, body,batchId);\r\n            }\r\n        }\r\n\r\n        return assignedTasks;\r\n    }\r\n\r\n    // Giao task đơn lẻ (giữ lại cho tương thích)\r\n    public Task assignTask(int binId, int workerId, String taskType, int priority, String notes) throws Exception {\r\n        List<Integer> binIds = Collections.singletonList(binId);\r\n        List<Task> tasks = assignMultipleTasks(binIds, workerId, taskType, priority, notes);\r\n        return tasks.isEmpty() ? null : tasks.get(0);\r\n    }\r\n\r\n    // Lấy danh sách task theo batch\r\n    public List<Task> getTasksByBatch(String batchId) {\r\n        return taskRepository.findByBatchId(batchId);\r\n    }\r\n\r\n    // Lấy danh sách nhân viên có thể giao task\r\n    public List<Account> getAvailableWorkers(int wardID) {\r\n        List<Account> workers = accountRepository.findWorkersByWard(wardID);\r\n\r\n        Map<Integer, Integer> workerTaskCount = new HashMap<>();\r\n        for (Account w : workers) {\r\n            int count = taskRepository.countOpenTasksByWorker(w.getAccountId());\r\n            workerTaskCount.put(w.getAccountId(), count);\r\n            w.setTaskCount(count);\r\n        }\r\n\r\n        workers.sort(Comparator.comparingInt(Account::getTaskCount));\r\n        return workers;\r\n    }\r\n    public List<Account> getAvailableWorkersMaintenance(int wardID) {\r\n        List<Account> workers = accountRepository.findWorkersByWardandrole4(wardID);\r\n\r\n        Map<Integer, Integer> workerTaskCount = new HashMap<>();\r\n        for (Account w : workers) {\r\n            int count = taskRepository.countOpenTasksByWorker(w.getAccountId());\r\n            workerTaskCount.put(w.getAccountId(), count);\r\n            w.setTaskCount(count);\r\n        }\r\n\r\n        workers.sort(Comparator.comparingInt(Account::getTaskCount));\r\n        return workers;\r\n    }\r\n\r\n    public int countOpenTasksByWorker(int workerId) {\r\n        return taskRepository.countOpenTasksByWorker(workerId);\r\n    }\r\n\r\n    public boolean hasOpenTask(int binId) {\r\n        return taskRepository.countOpenTasksByBin(binId) > 0;\r\n    }\r\n    public boolean hasRestrictedTask(int binId) {\r\n        return taskRepository.countTasksByBinExclude(binId) > 0;\r\n    }\r\n\r\n    // Lấy danh sách batch tóm tắt theo worker\r\n    public List<TaskSummaryDTO> getTaskSummaryByAssignedTo(int workerId) {\r\n        return taskRepository.findTaskSummaryByAssignedTo(workerId);\r\n    }\r\n\r\n    // Lấy chi tiết task trong batch\r\n    public List<Task> getTasksInBatch(int workerId, String batchId) {\r\n        return taskRepository.findByAssignedTo_AccountIdAndBatchIdOrderByPriorityAsc(workerId, batchId);\r\n    }\r\n    public List<Task> getAllTasks() {\r\n        return taskRepository.findAll();\r\n    }\r\n    public List<Task> getAllTasksDoing() {\r\n        return taskRepository.findAll();\r\n    }\r\n// Thêm vào TasksService.java\r\n\r\n    public void deleteBatch(String batchId) {\r\n        List<Task> batchTasks = taskRepository.findByBatchId(batchId);\r\n        taskRepository.deleteAll(batchTasks);\r\n    }\r\n\r\n    public void updateBatchStatus(String batchId, String status) {\r\n        List<Task> batchTasks = taskRepository.findByBatchId(batchId);\r\n        for (Task task : batchTasks) {\r\n            task.setStatus(status);\r\n            if (\"COMPLETED\".equals(status)) {\r\n                task.setCompletedAt(new Date());\r\n            }\r\n            taskRepository.save(task);\r\n        }\r\n    }\r\n\r\n    public void deleteTask(int taskId) {\r\n        taskRepository.deleteById(taskId);\r\n    }\r\n\r\n    // Thêm phương thức để lấy thông tin batch summary\r\n    public Map<String, Object> getBatchSummary(String batchId) {\r\n        List<Task> batchTasks = taskRepository.findByBatchId(batchId);\r\n        if (batchTasks.isEmpty()) {\r\n            return null;\r\n        }\r\n\r\n        Task firstTask = batchTasks.get(0);\r\n        Map<String, Object> summary = new HashMap<>();\r\n        summary.put(\"batchId\", batchId);\r\n        summary.put(\"totalTasks\", batchTasks.size());\r\n        summary.put(\"assignedTo\", firstTask.getAssignedTo().getFullName());\r\n        summary.put(\"taskType\", firstTask.getTaskType());\r\n        summary.put(\"createdAt\", firstTask.getCreatedAt());\r\n\r\n        // Thống kê status\r\n        Map<String, Long> statusCount = batchTasks.stream()\r\n                .collect(Collectors.groupingBy(Task::getStatus, Collectors.counting()));\r\n        summary.put(\"statusCount\", statusCount);\r\n\r\n        return summary;\r\n    }\r\n\r\n    // Thêm vào TasksService.java\r\n    public void updateTaskStatus(int taskId, String status) {\r\n        Task task = taskRepository.findById(taskId)\r\n                .orElseThrow(() -> new RuntimeException(\"Không tìm thấy task với ID = \" + taskId));\r\n        task.setStatus(status);\r\n        if (\"COMPLETED\".equals(status)) {\r\n            task.setCompletedAt(new Date());\r\n        }\r\n        taskRepository.save(task);\r\n    }\r\n\r\n    // Trong TasksService.java\r\n    public List<Task> getDoingTasks() {\r\n        return taskRepository.findDoingTasks();\r\n    }\r\n    public List<Task> getOpenTasks() {\r\n        return taskRepository.findOpenTasks();\r\n    }\r\n    public List<Task> getCompletedTasks() {\r\n        return taskRepository.findCompletedTasks();\r\n    }\r\n    public List<Task> getDoingTasksByWorker(int workerId) {\r\n        return taskRepository.findDoingTasksByWorker(workerId);\r\n    }\r\n\r\n    public List<Task> getDoingTasksByBatch(String batchId) {\r\n        return taskRepository.findDoingTasksByBatch(batchId);\r\n    }\r\n\r\n    // Lấy danh sách batch đang có task DOING\r\n    public Map<String, List<Task>> getDoingTasksGroupedByBatch() {\r\n        List<Task> doingTasks = taskRepository.findDoingTasks();\r\n      \r\n        // Nhóm task theo batchId\r\n        Map<String, List<Task>> tasksByBatch = doingTasks.stream()\r\n                .filter(task -> task.getBatchId() != null && !task.getBatchId().isEmpty())\r\n                .collect(Collectors.groupingBy(Task::getBatchId));\r\n\r\n        return tasksByBatch;\r\n    }\r\n  \r\n\r\n    // Thống kê doing tasks\r\n    public Map<String, Object> getDoingTasksStats() {\r\n        List<Task> doingTasks = taskRepository.findDoingTasks();\r\n\r\n        Map<String, Object> stats = new HashMap<>();\r\n        stats.put(\"totalDoingTasks\", doingTasks.size());\r\n\r\n        // Thống kê theo loại task\r\n        Map<String, Long> typeStats = doingTasks.stream()\r\n                .collect(Collectors.groupingBy(Task::getTaskType, Collectors.counting()));\r\n        stats.put(\"tasksByType\", typeStats);\r\n\r\n        // Thống kê theo độ ưu tiên\r\n        Map<Integer, Long> priorityStats = doingTasks.stream()\r\n                .collect(Collectors.groupingBy(Task::getPriority, Collectors.counting()));\r\n        stats.put(\"tasksByPriority\", priorityStats);\r\n\r\n        // Thống kê theo worker\r\n        Map<String, Long> workerStats = doingTasks.stream()\r\n                .filter(task -> task.getAssignedTo() != null)\r\n                .collect(Collectors.groupingBy(\r\n                        task -> task.getAssignedTo().getFullName(),\r\n                        Collectors.counting()\r\n                ));\r\n        stats.put(\"tasksByWorker\", workerStats);\r\n\r\n        return stats;\r\n    }\r\n  \r\n  \r\n   @Autowired\r\n    private FirebaseStorageService firebaseStorageService;\r\n\r\n    public String completeTask(Integer taskId, Double lat, Double lng, MultipartFile image) {\r\n        try {\r\n            // ✅ SỬA: Xử lý Optional đúng cách\r\n            Task task = taskRepository.findById(taskId)\r\n                    .orElseThrow(() -> new RuntimeException(\"Task không tồn tại với ID: \" + taskId));\r\n\r\n            // ✅ Validate ảnh\r\n            if (image == null || image.isEmpty()) {\r\n                throw new RuntimeException(\"Ảnh minh chứng không được để trống\");\r\n            }\r\n\r\n            // Upload ảnh lên Firebase\r\n            String imageUrl = firebaseStorageService.uploadFile(image, \"task/collect\");\r\n\r\n            // Cập nhật thông tin task\r\n            task.setAfterImage(imageUrl);\r\n            task.setCompletedAt(new Date());\r\n            task.setCompletedLat(lat);\r\n            task.setCompletedLng(lng);\r\n            task.setStatus(\"COMPLETED\");\r\n\r\n            taskRepository.save(task);\r\n\r\n            return \"✅ Hoàn thành nhiệm vụ thành công!\";\r\n\r\n        } catch (Exception e) {\r\n            throw new RuntimeException(\"❌ Lỗi: \" + e.getMessage());\r\n        }\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/service/TasksService.java b/src/main/java/com/example/service/TasksService.java
--- a/src/main/java/com/example/service/TasksService.java	(revision d5967c2b6ed473a29e85a3d5aec3773d786b9f66)
+++ b/src/main/java/com/example/service/TasksService.java	(date 1761374326114)
@@ -203,66 +203,7 @@
         taskRepository.save(task);
     }
 
-    // Trong TasksService.java
-    public List<Task> getDoingTasks() {
-        return taskRepository.findDoingTasks();
-    }
-    public List<Task> getOpenTasks() {
-        return taskRepository.findOpenTasks();
-    }
-    public List<Task> getCompletedTasks() {
-        return taskRepository.findCompletedTasks();
-    }
-    public List<Task> getDoingTasksByWorker(int workerId) {
-        return taskRepository.findDoingTasksByWorker(workerId);
-    }
 
-    public List<Task> getDoingTasksByBatch(String batchId) {
-        return taskRepository.findDoingTasksByBatch(batchId);
-    }
-
-    // Lấy danh sách batch đang có task DOING
-    public Map<String, List<Task>> getDoingTasksGroupedByBatch() {
-        List<Task> doingTasks = taskRepository.findDoingTasks();
-      
-        // Nhóm task theo batchId
-        Map<String, List<Task>> tasksByBatch = doingTasks.stream()
-                .filter(task -> task.getBatchId() != null && !task.getBatchId().isEmpty())
-                .collect(Collectors.groupingBy(Task::getBatchId));
-
-        return tasksByBatch;
-    }
-  
-
-    // Thống kê doing tasks
-    public Map<String, Object> getDoingTasksStats() {
-        List<Task> doingTasks = taskRepository.findDoingTasks();
-
-        Map<String, Object> stats = new HashMap<>();
-        stats.put("totalDoingTasks", doingTasks.size());
-
-        // Thống kê theo loại task
-        Map<String, Long> typeStats = doingTasks.stream()
-                .collect(Collectors.groupingBy(Task::getTaskType, Collectors.counting()));
-        stats.put("tasksByType", typeStats);
-
-        // Thống kê theo độ ưu tiên
-        Map<Integer, Long> priorityStats = doingTasks.stream()
-                .collect(Collectors.groupingBy(Task::getPriority, Collectors.counting()));
-        stats.put("tasksByPriority", priorityStats);
-
-        // Thống kê theo worker
-        Map<String, Long> workerStats = doingTasks.stream()
-                .filter(task -> task.getAssignedTo() != null)
-                .collect(Collectors.groupingBy(
-                        task -> task.getAssignedTo().getFullName(),
-                        Collectors.counting()
-                ));
-        stats.put("tasksByWorker", workerStats);
-
-        return stats;
-    }
-  
   
    @Autowired
     private FirebaseStorageService firebaseStorageService;
Index: src/main/java/com/example/controller/app/NotificationController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.controller.app;\r\n\r\nimport com.example.service.AccountService;\r\nimport com.example.service.FcmService;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.http.ResponseEntity;\r\nimport org.springframework.web.bind.annotation.*;\r\n\r\nimport java.util.HashMap;\r\nimport java.util.Map;\r\n\r\n@RestController\r\n@RequestMapping(\"/api/notify\")\r\npublic class NotificationController {\r\n    @Autowired\r\n    private final FcmService fcmService;\r\n    @Autowired\r\n    private final AccountService accountService;\r\n\r\n    public NotificationController(FcmService fcmService, AccountService accountService) {\r\n        this.fcmService = fcmService;\r\n        this.accountService = accountService;\r\n    }\r\n\r\n//    @PostMapping(\"/send\")\r\n//    public ResponseEntity<?> sendNotification(@RequestBody Map<String, String> payload) {\r\n//        try {\r\n//            int workerId = Integer.parseInt(payload.get(\"workerId\"));\r\n//            String title = payload.getOrDefault(\"title\", \"Thông báo mới\");\r\n//            String body = payload.getOrDefault(\"body\", \"Bạn có nhiệm vụ mới\");\r\n//\r\n//            String token = accountService.getFcmTokenByWorkerId(workerId);\r\n//            if (token == null || token.isEmpty()) {\r\n//                Map<String, Object> errorResponse = new HashMap<>();\r\n//                errorResponse.put(\"status\", \"error\");\r\n//                errorResponse.put(\"message\", \"Worker chưa có token\");\r\n//                return ResponseEntity.badRequest().body(errorResponse);\r\n//            }\r\n//\r\n//            String responseId = fcmService.sendNotification(token, title, body);\r\n//\r\n//            Map<String, Object> successResponse = new HashMap<>();\r\n//            successResponse.put(\"status\", \"success\");\r\n//            successResponse.put(\"messageId\", responseId);\r\n//\r\n//            return ResponseEntity.ok(successResponse);\r\n//        } catch (Exception e) {\r\n//            Map<String, Object> errorResponse = new HashMap<>();\r\n//            errorResponse.put(\"status\", \"error\");\r\n//            errorResponse.put(\"message\", e.getMessage());\r\n//            return ResponseEntity.internalServerError().body(errorResponse);\r\n//        }\r\n//    }\r\n\r\n}\r\n\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/controller/app/NotificationController.java b/src/main/java/com/example/controller/app/NotificationController.java
--- a/src/main/java/com/example/controller/app/NotificationController.java	(revision d5967c2b6ed473a29e85a3d5aec3773d786b9f66)
+++ b/src/main/java/com/example/controller/app/NotificationController.java	(date 1761372868400)
@@ -1,57 +1,57 @@
-package com.example.controller.app;
-
-import com.example.service.AccountService;
-import com.example.service.FcmService;
-import org.springframework.beans.factory.annotation.Autowired;
-import org.springframework.http.ResponseEntity;
-import org.springframework.web.bind.annotation.*;
-
-import java.util.HashMap;
-import java.util.Map;
-
-@RestController
-@RequestMapping("/api/notify")
-public class NotificationController {
-    @Autowired
-    private final FcmService fcmService;
-    @Autowired
-    private final AccountService accountService;
-
-    public NotificationController(FcmService fcmService, AccountService accountService) {
-        this.fcmService = fcmService;
-        this.accountService = accountService;
-    }
-
-//    @PostMapping("/send")
-//    public ResponseEntity<?> sendNotification(@RequestBody Map<String, String> payload) {
-//        try {
-//            int workerId = Integer.parseInt(payload.get("workerId"));
-//            String title = payload.getOrDefault("title", "Thông báo mới");
-//            String body = payload.getOrDefault("body", "Bạn có nhiệm vụ mới");
+//package com.example.controller.app;
 //
-//            String token = accountService.getFcmTokenByWorkerId(workerId);
-//            if (token == null || token.isEmpty()) {
-//                Map<String, Object> errorResponse = new HashMap<>();
-//                errorResponse.put("status", "error");
-//                errorResponse.put("message", "Worker chưa có token");
-//                return ResponseEntity.badRequest().body(errorResponse);
-//            }
+//import com.example.service.AccountService;
+//import com.example.service.FcmService;
+//import org.springframework.beans.factory.annotation.Autowired;
+//import org.springframework.http.ResponseEntity;
+//import org.springframework.web.bind.annotation.*;
 //
-//            String responseId = fcmService.sendNotification(token, title, body);
+//import java.util.HashMap;
+//import java.util.Map;
 //
-//            Map<String, Object> successResponse = new HashMap<>();
-//            successResponse.put("status", "success");
-//            successResponse.put("messageId", responseId);
+//@RestController
+//@RequestMapping("/api/notify")
+//public class NotificationController {
+//    @Autowired
+//    private final FcmService fcmService;
+//    @Autowired
+//    private final AccountService accountService;
 //
-//            return ResponseEntity.ok(successResponse);
-//        } catch (Exception e) {
-//            Map<String, Object> errorResponse = new HashMap<>();
-//            errorResponse.put("status", "error");
-//            errorResponse.put("message", e.getMessage());
-//            return ResponseEntity.internalServerError().body(errorResponse);
-//        }
-//    }
-
-}
-
-
+//    public NotificationController(FcmService fcmService, AccountService accountService) {
+//        this.fcmService = fcmService;
+//        this.accountService = accountService;
+//    }
+//
+////    @PostMapping("/send")
+////    public ResponseEntity<?> sendNotification(@RequestBody Map<String, String> payload) {
+////        try {
+////            int workerId = Integer.parseInt(payload.get("workerId"));
+////            String title = payload.getOrDefault("title", "Thông báo mới");
+////            String body = payload.getOrDefault("body", "Bạn có nhiệm vụ mới");
+////
+////            String token = accountService.getFcmTokenByWorkerId(workerId);
+////            if (token == null || token.isEmpty()) {
+////                Map<String, Object> errorResponse = new HashMap<>();
+////                errorResponse.put("status", "error");
+////                errorResponse.put("message", "Worker chưa có token");
+////                return ResponseEntity.badRequest().body(errorResponse);
+////            }
+////
+////            String responseId = fcmService.sendNotification(token, title, body);
+////
+////            Map<String, Object> successResponse = new HashMap<>();
+////            successResponse.put("status", "success");
+////            successResponse.put("messageId", responseId);
+////
+////            return ResponseEntity.ok(successResponse);
+////        } catch (Exception e) {
+////            Map<String, Object> errorResponse = new HashMap<>();
+////            errorResponse.put("status", "error");
+////            errorResponse.put("message", e.getMessage());
+////            return ResponseEntity.internalServerError().body(errorResponse);
+////        }
+////    }
+//
+//}
+//
+//
Index: .idea/shelf/Uncommitted_changes_before_Update_at_9_6_2025_8_04_PM__Changes_.xml
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_9_6_2025_8_04_PM__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_9_6_2025_8_04_PM__Changes_.xml
deleted file mode 100644
--- a/.idea/shelf/Uncommitted_changes_before_Update_at_9_6_2025_8_04_PM__Changes_.xml	(revision d5967c2b6ed473a29e85a3d5aec3773d786b9f66)
+++ /dev/null	(revision d5967c2b6ed473a29e85a3d5aec3773d786b9f66)
@@ -1,4 +0,0 @@
-<changelist name="Uncommitted_changes_before_Update_at_9_6_2025_8_04_PM_[Changes]" date="1757163930168" recycled="true" deleted="true">
-  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_9_6_2025_8_04_PM_[Changes]/shelved.patch" />
-  <option name="DESCRIPTION" value="Uncommitted changes before Update at 9/6/2025 8:04 PM [Changes]" />
-</changelist>
\ No newline at end of file
Index: .idea/shelf/Uncommitted_changes_before_Update_at_9_25_2025_10_44_PM_[Changes]/shelved.patch
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_9_25_2025_10_44_PM_[Changes]/shelved.patch b/.idea/shelf/Uncommitted_changes_before_Update_at_9_25_2025_10_44_PM_[Changes]/shelved.patch
new file mode 100644
--- /dev/null	(date 1761372868395)
+++ b/.idea/shelf/Uncommitted_changes_before_Update_at_9_25_2025_10_44_PM_[Changes]/shelved.patch	(date 1761372868395)
@@ -0,0 +1,56 @@
+Index: src/main/java/com/example/config/SecurityConfig.java
+===================================================================
+diff --git a/src/main/java/com/example/config/SecurityConfig.java b/src/main/java/com/example/config/SecurityConfig.java
+--- a/src/main/java/com/example/config/SecurityConfig.java	
++++ b/src/main/java/com/example/config/SecurityConfig.java	
+@@ -2,31 +2,39 @@
+ 
+ import org.springframework.context.annotation.Configuration;
+ import org.springframework.security.config.annotation.web.builders.HttpSecurity;
+-import org.springframework.security.config.annotation.web.configuration.*;
++import org.springframework.security.config.annotation.web.builders.WebSecurity;
++import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
++import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;
+ 
+-// Spring Security 5.5.x (Boot 2.5.6) vẫn dùng WebSecurityConfigurerAdapter được
+ @EnableWebSecurity
+ @Configuration
+ public class SecurityConfig extends WebSecurityConfigurerAdapter {
+ 
++    // ✅ Bỏ qua hoàn toàn cho static (nhanh & gọn)
++    @Override
++    public void configure(WebSecurity web) {
++        web.ignoring().antMatchers(
++                "/assets/**",   // chỗ chứa HopDong_SmartBin.docx
++                "/css/**", "/js/**", "/images/**", "/img/**", "/fonts/**", "/webjars/**"
++        );
++    }
++
+     @Override
+     protected void configure(HttpSecurity http) throws Exception {
+         http
+-                .csrf() // giữ CSRF
+-                .and()
++                .csrf().and()
+                 .authorizeRequests()
++                // ✅ Cho phép truy cập tự do (nếu không dùng web.ignoring thì vẫn nên permitAll)
+                 .antMatchers(
+-                        "/forgot-password", "/verify-code",
+-                        "/dev/mail-test",                // chỉ để test, xong thì xoá
+-                        "/css/**", "/js/**", "/images/**", "/img/**", "/webjars/**"
++                        "/assets/**",
++                        "/css/**", "/js/**", "/images/**", "/img/**", "/fonts/**", "/webjars/**",
++                        "/forgot-password", "/verify-code", "/dev/mail-test"
+                 ).permitAll()
+                 .anyRequest().authenticated()
+                 .and()
+                 .formLogin()
+-                .loginPage("/login")      // đổi path theo trang login của bạn nếu khác
+-                .permitAll()
++                .loginPage("/login").permitAll()
+                 .and()
+-                .logout()
+-                .permitAll();
++                .logout().permitAll();
+     }
+ }
Index: src/main/java/com/example/model/Task.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.model;\r\n\r\nimport com.fasterxml.jackson.annotation.JsonIgnoreProperties;\r\n\r\nimport javax.persistence.*;\r\nimport java.util.Date;\r\n\r\n@Entity\r\n@Table(name = \"Tasks\")\r\n@JsonIgnoreProperties({\"hibernateLazyInitializer\", \"handler\"})\r\npublic class Task {\r\n    @Id\r\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\r\n    @Column(name = \"TaskID\")\r\n    private int taskID;\r\n\r\n    @ManyToOne\r\n    @JoinColumn(name = \"BinID\")\r\n    private Bin bin;\r\n\r\n    @ManyToOne\r\n    @JoinColumn(name = \"AssignedTo\")\r\n    private Account assignedTo;\r\n\r\n    @Column(name = \"TaskType\")\r\n    private String taskType; // COLLECT, CLEAN, REPAIR\r\n\r\n    @Column(name = \"Priority\")\r\n    private int priority; // 1: High, 2: Medium, 3: Low\r\n\r\n    @Column(name = \"Status\")\r\n    private String status; // OPEN, DOING, COMPLETED, CANCELLED\r\n\r\n    @Column(name = \"Notes\", length = 500)\r\n    private String notes;\r\n\r\n    @Temporal(TemporalType.TIMESTAMP)\r\n    @Column(name = \"CreatedAt\")\r\n    private Date createdAt;\r\n\r\n    @Temporal(TemporalType.TIMESTAMP)\r\n    @Column(name = \"CompletedAt\")\r\n    private Date completedAt;\r\n\r\n    // Thêm trường mới cho giao nhiều task\r\n    @Column(name = \"BatchID\")\r\n    private String batchId; // ID để nhóm các task được giao cùng lúc\r\n\r\n    // Constructors\r\n    public Task() {\r\n        this.createdAt = new Date();\r\n        this.status = \"OPEN\";\r\n    }\r\n\r\n    // Getters and Setters\r\n    public int getTaskID() { return taskID; }\r\n    public void setTaskID(int taskID) { this.taskID = taskID; }\r\n\r\n    public Bin getBin() { return bin; }\r\n    public void setBin(Bin bin) { this.bin = bin; }\r\n\r\n    public Account getAssignedTo() { return assignedTo; }\r\n    public void setAssignedTo(Account assignedTo) { this.assignedTo = assignedTo; }\r\n\r\n    public String getTaskType() { return taskType; }\r\n    public void setTaskType(String taskType) { this.taskType = taskType; }\r\n\r\n    public int getPriority() { return priority; }\r\n    public void setPriority(int priority) { this.priority = priority; }\r\n\r\n    public String getStatus() { return status; }\r\n    public void setStatus(String status) { this.status = status; }\r\n\r\n    public String getNotes() { return notes; }\r\n    public void setNotes(String notes) { this.notes = notes; }\r\n\r\n    public Date getCreatedAt() { return createdAt; }\r\n    public void setCreatedAt(Date createdAt) { this.createdAt = createdAt; }\r\n\r\n    public Date getCompletedAt() { return completedAt; }\r\n    public void setCompletedAt(Date completedAt) { this.completedAt = completedAt; }\r\n\r\n    public String getBatchId() { return batchId; }\r\n    public void setBatchId(String batchId) { this.batchId = batchId; }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/model/Task.java b/src/main/java/com/example/model/Task.java
--- a/src/main/java/com/example/model/Task.java	(revision d5967c2b6ed473a29e85a3d5aec3773d786b9f66)
+++ b/src/main/java/com/example/model/Task.java	(date 1761373052562)
@@ -46,6 +46,16 @@
     @Column(name = "BatchID")
     private String batchId; // ID để nhóm các task được giao cùng lúc
 
+
+    @Column(name = "CompletedLat")
+    private Double completedLat;
+
+    @Column(name = "CompletedLng")
+    private Double completedLng;
+
+    @Column(name = "AfterImage", length = 500)
+    private String afterImage;
+
     // Constructors
     public Task() {
         this.createdAt = new Date();
@@ -82,4 +92,28 @@
 
     public String getBatchId() { return batchId; }
     public void setBatchId(String batchId) { this.batchId = batchId; }
+
+    public double getCompletedLat() {
+        return completedLat;
+    }
+
+    public void setCompletedLat(double completedLat) {
+        this.completedLat = completedLat;
+    }
+
+    public double getCompletedLng() {
+        return completedLng;
+    }
+
+    public void setCompletedLng(double completedLng) {
+        this.completedLng = completedLng;
+    }
+
+    public String getAfterImage() {
+        return afterImage;
+    }
+
+    public void setAfterImage(String afterImage) {
+        this.afterImage = afterImage;
+    }
 }
\ No newline at end of file
Index: pom.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>\r\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\"\r\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\">\r\n  <modelVersion>4.0.0</modelVersion>\r\n  <groupId>com.fsoft.ctc</groupId>\r\n  <artifactId>SmartBinWeb</artifactId>\r\n  <packaging>war</packaging>\r\n  <version>0.0.1-SNAPSHOT</version>\r\n  <name>JspServlet Maven Webapp</name>\r\n  <url>http://maven.apache.org</url>\r\n\r\n  <properties>\r\n    <java.version>1.8</java.version>\r\n    <spring.boot.version>2.5.6</spring.boot.version>\r\n  </properties>\r\n\r\n  <repositories>\r\n    <repository>\r\n      <id>central</id>\r\n      <url>https://repo.maven.apache.org/maven2</url>\r\n    </repository>\r\n\r\n    <repository>\r\n      <id>local-libs</id>\r\n      <url>file://${project.basedir}/libs</url>\r\n    </repository>\r\n  </repositories>\r\n\r\n  <dependencies>\r\n    <dependency>\r\n      <groupId>junit</groupId>\r\n      <artifactId>junit</artifactId>\r\n      <version>4.13.2</version>\r\n      <scope>test</scope>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>javax.servlet</groupId>\r\n      <artifactId>javax.servlet-api</artifactId>\r\n      <version>3.1.0</version>\r\n      <scope>provided</scope>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>jstl</groupId>\r\n      <artifactId>jstl</artifactId>\r\n      <version>1.2</version>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>javax.el</groupId>\r\n      <artifactId>javax.el-api</artifactId>\r\n      <version>3.0.0</version>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>org.apache.tomcat.embed</groupId>\r\n      <artifactId>tomcat-embed-jasper</artifactId>\r\n      <version>8.5.34</version>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>com.microsoft.sqlserver</groupId>\r\n      <artifactId>mssql-jdbc</artifactId>\r\n      <version>9.2.0.jre8</version>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>org.springframework.boot</groupId>\r\n      <artifactId>spring-boot-starter-web</artifactId>\r\n      <version>${spring.boot.version}</version>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>org.springframework.boot</groupId>\r\n      <artifactId>spring-boot-starter-data-jpa</artifactId>\r\n      <version>${spring.boot.version}</version>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>org.springframework.boot</groupId>\r\n      <artifactId>spring-boot-starter-validation</artifactId>\r\n      <version>${spring.boot.version}</version>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>org.hibernate</groupId>\r\n      <artifactId>hibernate-core</artifactId>\r\n      <version>5.4.30.Final</version>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>org.springframework.security</groupId>\r\n      <artifactId>spring-security-crypto</artifactId>\r\n      <version>5.5.2</version>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>javax.mail</groupId>\r\n      <artifactId>javax.mail-api</artifactId>\r\n      <version>1.6.2</version>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>com.sun.mail</groupId>\r\n      <artifactId>javax.mail</artifactId>\r\n      <version>1.6.2</version>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>org.springframework.boot</groupId>\r\n      <artifactId>spring-boot-starter-mail</artifactId>\r\n      <version>${spring.boot.version}</version>\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>commons-fileupload</groupId>\r\n      <artifactId>commons-fileupload</artifactId>\r\n      <version>1.4</version>\r\n    </dependency>\r\n    <!-- Apache Commons IO -->\r\n    <dependency>\r\n      <groupId>commons-io</groupId>\r\n      <artifactId>commons-io</artifactId>\r\n      <version>2.4</version>\r\n    </dependency>\r\n\r\n\r\n    <dependency>\r\n      <groupId>commons-fileupload</groupId>\r\n      <artifactId>commons-fileupload</artifactId>\r\n      <version>1.4</version>\r\n    </dependency>\r\n    <!-- Apache Commons IO -->\r\n    <dependency>\r\n      <groupId>commons-io</groupId>\r\n      <artifactId>commons-io</artifactId>\r\n      <version>2.4</version>\r\n    </dependency>\r\n\r\n\r\n    <dependency>\r\n      <groupId>com.fasterxml.jackson.core</groupId>\r\n      <artifactId>jackson-databind</artifactId>\r\n      <version>2.11.0</version> <!-- Kiểm tra phiên bản mới nhất -->\r\n    </dependency>\r\n\r\n\r\n    <dependency>\r\n      <groupId>org.apache.httpcomponents</groupId>\r\n      <artifactId>httpclient</artifactId>\r\n      <version>4.5.13</version> <!-- Kiểm tra phiên bản mới nhất -->\r\n    </dependency>\r\n\r\n    <dependency>\r\n      <groupId>com.google.code.gson</groupId>\r\n      <artifactId>gson</artifactId>\r\n      <version>2.8.6</version><!-- Nếu bạn sử dụng Gson -->\r\n    </dependency>\r\n    <!-- https://mvnrepository.com/artifact/com.googlecode.json-simple/json-simple -->\r\n    <dependency>\r\n      <groupId>com.googlecode.json-simple</groupId>\r\n      <artifactId>json-simple</artifactId>\r\n      <version>1.1.1</version>\r\n    </dependency>\r\n\r\n    <dependency>\r\n      <groupId>javax.servlet</groupId>\r\n      <artifactId>javax.servlet-api</artifactId>\r\n      <version>4.0.1</version><!-- Hoặc phiên bản khác tùy theo yêu cầu -->\r\n      <scope>provided</scope>\r\n    </dependency>\r\n\r\n    <dependency>\r\n      <groupId>org.springframework</groupId>\r\n      <artifactId>spring-core</artifactId>\r\n      <version>5.3.12</version> <!-- Kiểm tra phiên bản -->\r\n    </dependency>\r\n    <dependency>\r\n      <groupId>org.springframework</groupId>\r\n      <artifactId>spring-web</artifactId>\r\n      <version>5.3.12</version> <!-- Cùng phiên bản với spring-core -->\r\n    </dependency>\r\n\r\n    <dependency>\r\n      <groupId>org.springframework</groupId>\r\n      <artifactId>spring-websocket</artifactId>\r\n      <version>5.3.12</version> <!-- hoặc phiên bản tương tự -->\r\n    </dependency>\r\n\r\n    <dependency>\r\n      <groupId>org.springframework</groupId>\r\n      <artifactId>spring-messaging</artifactId>\r\n      <version>5.3.12</version>\r\n    </dependency>\r\n\r\n\r\n    <dependency>\r\n      <groupId>com.paypal.sdk</groupId>\r\n      <artifactId>rest-api-sdk</artifactId>\r\n      <version>1.14.0</version>\r\n    </dependency>\r\n\r\n    <!-- https://mvnrepository.com/artifact/com.google.cloud/google-cloud-storage -->\r\n    <dependency>\r\n      <groupId>com.google.cloud</groupId>\r\n      <artifactId>google-cloud-storage</artifactId>\r\n      <version>2.48.2</version>\r\n    </dependency>\r\n\r\n    <dependency>\r\n      <groupId>org.projectlombok</groupId>\r\n      <artifactId>lombok</artifactId>\r\n      <version>1.18.34</version>\r\n      <scope>provided</scope>\r\n    </dependency>\r\n\r\n\r\n    <dependency>\r\n      <groupId>com.google.firebase</groupId>\r\n      <artifactId>firebase-admin</artifactId>\r\n      <version>9.2.0</version>\r\n    </dependency>\r\n\r\n\r\n\r\n  </dependencies>\r\n\r\n\r\n  <build>\r\n    <plugins>\r\n      <plugin>\r\n        <groupId>org.apache.maven.plugins</groupId>\r\n        <artifactId>maven-war-plugin</artifactId>\r\n        <version>3.3.2</version>\r\n      </plugin>\r\n      <plugin>\r\n        <groupId>org.apache.maven.plugins</groupId>\r\n        <artifactId>maven-compiler-plugin</artifactId>\r\n        <version>3.8.1</version>\r\n        <configuration>\r\n          <source>${java.version}</source>\r\n          <target>${java.version}</target>\r\n          <encoding>UTF-8</encoding>\r\n        </configuration>\r\n      </plugin>\r\n    </plugins>\r\n    <finalName>SmartBin</finalName>\r\n  </build>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/pom.xml b/pom.xml
--- a/pom.xml	(revision d5967c2b6ed473a29e85a3d5aec3773d786b9f66)
+++ b/pom.xml	(date 1761372868396)
@@ -1,18 +1,19 @@
-
 <project xmlns="http://maven.apache.org/POM/4.0.0"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
-         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+         xsi:schemaLocation="
+         http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
   <modelVersion>4.0.0</modelVersion>
   <groupId>com.fsoft.ctc</groupId>
   <artifactId>SmartBinWeb</artifactId>
   <packaging>war</packaging>
   <version>0.0.1-SNAPSHOT</version>
-  <name>JspServlet Maven Webapp</name>
-  <url>http://maven.apache.org</url>
+  <name>SmartBinWeb</name>
 
   <properties>
     <java.version>1.8</java.version>
     <spring.boot.version>2.5.6</spring.boot.version>
+    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
+    <spring.framework.version>5.3.12</spring.framework.version>
   </properties>
 
   <repositories>
@@ -20,7 +21,6 @@
       <id>central</id>
       <url>https://repo.maven.apache.org/maven2</url>
     </repository>
-
     <repository>
       <id>local-libs</id>
       <url>file://${project.basedir}/libs</url>
@@ -28,16 +28,19 @@
   </repositories>
 
   <dependencies>
+    <!-- Test -->
     <dependency>
       <groupId>junit</groupId>
       <artifactId>junit</artifactId>
       <version>4.13.2</version>
       <scope>test</scope>
     </dependency>
+
+    <!-- Servlet/JSP/JSTL cho WAR (Tomcat cung cấp servlet API) -->
     <dependency>
       <groupId>javax.servlet</groupId>
       <artifactId>javax.servlet-api</artifactId>
-      <version>3.1.0</version>
+      <version>4.0.1</version>
       <scope>provided</scope>
     </dependency>
     <dependency>
@@ -50,20 +53,26 @@
       <artifactId>javax.el-api</artifactId>
       <version>3.0.0</version>
     </dependency>
-    <dependency>
-      <groupId>org.apache.tomcat.embed</groupId>
-      <artifactId>tomcat-embed-jasper</artifactId>
-      <version>8.5.34</version>
-    </dependency>
+
+    <!-- JDBC SQL Server -->
     <dependency>
       <groupId>com.microsoft.sqlserver</groupId>
       <artifactId>mssql-jdbc</artifactId>
       <version>9.2.0.jre8</version>
     </dependency>
+
+    <!-- Spring Boot starters (đảm bảo đồng bộ Spring 5.3.12) -->
     <dependency>
       <groupId>org.springframework.boot</groupId>
       <artifactId>spring-boot-starter-web</artifactId>
       <version>${spring.boot.version}</version>
+      <!-- WAR trên Tomcat ngoài: để tránh kéo Tomcat embedded -->
+      <exclusions>
+        <exclusion>
+          <groupId>org.springframework.boot</groupId>
+          <artifactId>spring-boot-starter-tomcat</artifactId>
+        </exclusion>
+      </exclusions>
     </dependency>
     <dependency>
       <groupId>org.springframework.boot</groupId>
@@ -76,15 +85,25 @@
       <version>${spring.boot.version}</version>
     </dependency>
     <dependency>
-      <groupId>org.hibernate</groupId>
-      <artifactId>hibernate-core</artifactId>
-      <version>5.4.30.Final</version>
+      <groupId>org.springframework.boot</groupId>
+      <artifactId>spring-boot-starter-mail</artifactId>
+      <version>${spring.boot.version}</version>
+    </dependency>
+    <!-- Security đầy đủ (thay vì tự ghép lẻ) -->
+    <dependency>
+      <groupId>org.springframework.boot</groupId>
+      <artifactId>spring-boot-starter-security</artifactId>
+      <version>${spring.boot.version}</version>
     </dependency>
+
+    <!-- Bcrypt (đã có trong starter-security, nhưng bạn đang dùng trực tiếp—giữ cũng không sao) -->
     <dependency>
       <groupId>org.springframework.security</groupId>
       <artifactId>spring-security-crypto</artifactId>
       <version>5.5.2</version>
     </dependency>
+
+    <!-- Mail javax (đã đủ qua starter-mail, giữ api + impl hiện tại vẫn OK) -->
     <dependency>
       <groupId>javax.mail</groupId>
       <artifactId>javax.mail-api</artifactId>
@@ -95,86 +114,79 @@
       <artifactId>javax.mail</artifactId>
       <version>1.6.2</version>
     </dependency>
-    <dependency>
-      <groupId>org.springframework.boot</groupId>
-      <artifactId>spring-boot-starter-mail</artifactId>
-      <version>${spring.boot.version}</version>
-    </dependency>
-    <dependency>
-      <groupId>commons-fileupload</groupId>
-      <artifactId>commons-fileupload</artifactId>
-      <version>1.4</version>
-    </dependency>
-    <!-- Apache Commons IO -->
-    <dependency>
-      <groupId>commons-io</groupId>
-      <artifactId>commons-io</artifactId>
-      <version>2.4</version>
-    </dependency>
-
-
+
+    <!-- Commons upload/IO (mỗi cái 1 bản, bỏ trùng) -->
     <dependency>
       <groupId>commons-fileupload</groupId>
       <artifactId>commons-fileupload</artifactId>
       <version>1.4</version>
     </dependency>
-    <!-- Apache Commons IO -->
     <dependency>
       <groupId>commons-io</groupId>
       <artifactId>commons-io</artifactId>
       <version>2.4</version>
     </dependency>
 
-
+    <!-- JSON libs theo bạn đang dùng -->
     <dependency>
       <groupId>com.fasterxml.jackson.core</groupId>
       <artifactId>jackson-databind</artifactId>
-      <version>2.11.0</version> <!-- Kiểm tra phiên bản mới nhất -->
+      <version>2.11.0</version>
     </dependency>
-
-
     <dependency>
       <groupId>org.apache.httpcomponents</groupId>
       <artifactId>httpclient</artifactId>
-      <version>4.5.13</version> <!-- Kiểm tra phiên bản mới nhất -->
+      <version>4.5.13</version>
     </dependency>
-
     <dependency>
       <groupId>com.google.code.gson</groupId>
       <artifactId>gson</artifactId>
-      <version>2.8.6</version><!-- Nếu bạn sử dụng Gson -->
+      <version>2.8.6</version>
     </dependency>
-    <!-- https://mvnrepository.com/artifact/com.googlecode.json-simple/json-simple -->
     <dependency>
       <groupId>com.googlecode.json-simple</groupId>
       <artifactId>json-simple</artifactId>
       <version>1.1.1</version>
     </dependency>
 
+    <!-- Google Cloud Storage (tuỳ dự án) -->
     <dependency>
-      <groupId>javax.servlet</groupId>
-      <artifactId>javax.servlet-api</artifactId>
-      <version>4.0.1</version><!-- Hoặc phiên bản khác tùy theo yêu cầu -->
+      <groupId>com.google.cloud</groupId>
+      <artifactId>google-cloud-storage</artifactId>
+      <version>2.48.2</version>
+    </dependency>
+
+    <!-- Lombok -->
+    <dependency>
+      <groupId>org.projectlombok</groupId>
+      <artifactId>lombok</artifactId>
+      <version>1.18.34</version>
       <scope>provided</scope>
     </dependency>
 
+    <!-- Ép spring-expression đúng bản (fix NoSuchMethodError) -->
     <dependency>
       <groupId>org.springframework</groupId>
-      <artifactId>spring-core</artifactId>
-      <version>5.3.12</version> <!-- Kiểm tra phiên bản -->
+      <artifactId>spring-expression</artifactId>
+      <version>5.3.12</version>
     </dependency>
     <dependency>
-      <groupId>org.springframework</groupId>
-      <artifactId>spring-web</artifactId>
-      <version>5.3.12</version> <!-- Cùng phiên bản với spring-core -->
+      <groupId>com.google.firebase</groupId>
+      <artifactId>firebase-admin</artifactId>
+      <version>9.2.0</version>
+    </dependency>
+    <!-- Taglibs cho JSP -->
+    <dependency>
+      <groupId>org.springframework.security</groupId>
+      <artifactId>spring-security-taglibs</artifactId>
+      <version>5.7.11</version> <!-- hoặc cùng version với các spring-security khác trong dự án -->
     </dependency>
-
+    <!-- WebSocket & Messaging (TRỰC TIẾP, KHÔNG scope=provided) -->
     <dependency>
       <groupId>org.springframework</groupId>
       <artifactId>spring-websocket</artifactId>
-      <version>5.3.12</version> <!-- hoặc phiên bản tương tự -->
+      <version>5.3.12</version>
     </dependency>
-
     <dependency>
       <groupId>org.springframework</groupId>
       <artifactId>spring-messaging</artifactId>
@@ -182,45 +194,19 @@
     </dependency>
 
 
-    <dependency>
-      <groupId>com.paypal.sdk</groupId>
-      <artifactId>rest-api-sdk</artifactId>
-      <version>1.14.0</version>
-    </dependency>
-
-    <!-- https://mvnrepository.com/artifact/com.google.cloud/google-cloud-storage -->
-    <dependency>
-      <groupId>com.google.cloud</groupId>
-      <artifactId>google-cloud-storage</artifactId>
-      <version>2.48.2</version>
-    </dependency>
-
-    <dependency>
-      <groupId>org.projectlombok</groupId>
-      <artifactId>lombok</artifactId>
-      <version>1.18.34</version>
-      <scope>provided</scope>
-    </dependency>
-
-
-    <dependency>
-      <groupId>com.google.firebase</groupId>
-      <artifactId>firebase-admin</artifactId>
-      <version>9.2.0</version>
-    </dependency>
+
+
+
+
+
 
 
 
   </dependencies>
 
-
   <build>
+    <finalName>SmartBinWeb</finalName>
     <plugins>
-      <plugin>
-        <groupId>org.apache.maven.plugins</groupId>
-        <artifactId>maven-war-plugin</artifactId>
-        <version>3.3.2</version>
-      </plugin>
       <plugin>
         <groupId>org.apache.maven.plugins</groupId>
         <artifactId>maven-compiler-plugin</artifactId>
@@ -231,7 +217,11 @@
           <encoding>UTF-8</encoding>
         </configuration>
       </plugin>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-war-plugin</artifactId>
+        <version>3.3.2</version>
+      </plugin>
     </plugins>
-    <finalName>SmartBin</finalName>
   </build>
 </project>
\ No newline at end of file
Index: src/main/java/com/example/controller/HomeController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.controller;\r\n\r\nimport org.springframework.stereotype.Controller;\r\nimport org.springframework.web.bind.annotation.RequestMapping;\r\n\r\n@Controller\r\npublic class HomeController {\r\n\r\n    @RequestMapping(\"/home\")\r\n    public String Homepage() {\r\n        return \"home\";\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/controller/HomeController.java b/src/main/java/com/example/controller/HomeController.java
--- a/src/main/java/com/example/controller/HomeController.java	(revision d5967c2b6ed473a29e85a3d5aec3773d786b9f66)
+++ b/src/main/java/com/example/controller/HomeController.java	(date 1761372868400)
@@ -8,6 +8,6 @@
 
     @RequestMapping("/home")
     public String Homepage() {
-        return "home";
+        return "manager/header_manager";
     }
 }
\ No newline at end of file
Index: src/main/webapp/WEB-INF/views/index.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/WEB-INF/views/index.jsp b/src/main/webapp/WEB-INF/views/index.jsp
new file mode 100644
--- /dev/null	(date 1761372868407)
+++ b/src/main/webapp/WEB-INF/views/index.jsp	(date 1761372868407)
@@ -0,0 +1,46 @@
+<!doctype html>
+<html lang="en">
+<head>
+    <meta charset="utf-8">
+    <meta name="viewport" content="width=device-width, initial-scale=1">
+
+    <meta name="description" content="">
+    <meta name="author" content="">
+
+    <title>Tooplate's Little Fashion</title>
+
+    <!-- CSS FILES -->
+    <link rel="preconnect" href="https://fonts.googleapis.com">
+
+    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
+
+    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;300;400;700;900&display=swap" rel="stylesheet">
+
+    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
+    <link href="assets/css/bootstrap-icons.css" rel="stylesheet">
+
+    <link rel="stylesheet" href="assets/css/slick.css"/>
+
+    <link href="assets/css/tooplate-little-fashion.css" rel="stylesheet">
+    <!--
+
+    Tooplate 2127 Little Fashion
+
+    https://www.tooplate.com/view/2127-little-fashion
+
+    -->
+</head>
+
+<body>
+
+
+<!-- JAVASCRIPT FILES -->
+<script src="assets/js/jquery.min.js"></script>
+<script src="assets/js/bootstrap.bundle.min.js"></script>
+<script src="assets/js/Headroom.js"></script>
+<script src="assets/js/jQuery.headroom.js"></script>
+<script src="assets/js/slick.min.js"></script>
+<script src="assets/js/custom.js"></script>
+
+</body>
+</html>
Index: src/main/webapp/WEB-INF/views/admin/accounts.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/WEB-INF/views/admin/accounts.jsp b/src/main/webapp/WEB-INF/views/admin/accounts.jsp
new file mode 100644
--- /dev/null	(date 1761372868404)
+++ b/src/main/webapp/WEB-INF/views/admin/accounts.jsp	(date 1761372868404)
@@ -0,0 +1,190 @@
+<%@ page contentType="text/html;charset=UTF-8" %>
+<%@ taglib prefix="c"   uri="http://java.sun.com/jsp/jstl/core" %>
+<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
+<%@ taglib prefix="fn"  uri="http://java.sun.com/jsp/jstl/functions" %>
+<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags" %>
+<!DOCTYPE html>
+<html lang="vi">
+<head>
+  <title>Quản trị tài khoản</title>
+  <meta name="viewport" content="width=device-width, initial-scale=1"/>
+  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
+  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet"/>
+
+  <style>
+    :root{
+      --primary-green:#22c55e; --secondary-green:#16a34a;
+      --light-green:#f0fdf4; --border-green:#bbf7d0;
+      --text-green:#166534; --muted:#6b7280;
+    }
+    .sb-card{border:1px solid var(--border-green);border-radius:16px;overflow:hidden;background:#fff}
+    .sb-card .card-header{background:var(--light-green);border-bottom:1px solid var(--border-green)}
+    .btn-apply{background:var(--primary-green);color:#fff;border-color:var(--secondary-green)}
+    .btn-apply:hover{background:var(--secondary-green);color:#fff}
+    .role-stack > .sb-card{margin-bottom:18px} /* xếp DỌC */
+  </style>
+</head>
+<body>
+<jsp:include page="header_admin.jsp"/>
+
+<div class="container my-4" style="max-width:1200px;">
+  <h3 class="mb-2"><i class="fa-solid fa-users-gear text-success me-2"></i>Quản trị tài khoản</h3>
+
+
+  <!-- Flash -->
+  <c:if test="${not empty success}">
+    <div class="alert alert-success alert-dismissible fade show" role="alert">
+      <i class="fa-solid fa-check-circle me-2"></i>${success}
+      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
+    </div>
+  </c:if>
+  <c:if test="${not empty error}">
+    <div class="alert alert-danger alert-dismissible fade show" role="alert">
+      <i class="fa-solid fa-circle-exclamation me-2"></i>${error}
+      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
+    </div>
+  </c:if>
+
+  <!-- Filter -->
+  <form class="row g-2 mb-3" method="get" action="${pageContext.request.contextPath}/admin/accounts">
+    <div class="col-12 col-md-3">
+      <label class="form-label">Trạng thái</label>
+      <select class="form-select" name="status">
+        <option value=""  <c:if test="${status == null}">selected</c:if>>All</option>
+        <option value="1" <c:if test="${status == 1}">selected</c:if>>Active</option>
+        <option value="0" <c:if test="${status == 0}">selected</c:if>>Banned</option>
+      </select>
+    </div>
+    <div class="col-12 col-md-6">
+      <label class="form-label">Tìm (Email/Tên)</label>
+      <input class="form-control" name="q" value="${fn:escapeXml(q)}" placeholder="Nhập email hoặc tên người dùng..."/>
+    </div>
+    <div class="col-12 col-md-3 d-flex align-items-end gap-2">
+      <button class="btn btn-apply w-50" type="submit"><i class="fa-solid fa-filter me-1"></i>Apply</button>
+      <a class="btn btn-outline-success w-50" href="${pageContext.request.contextPath}/admin/accounts">
+        <i class="fa-solid fa-rotate-left me-1"></i>Reset
+      </a>
+    </div>
+  </form>
+
+  <!-- 3 khung xếp DỌC -->
+  <div class="role-stack">
+
+    <!-- MANAGERS -->
+    <div class="sb-card" id="managers">
+      <div class="card-header d-flex justify-content-between align-items-center px-3 py-2">
+        <strong><i class="fa-solid fa-user-tie me-2"></i>Managers</strong>
+        <span class="text-muted">Tổng: ${managers.totalElements}</span>
+      </div>
+      <div class="card-body p-0">
+        <jsp:include page="accounts-role-table.jsp">
+          <jsp:param name="baseUrl" value="${pageContext.request.contextPath}/admin/accounts/managers"/>
+          <jsp:param name="pageObj" value="managers"/>
+          <jsp:param name="anchor"  value="managers"/>
+        </jsp:include>
+      </div>
+    </div>
+
+    <!-- WORKERS -->
+    <div class="sb-card" id="workers">
+      <div class="card-header d-flex justify-content-between align-items-center px-3 py-2">
+        <strong><i class="fa-solid fa-people-group me-2"></i>Workers</strong>
+        <span class="text-muted">Tổng: ${workers.totalElements}</span>
+      </div>
+      <div class="card-body p-0">
+        <jsp:include page="accounts-role-table.jsp">
+          <jsp:param name="baseUrl" value="${pageContext.request.contextPath}/admin/accounts/workers"/>
+          <jsp:param name="pageObj" value="workers"/>
+          <jsp:param name="anchor"  value="workers"/>
+        </jsp:include>
+      </div>
+    </div>
+
+    <!-- USERS -->
+    <div class="sb-card" id="users">
+      <div class="card-header d-flex justify-content-between align-items-center px-3 py-2">
+        <strong><i class="fa-solid fa-user me-2"></i>Users</strong>
+        <span class="text-muted">Tổng: ${users.totalElements}</span>
+      </div>
+      <div class="card-body p-0">
+        <jsp:include page="accounts-role-table.jsp">
+          <jsp:param name="baseUrl" value="${pageContext.request.contextPath}/admin/accounts/users"/>
+          <jsp:param name="pageObj" value="users"/>
+          <jsp:param name="anchor"  value="users"/>
+        </jsp:include>
+      </div>
+    </div>
+
+  </div>
+</div>
+
+<!-- ===== Modal BAN dùng CHUNG (chỉ 1 cái) ===== -->
+<div class="modal fade" id="banModal" tabindex="-1" aria-hidden="true">
+  <div class="modal-dialog">
+    <form id="banForm" class="modal-content" method="post" action="">
+      <div class="modal-header">
+        <h5 class="modal-title"><i class="fa-solid fa-triangle-exclamation text-warning me-2"></i>Ban tài khoản</h5>
+        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
+      </div>
+
+      <div class="modal-body">
+        <div class="mb-2 text-muted" id="banTargetInfo"></div>
+        <label class="form-label">Lý do (tối thiểu 10 ký tự)</label>
+        <textarea class="form-control" name="reason" rows="4" minlength="10" required></textarea>
+      </div>
+
+      <div class="modal-footer">
+        <sec:csrfInput/>
+        <!-- giữ filter hiện tại -->
+        <c:if test="${status != null}">
+          <input type="hidden" name="status" value="${status}"/>
+        </c:if>
+        <c:if test="${not empty q}">
+          <input type="hidden" name="q" value="${fn:escapeXml(q)}"/>
+        </c:if>
+
+        <!-- chỗ để script bơm hidden pageM/pageW/pageU -->
+        <span id="banExtra"></span>
+
+        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Hủy</button>
+        <button type="submit" class="btn btn-danger"><i class="fa-solid fa-ban me-1"></i>Xác nhận Ban</button>
+      </div>
+    </form>
+  </div>
+</div>
+
+<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
+<script>
+  // Modal dùng chung – lấy dữ liệu từ nút đã click
+  document.addEventListener('DOMContentLoaded', function () {
+    var modalEl = document.getElementById('banModal');
+    if (!modalEl) return;
+
+    modalEl.addEventListener('show.bs.modal', function (e) {
+      var btn   = e.relatedTarget;           // nút Ban vừa click
+      if (!btn) return;
+
+      var id    = btn.getAttribute('data-id');
+      var name  = btn.getAttribute('data-name') || ('#' + id);
+      var base  = btn.getAttribute('data-base');   // /admin/accounts/{role}
+      var role  = btn.getAttribute('data-role');   // managers | workers | users
+      var page  = btn.getAttribute('data-page');   // số trang hiện tại của cột đó
+
+      // cập nhật UI + action
+      document.getElementById('banTargetInfo').textContent = 'ID: ' + id + ' • ' + name + ' • ' + role;
+      document.getElementById('banForm').action = base + '/' + id + '/ban';
+
+      // bơm hidden pageX tương ứng để giữ pagination
+      var extra = document.getElementById('banExtra');
+      extra.innerHTML = '';
+      if (role === 'managers') extra.innerHTML = '<input type="hidden" name="pageM" value="'+page+'">';
+      if (role === 'workers')  extra.innerHTML = '<input type="hidden" name="pageW" value="'+page+'">';
+      if (role === 'users')    extra.innerHTML = '<input type="hidden" name="pageU" value="'+page+'">';
+
+      // reset textarea
+      modalEl.querySelector('textarea[name="reason"]').value = '';
+    });
+  });
+</script>
+</body>
+</html>
Index: src/main/webapp/WEB-INF/views/admin/accounts-role-table.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/WEB-INF/views/admin/accounts-role-table.jsp b/src/main/webapp/WEB-INF/views/admin/accounts-role-table.jsp
new file mode 100644
--- /dev/null	(date 1761372868404)
+++ b/src/main/webapp/WEB-INF/views/admin/accounts-role-table.jsp	(date 1761372868404)
@@ -0,0 +1,132 @@
+<%@ page contentType="text/html;charset=UTF-8" %>
+<%@ taglib prefix="c"   uri="http://java.sun.com/jsp/jstl/core" %>
+<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
+<%@ taglib prefix="fn"  uri="http://java.sun.com/jsp/jstl/functions" %>
+
+<%-- Lấy Page<Account> theo tên đối tượng truyền từ file cha --%>
+<c:set var="accPage" value="${requestScope[param.pageObj]}"/>
+
+<style>
+  .table thead th{font-weight:700;color:#166534}
+  .badge-active{background:#22c55e}.badge-banned{background:#9ca3af}
+  .btn-ban{background:#ef4444;color:#fff;border:none}.btn-ban:hover{background:#dc2626}
+  .btn-unban{background:#22c55e;color:#fff;border:none}.btn-unban:hover{background:#16a34a}
+</style>
+
+<div class="table-responsive">
+  <table class="table table-hover align-middle mb-0">
+    <thead class="table-light">
+    <tr>
+      <th style="width:90px;">ID</th>
+      <th>Họ tên</th>
+      <th>Email</th>
+      <th style="width:120px;">Trạng thái</th>
+      <th style="width:170px;">Tạo lúc</th>
+      <th style="width:170px;">Thao tác</th>
+    </tr>
+    </thead>
+    <tbody>
+    <c:forEach var="a" items="${accPage.content}">
+      <tr>
+        <td><span class="fw-bold">${a.accountId}</span></td>
+        <td>${a.fullName}</td>
+        <td>${a.email}</td>
+        <td>
+          <c:choose>
+            <c:when test="${a.status == 1}">
+              <span class="badge badge-active">Active</span>
+            </c:when>
+            <c:otherwise>
+              <span class="badge badge-banned">Banned</span>
+            </c:otherwise>
+          </c:choose>
+        </td>
+        <td><fmt:formatDate value="${a.createdAt}" pattern="yyyy-MM-dd HH:mm"/></td>
+        <td>
+          <c:choose>
+            <c:when test="${a.status == 1}">
+              <!-- NÚT BAN: chỉ mở modal dùng chung; truyền data-* đầy đủ -->
+              <button type="button"
+                      class="btn btn-sm btn-ban"
+                      data-bs-toggle="modal"
+                      data-bs-target="#banModal"
+                      data-id="${a.accountId}"
+                      data-name="${fn:escapeXml(a.fullName)}"
+                      data-base="${param.baseUrl}"
+                      data-role="${param.pageObj}"
+                      data-page="${accPage.number}">
+                <i class="fa-solid fa-ban me-1"></i>Ban
+              </button>
+            </c:when>
+            <c:otherwise>
+              <!-- Unban submit trực tiếp -->
+              <form method="post" action="${param.baseUrl}/${a.accountId}/unban" style="display:inline;">
+                <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
+                <c:if test="${status != null}"><input type="hidden" name="status" value="${status}"/></c:if>
+                <c:if test="${not empty q}"><input type="hidden" name="q" value="${fn:escapeXml(q)}"/></c:if>
+                <c:choose>
+                  <c:when test="${param.pageObj=='managers'}"><input type="hidden" name="pageM" value="${accPage.number}"/></c:when>
+                  <c:when test="${param.pageObj=='workers'}"><input type="hidden" name="pageW" value="${accPage.number}"/></c:when>
+                  <c:when test="${param.pageObj=='users'}"><input type="hidden" name="pageU" value="${accPage.number}"/></c:when>
+                </c:choose>
+                <button type="submit" class="btn btn-sm btn-unban">
+                  <i class="fa-solid fa-check me-1"></i>Unban
+                </button>
+              </form>
+            </c:otherwise>
+          </c:choose>
+        </td>
+      </tr>
+    </c:forEach>
+
+    <c:if test="${empty accPage.content}">
+      <tr>
+        <td colspan="6" class="text-center text-muted py-4">Không có dữ liệu</td>
+      </tr>
+    </c:if>
+    </tbody>
+  </table>
+</div>
+
+<c:if test="${accPage.totalPages > 1}">
+  <nav class="p-3">
+    <ul class="pagination mb-0 justify-content-center">
+      <c:set var="base" value='${pageContext.request.contextPath}/admin/accounts' />
+      <li class="page-item ${accPage.first ? 'disabled' : ''}">
+        <a class="page-link"
+           href="${base}
+                 ?pageM=${param.pageObj=='managers'? accPage.number-1 : param.pageM!=null?param.pageM:0}
+                 &pageW=${param.pageObj=='workers' ? accPage.number-1 : param.pageW!=null?param.pageW:0}
+                 &pageU=${param.pageObj=='users'   ? accPage.number-1 : param.pageU!=null?param.pageU:0}
+                 <c:if test='${status != null}'>&status=${status}</c:if>
+                 <c:if test='${not empty q}'>&q=${fn:escapeXml(q)}</c:if>#${param.anchor}">
+          «
+        </a>
+      </li>
+      <c:forEach var="i" begin="0" end="${accPage.totalPages - 1}">
+        <li class="page-item ${i == accPage.number ? 'active' : ''}">
+          <a class="page-link"
+             href="${base}
+                   ?pageM=${param.pageObj=='managers'? i : param.pageM!=null?param.pageM:0}
+                   &pageW=${param.pageObj=='workers' ? i : param.pageW!=null?param.pageW:0}
+                   &pageU=${param.pageObj=='users'   ? i : param.pageU!=null?param.pageU:0}
+                   <c:if test='${status != null}'>&status=${status}</c:if>
+                   <c:if test='${not empty q}'>&q=${fn:escapeXml(q)}</c:if>#${param.anchor}">
+              ${i + 1}
+          </a>
+        </li>
+      </c:forEach>
+      <li class="page-item ${accPage.last ? 'disabled' : ''}">
+        <a class="page-link"
+           href="${base}
+                 ?pageM=${param.pageObj=='managers'? accPage.number+1 : param.pageM!=null?param.pageM:0}
+                 &pageW=${param.pageObj=='workers' ? accPage.number+1 : param.pageW!=null?param.pageW:0}
+                 &pageU=${param.pageObj=='users'   ? accPage.number+1 : param.pageU!=null?param.pageU:0}
+                 <c:if test='${status != null}'>&status=${status}</c:if>
+                 <c:if test='${not empty q}'>&q=${fn:escapeXml(q)}</c:if>#${param.anchor}">
+          »
+        </a>
+      </li>
+    </ul>
+  </nav>
+</c:if>
Index: src/main/webapp/WEB-INF/views/admin/application-detail.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/WEB-INF/views/admin/application-detail.jsp b/src/main/webapp/WEB-INF/views/admin/application-detail.jsp
new file mode 100644
--- /dev/null	(date 1761372868405)
+++ b/src/main/webapp/WEB-INF/views/admin/application-detail.jsp	(date 1761372868405)
@@ -0,0 +1,288 @@
+<%@ page contentType="text/html;charset=UTF-8" language="java" %>
+<%@ taglib prefix="c"   uri="http://java.sun.com/jsp/jstl/core" %>
+<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"  %>
+<!DOCTYPE html>
+<html lang="vi">
+<head>
+    <meta charset="UTF-8"/>
+    <title>Chi tiết đơn đăng ký - SmartBin (Admin)</title>
+    <meta name="viewport" content="width=device-width, initial-scale=1">
+
+    <!-- Bootstrap & Icons & Font -->
+    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
+    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
+    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
+
+    <style>
+        :root{
+            --primary-green:#22c55e;
+            --secondary-green:#16a34a;
+            --light-green:#f0fdf4;
+            --border-green:#d1fae5;
+            --text-green:#166534;
+            --muted-green:#6b7280;
+            --white:#ffffff;
+            --border-gray:#e5e7eb;
+            --text-dark:#111827;
+        }
+        *{ box-sizing: border-box; }
+        html, body{ height:100%; }
+        body{
+            margin:0; font-family:'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
+            background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 40%, #d1fae5 100%);
+            color: var(--text-dark);
+        }
+        /* Background pattern */
+        .background-pattern{
+            position: fixed; inset: 0; z-index: -1;
+            background-image:
+                    radial-gradient(circle at 25% 25%, rgba(34,197,94,0.10) 0%, transparent 50%),
+                    radial-gradient(circle at 75% 75%, rgba(16,185,129,0.08) 0%, transparent 50%),
+                    radial-gradient(circle at 50% 50%, rgba(34,197,94,0.05) 0%, transparent 70%);
+            background-size: 600px 600px, 800px 800px, 1000px 1000px;
+            animation: float 20s ease-in-out infinite;
+        }
+        @keyframes float{
+            0%,100%{ transform: translate(0,0) rotate(0); }
+            33%{ transform: translate(30px,-30px) rotate(1deg); }
+            66%{ transform: translate(-20px,20px) rotate(-1deg); }
+        }
+
+        /* Wrapper & card */
+        .page-wrap{ padding: 24px; }
+        .sb-card{
+            background: var(--white);
+            border: 1px solid var(--border-gray);
+            border-radius: 20px;
+            box-shadow: 0 20px 25px -5px rgba(0,0,0,.1), 0 10px 10px -5px rgba(0,0,0,.04);
+            padding: 24px;
+            position: relative; overflow: hidden;
+        }
+        .sb-card::before{
+            content:''; position:absolute; top:0; left:0; right:0; height:4px;
+            background: linear-gradient(90deg, var(--primary-green), var(--secondary-green));
+        }
+
+        /* Header */
+        .title{
+            margin:0; letter-spacing:-.02em; font-weight:700;
+        }
+        .muted{ color: var(--muted-green); }
+
+        /* Badge trạng thái */
+        .badge-pill{ border-radius:999px; padding:.35rem .6rem; font-weight:600; }
+        .badge-pending{ background:#fef3c7; color:#92400e; border:1px solid #fde68a; }
+        .badge-approved{ background:#dcfce7; color:#166534; border:1px solid #86efac; }
+        .badge-rejected{ background:#fee2e2; color:#991b1b; border:1px solid #fecaca; }
+
+        /* Table detail */
+        .detail-table th{
+            width: 220px; background:#f9fafb; color:#374151; font-weight:600;
+            border-bottom:1px solid var(--border-gray);
+        }
+        .detail-table td{
+            border-bottom:1px solid var(--border-gray);
+        }
+
+        /* Buttons */
+        .btn-success{
+            --bs-btn-bg: var(--primary-green);
+            --bs-btn-border-color: var(--primary-green);
+            --bs-btn-hover-bg: var(--secondary-green);
+            --bs-btn-hover-border-color: var(--secondary-green);
+            border-radius:10px; font-weight:600;
+        }
+        .btn-danger{ border-radius:10px; font-weight:600; }
+        .btn-outline-primary, .btn-outline-secondary{ border-radius:10px; }
+
+        /* Alerts */
+        .alert{ border-radius:10px; border:none; }
+        .alert-success{ background:var(--light-green); color:var(--text-green); border:1px solid var(--border-green); }
+        .alert-warning{ background:#fff7ed; color:#9a3412; border:1px solid #fed7aa; }
+        .alert-danger{ background:#fef2f2; color:#b91c1c; border:1px solid #fecaca; }
+
+        @media (max-width: 768px){
+            .page-wrap{ padding: 16px; }
+            .sb-card{ padding: 16px; border-radius: 16px; }
+        }
+    </style>
+</head>
+<body>
+<div class="background-pattern"></div>
+
+<jsp:include page="header_admin.jsp"/>
+
+<div class="page-wrap container" style="max-width: 920px;">
+    <!-- Banner trạng thái & tiêu đề -->
+    <div class="sb-card mb-4">
+        <div class="d-flex align-items-start justify-content-between flex-wrap gap-3">
+            <div>
+                <h3 class="title">Chi tiết đơn #<c:out value="${app.applicationId}"/></h3>
+                <div class="muted">
+                    Nộp lúc
+                    <strong><fmt:formatDate value="${app.createdAt}" pattern="dd/MM/yyyy HH:mm"/></strong>
+                </div>
+            </div>
+            <div>
+                <c:choose>
+                    <c:when test="${app.status == 0}">
+                        <span class="badge-pill badge-pending"><i class="bi bi-hourglass-split"></i> Pending</span>
+                    </c:when>
+                    <c:when test="${app.status == 2}">
+                        <span class="badge-pill badge-approved"><i class="bi bi-check2-circle"></i> Approved</span>
+                    </c:when>
+                    <c:when test="${app.status == 3}">
+                        <span class="badge-pill badge-rejected"><i class="bi bi-x-circle"></i> Rejected</span>
+                    </c:when>
+                    <c:otherwise>
+                        <span class="badge-pill badge-pending">Trạng thái: ${app.status}</span>
+                    </c:otherwise>
+                </c:choose>
+            </div>
+        </div>
+
+        <!-- Alerts -->
+        <c:if test="${not empty param.approved}">
+            <div class="alert alert-success mt-3 mb-0" role="alert">
+                <i class="bi bi-check-circle-fill me-2"></i>Đã approve và tạo account Manager.
+            </div>
+        </c:if>
+        <c:if test="${not empty param.rejected}">
+            <div class="alert alert-warning mt-3 mb-0" role="alert">
+                <i class="bi bi-exclamation-triangle-fill me-2"></i>Đã từ chối đơn đăng ký.
+            </div>
+        </c:if>
+        <c:if test="${not empty error}">
+            <div class="alert alert-danger mt-3 mb-0" role="alert">
+                <i class="bi bi-x-octagon-fill me-2"></i>${error}
+            </div>
+        </c:if>
+    </div>
+
+    <!-- Thông tin chi tiết -->
+    <div class="sb-card mb-4">
+        <table class="table detail-table align-middle">
+            <tbody>
+            <tr><th>Họ tên</th><td>${app.fullName}</td></tr>
+            <tr><th>Email cá nhân</th><td>${app.email}</td></tr>
+            <tr><th>SĐT</th><td>${app.phone}</td></tr>
+            <tr><th>Địa chỉ</th><td>${app.address}</td></tr>
+            <tr><th>Phường</th><td>${ward != null ? ward.wardName : app.wardID}</td></tr>
+            <tr><th>Ngày nộp</th><td><fmt:formatDate value="${app.createdAt}" pattern="dd/MM/yyyy HH:mm"/></td></tr>
+            <tr>
+                <th>Trạng thái</th>
+                <td>
+                    <c:choose>
+                        <c:when test="${app.status == 0}">Pending</c:when>
+                        <c:when test="${app.status == 2}">Approved</c:when>
+                        <c:when test="${app.status == 3}">Rejected</c:when>
+                        <c:otherwise>${app.status}</c:otherwise>
+                    </c:choose>
+                </td>
+            </tr>
+            <tr><th>Ghi chú Admin</th><td>${app.adminNotes}</td></tr>
+            <tr><th>Lý do từ chối</th><td>${app.rejectionReason}</td></tr>
+            <tr>
+                <th>Hợp đồng</th>
+                <td>
+                    <c:if test="${not empty app.contractPath}">
+                        <a class="btn btn-sm btn-outline-primary"
+                           href="${app.contractPath}" target="_blank">
+                            <i class="bi bi-download"></i> Tải hợp đồng
+                        </a>
+                    </c:if>
+                </td>
+            </tr>
+            <tr>
+                <th>CMND/CCCD</th>
+                <td>
+                    <c:if test="${not empty app.cmndPath}">
+                        <a class="btn btn-sm btn-outline-secondary"
+                           href="${app.cmndPath}" target="_blank">
+                            <i class="bi bi-file-earmark-arrow-down"></i> Tải CMND/CCCD
+                        </a>
+                    </c:if>
+                </td>
+            </tr>
+            </tbody>
+        </table>
+    </div>
+
+    <!-- Hành động (chỉ khi Pending) -->
+    <c:if test="${app.status == 0}">
+        <div class="sb-card">
+            <div class="row g-3">
+                <div class="col-12 col-lg-6">
+                    <form class="mb-0"
+                          action="${pageContext.request.contextPath}/admin/applications/${app.applicationId}/approve"
+                          method="post">
+                        <div class="mb-2">
+                            <label class="form-label">Ghi chú (tuỳ chọn)</label>
+                            <textarea name="adminNotes" class="form-control" rows="2"
+                                      placeholder="Ví dụ: Đủ điều kiện, tạo account ngay."></textarea>
+                        </div>
+                        <c:if test="${_csrf != null}">
+                            <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
+                        </c:if>
+                        <button class="btn btn-success w-100">
+                            <i class="bi bi-person-check"></i> Approve & Tạo Account
+                        </button>
+                    </form>
+                </div>
+
+                <div class="col-12 col-lg-6">
+                    <form id="rejectForm" class="mb-0"
+                          action="${pageContext.request.contextPath}/admin/applications/${app.applicationId}/reject"
+                          method="post">
+                        <div class="mb-2">
+                            <label class="form-label">Lý do từ chối</label>
+                            <textarea name="reason" class="form-control" rows="2" required
+                                      placeholder="Vui lòng nêu rõ lý do từ chối."></textarea>
+                        </div>
+                        <c:if test="${_csrf != null}">
+                            <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
+                        </c:if>
+                        <button class="btn btn-danger w-100" id="btnReject">
+                            <i class="bi bi-x-circle"></i> Reject
+                        </button>
+                    </form>
+                </div>
+            </div>
+        </div>
+    </c:if>
+
+    <div class="text-center my-4">
+        <a class="btn btn-outline-secondary"
+           href="${pageContext.request.contextPath}/admin/applications">
+            <i class="bi bi-arrow-left"></i> Quay lại danh sách
+        </a>
+    </div>
+</div>
+
+<!-- Scripts -->
+<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
+<script>
+    // Auto-dismiss alerts sau 5s
+    document.addEventListener('DOMContentLoaded', function() {
+        document.querySelectorAll('.alert').forEach(alert => {
+            setTimeout(() => {
+                alert.style.opacity = '0';
+                alert.style.transform = 'translateY(-6px)';
+                setTimeout(() => alert.remove(), 300);
+            }, 5000);
+        });
+    });
+
+    // Xác nhận Reject
+    const rejectForm = document.getElementById('rejectForm');
+    if (rejectForm) {
+        rejectForm.addEventListener('submit', function(e){
+            const reason = this.querySelector('textarea[name="reason"]').value.trim();
+            if(!confirm('Xác nhận từ chối đơn này?' + (reason ? '\nLý do: ' + reason : ''))) {
+                e.preventDefault();
+            }
+        });
+    }
+</script>
+</body>
+</html>
Index: src/main/webapp/WEB-INF/views/admin/admin_chat_list.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/WEB-INF/views/admin/admin_chat_list.jsp b/src/main/webapp/WEB-INF/views/admin/admin_chat_list.jsp
new file mode 100644
--- /dev/null	(date 1761372868404)
+++ b/src/main/webapp/WEB-INF/views/admin/admin_chat_list.jsp	(date 1761372868404)
@@ -0,0 +1,84 @@
+<%@ page contentType="text/html;charset=UTF-8" %>
+<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
+<!DOCTYPE html>
+<html lang="vi">
+<head>
+    <title>Chat – Danh sách Manager</title>
+    <meta name="viewport" content="width=device-width, initial-scale=1"/>
+    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
+
+    <style>
+        :root{
+            --primary-green:#22c55e; --secondary-green:#16a34a;
+            --light-green:#f0fdf4; --border-green:#d1fae5;
+            --text-green:#166534; --muted:#6b7280; --border:#e5e7eb;
+        }
+        .sb-card{ border:1px solid var(--border-green); border-radius:14px; box-shadow:0 1px 2px rgba(0,0,0,.05); }
+        .sb-card .card-header{ background:var(--light-green); border-bottom:1px solid var(--border-green); color:var(--text-green); font-weight:700 }
+        .manager-item{ border:1px solid var(--border); border-radius:12px; padding:12px 14px; transition:.2s; }
+        .manager-item:hover{ background:#fff; transform: translateY(-2px); box-shadow:0 4px 8px rgba(0,0,0,.06); }
+        .last-msg{ color:var(--muted); font-size:.9rem }
+        .badge-unread{ background:#ef4444; }
+    </style>
+</head>
+<body>
+<jsp:include page="/WEB-INF/views/admin/header_admin.jsp"/>
+
+<div class="container my-4" style="max-width:1000px;">
+    <div class="sb-card card">
+        <div class="card-header d-flex justify-content-between align-items-center">
+            <div><i class="bi bi-chat-dots me-2"></i>Chat – Chọn Manager</div>
+            <a class="btn btn-sm btn-outline-success" href="${pageContext.request.contextPath}/chat/admin">
+                Làm mới
+            </a>
+        </div>
+
+        <div class="card-body">
+            <c:if test="${empty managerChats}">
+                <div class="text-center text-muted py-4">Chưa có quản lý nào để chat.</div>
+            </c:if>
+
+            <div class="vstack gap-2">
+                <c:forEach var="m" items="${managerChats}">
+                    <a class="manager-item text-decoration-none text-reset"
+                       href="${pageContext.request.contextPath}/chat/admin/${m.manager.accountId}">
+                        <div class="d-flex align-items-center">
+                            <div class="me-3">
+                                <div class="rounded-circle bg-success-subtle d-flex align-items-center justify-content-center"
+                                     style="width:42px;height:42px;">
+                                    <i class="bi bi-person-fill text-success"></i>
+                                </div>
+                            </div>
+                            <div class="flex-grow-1">
+                                <div class="d-flex justify-content-between">
+                                    <div class="fw-semibold">
+                                        <c:out value="${m.manager.fullName}"/>
+                                    </div>
+                                    <div class="text-nowrap text-muted" style="font-size:.85rem;">
+                                        <c:if test="${m.lastMessage != null}">
+                                            <fmt:formatDate value="${m.lastMessage.sentAt}" pattern="dd/MM/yyyy HH:mm"/>
+                                        </c:if>
+                                    </div>
+                                </div>
+                                <div class="d-flex justify-content-between">
+                                    <div class="last-msg text-truncate" style="max-width: 75%;">
+                                        <c:out value="${m.lastMessage != null ? m.lastMessage.message : 'Chưa có tin nhắn'}"/>
+                                    </div>
+                                    <c:if test="${m.unreadCount > 0}">
+                                        <span class="badge badge-unread"><c:out value="${m.unreadCount}"/></span>
+                                    </c:if>
+                                </div>
+                            </div>
+                        </div>
+                    </a>
+                </c:forEach>
+
+            </div>
+        </div>
+    </div>
+</div>
+
+<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
+<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
+</body>
+</html>
Index: src/main/webapp/WEB-INF/views/admin/bin-add.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/WEB-INF/views/admin/bin-add.jsp b/src/main/webapp/WEB-INF/views/admin/bin-add.jsp
new file mode 100644
--- /dev/null	(date 1761372868405)
+++ b/src/main/webapp/WEB-INF/views/admin/bin-add.jsp	(date 1761372868405)
@@ -0,0 +1,312 @@
+<%@ page contentType="text/html;charset=UTF-8" language="java" %>
+<%@ taglib prefix="c"   uri="http://java.sun.com/jsp/jstl/core" %>
+<!DOCTYPE html>
+<html lang="vi">
+<head>
+    <meta charset="UTF-8">
+    <title>Thêm thùng rác</title>
+
+    <!-- Bootstrap & Icons -->
+    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
+    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
+
+    <style>
+        /* ===== Màu sắc hệ thống thùng rác (Xanh lá chủ đạo) ===== */
+        :root{
+            --primary-color: #8cc63f;      /* Màu xanh lá chính */
+            --primary-dark: #7cb342;       /* Xanh lá đậm */
+            --primary-light: #9ccc65;      /* Xanh lá sáng */
+            --secondary-color: #4caf50;    /* Xanh lá phụ */
+            --accent-color: #ff9800;       /* Cam nhấn */
+            --text-dark: #2e7d32;          /* Chữ xanh đậm */
+            --text-light: #ffffff;         /* Chữ trắng */
+            --bg-light: #f1f8e9;           /* Nền sáng xanh nhạt */
+            --bg-dark: #1b5e20;            /* Nền tối xanh đậm */
+            --card-bg: #ffffff;            /* Nền card trắng */
+            --card-border: #c5e1a5;        /* Viền card xanh nhạt */
+            --input-bg: #f8fdf1;           /* Nền input xanh rất nhạt */
+            --input-border: #aed581;       /* Viền input xanh */
+        }
+
+        html,body{
+            height:100%;
+            margin:0;
+            font-family: 'Inter', 'Segoe UI', Roboto, Arial, sans-serif;
+            background: linear-gradient(135deg, var(--bg-light) 0%, #e8f5e9 100%);
+            color: #333;
+        }
+
+        .page-wrap{
+            padding: 24px;
+            background: transparent;
+        }
+
+        .page-title{
+            font-weight: 700;
+            color: var(--text-dark);
+            margin-bottom: 1rem;
+        }
+
+        .glass-card{
+            border-radius: 16px;
+            padding: 28px;
+            background: var(--card-bg);
+            border: 2px solid var(--card-border);
+            box-shadow: 0 8px 32px rgba(140, 198, 63, 0.15);
+            backdrop-filter: blur(10px);
+        }
+
+        .btn-outline-secondary{
+            color: var(--primary-color);
+            border-color: var(--primary-color);
+            font-weight: 500;
+        }
+
+        .btn-outline-secondary:hover{
+            background: var(--primary-color);
+            border-color: var(--primary-color);
+            color: white;
+        }
+
+        .form-label{
+            font-weight: 600;
+            color: var(--text-dark);
+            margin-bottom: 0.5rem;
+        }
+
+        .form-control, .form-select{
+            background: var(--input-bg);
+            border: 2px solid var(--input-border);
+            color: #2e7d32;
+            border-radius: 8px;
+            padding: 10px 15px;
+            font-size: 14px;
+        }
+
+        .form-control::placeholder{
+            color: #81c784;
+        }
+
+        .form-control:focus, .form-select:focus{
+            background: white;
+            border-color: var(--primary-color);
+            box-shadow: 0 0 0 3px rgba(140, 198, 63, 0.25);
+            color: var(--text-dark);
+        }
+
+        .invalid-feedback{
+            color: #f44336;
+            font-size: 12px;
+        }
+
+        .form-text{
+            color: #689f38;
+            font-size: 13px;
+        }
+
+        .btn-primary{
+            border: none;
+            font-weight: 600;
+            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
+            border-radius: 8px;
+            padding: 10px 24px;
+            box-shadow: 0 4px 12px rgba(140, 198, 63, 0.3);
+            transition: all 0.3s ease;
+        }
+
+        .btn-primary:hover{
+            background: linear-gradient(135deg, var(--primary-dark), #43a047);
+            box-shadow: 0 6px 16px rgba(140, 198, 63, 0.4);
+            transform: translateY(-1px);
+        }
+
+        .alert-success {
+            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
+            border: 2px solid #a5d6a7;
+            color: #2e7d32;
+            border-radius: 12px;
+        }
+
+        .alert-danger {
+            background: linear-gradient(135deg, #ffebee, #ffcdd2);
+            border: 2px solid #ef9a9a;
+            color: #c62828;
+            border-radius: 12px;
+        }
+
+        /* Header đồng bộ */
+        .navbar-custom {
+            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
+            box-shadow: 0 4px 12px rgba(140, 198, 63, 0.25);
+        }
+
+        /* Responsive */
+        @media (max-width: 768px) {
+            .glass-card {
+                padding: 20px;
+                margin: 0 -15px;
+            }
+
+            .page-wrap {
+                padding: 16px;
+            }
+        }
+    </style>
+</head>
+<body>
+<%@ include file="/WEB-INF/views/admin/header_admin.jsp" %>
+
+<div class="container page-wrap">
+    <div class="d-flex align-items-center justify-content-between mb-4">
+        <h3 class="page-title mb-0">
+            <i class="bi bi-trash-fill me-2" style="color: var(--primary-color);"></i>
+            Thêm thùng rác mới
+        </h3>
+        <a href="${pageContext.request.contextPath}/admin/bins/list" class="btn btn-outline-secondary">
+            <i class="bi bi-arrow-left me-1"></i>Danh sách thùng
+        </a>
+    </div>
+
+    <c:if test="${not empty error}">
+        <div class="alert alert-danger mb-4">${error}</div>
+    </c:if>
+    <c:if test="${not empty success}">
+        <div class="alert alert-success mb-4">${success}</div>
+    </c:if>
+
+    <div class="glass-card">
+        <form id="binForm" method="post" action="${pageContext.request.contextPath}/admin/bins" novalidate>
+            <c:if test="${not empty _csrf}">
+                <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
+            </c:if>
+
+            <div class="row g-4">
+                <!-- BinCode KHÔNG có input (tự sinh ở backend) -->
+                <div class="col-12">
+                    <div class="form-text">
+                        <i class="bi bi-info-circle me-1"></i>
+                        Mã thùng (BinCode) sẽ được hệ thống tự sinh sau khi lưu.
+                    </div>
+                </div>
+
+                <div class="col-md-8">
+                    <label class="form-label">Tên đường</label>
+                    <input type="text" name="street" class="form-control" maxlength="255" placeholder="Nhập tên đường">
+                </div>
+
+                <div class="col-md-4">
+                    <label class="form-label">Phường <span class="text-danger">*</span></label>
+                    <select name="wardID" id="wardID" class="form-select" required>
+                        <option value="">-- Chọn phường --</option>
+                        <c:forEach var="w" items="${wards}">
+                            <option value="${w.wardId}">${w.wardName}</option>
+                        </c:forEach>
+                    </select>
+                    <div class="invalid-feedback">Vui lòng chọn phường</div>
+                </div>
+
+                <div class="col-md-4">
+                    <label class="form-label">Vĩ độ (Latitude)</label>
+                    <input type="number" step="0.000001" name="latitude" id="latitude" class="form-control" placeholder="16.07177">
+                    <div class="form-text">Ví dụ: 16.07177</div>
+                    <div class="invalid-feedback">Vĩ độ hợp lệ nằm trong [-90, 90]</div>
+                </div>
+
+                <div class="col-md-4">
+                    <label class="form-label">Kinh độ (Longitude)</label>
+                    <input type="number" step="0.000001" name="longitude" id="longitude" class="form-control" placeholder="108.22057">
+                    <div class="form-text">Ví dụ: 108.22057</div>
+                    <div class="invalid-feedback">Kinh độ hợp lệ nằm trong [-180, 180]</div>
+                </div>
+
+                <div class="col-md-4">
+                    <label class="form-label">Dung tích (lít) <span class="text-danger">*</span></label>
+                    <input type="number" step="0.01" name="capacity" id="capacity" class="form-control" value="120" required>
+                    <div class="form-text">Dung tích tối đa của thùng</div>
+                    <div class="invalid-feedback">Dung tích phải lớn hơn 0</div>
+                </div>
+
+                <div class="col-md-4">
+                    <label class="form-label">% đầy hiện tại</label>
+                    <input type="number" step="0.01" name="currentFill" id="currentFill" class="form-control" value="0">
+                    <div class="form-text">Mức đầy hiện tại (%)</div>
+                    <div class="invalid-feedback">% đầy không được âm</div>
+                </div>
+
+                <div class="col-md-4">
+                    <label class="form-label">Trạng thái</label>
+                    <select name="status" class="form-select">
+                        <option value="1" selected>🟢 Hoạt động</option>
+                        <option value="0">🟡 Bảo trì</option>
+                        <option value="2">🔴 Đầy / Mất kết nối</option>
+                    </select>
+                </div>
+            </div>
+
+            <div class="mt-5 d-flex gap-3 justify-content-end">
+                <a href="${pageContext.request.contextPath}/admin/bins/list" class="btn btn-outline-secondary px-4">
+                    <i class="bi bi-x-circle me-1"></i>Hủy
+                </a>
+                <button type="submit" class="btn btn-primary px-4">
+                    <i class="bi bi-check-circle me-1"></i>Lưu thùng rác
+                </button>
+            </div>
+        </form>
+    </div>
+</div>
+
+<!-- Bootstrap JS -->
+<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
+
+<script>
+    // Validate nhỏ phía client
+    (function () {
+        const form = document.getElementById('binForm');
+        form.addEventListener('submit', function (e) {
+            let ok = true;
+
+            const wardID = document.getElementById('wardID');
+            const latEl  = document.getElementById('latitude');
+            const lngEl  = document.getElementById('longitude');
+            const capEl  = document.getElementById('capacity');
+            const fillEl = document.getElementById('currentFill');
+
+            // Ward
+            if (!wardID.value) {
+                wardID.classList.add('is-invalid');
+                ok = false;
+            } else {
+                wardID.classList.remove('is-invalid');
+            }
+
+            // Validate các trường
+            const validations = [
+                { element: latEl, min: -90, max: 90, message: 'Vĩ độ hợp lệ nằm trong [-90, 90]' },
+                { element: lngEl, min: -180, max: 180, message: 'Kinh độ hợp lệ nằm trong [-180, 180]' },
+                { element: capEl, min: 0.01, message: 'Dung tích phải lớn hơn 0' },
+                { element: fillEl, min: 0, message: '% đầy không được âm' }
+            ];
+
+            validations.forEach(validation => {
+                if (validation.element.value) {
+                    const value = parseFloat(validation.element.value);
+                    if (isNaN(value) ||
+                        (validation.min !== undefined && value < validation.min) ||
+                        (validation.max !== undefined && value > validation.max)) {
+                        validation.element.classList.add('is-invalid');
+                        ok = false;
+                    } else {
+                        validation.element.classList.remove('is-invalid');
+                    }
+                }
+            });
+
+            if (!ok) {
+                e.preventDefault();
+                e.stopPropagation();
+            }
+        });
+    })();
+</script>
+</body>
+</html>
\ No newline at end of file
Index: src/main/webapp/WEB-INF/views/admin/applications.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/WEB-INF/views/admin/applications.jsp b/src/main/webapp/WEB-INF/views/admin/applications.jsp
new file mode 100644
--- /dev/null	(date 1761372868405)
+++ b/src/main/webapp/WEB-INF/views/admin/applications.jsp	(date 1761372868405)
@@ -0,0 +1,319 @@
+<%@ page contentType="text/html;charset=UTF-8" language="java" %>
+<%@ taglib prefix="c"   uri="http://java.sun.com/jsp/jstl/core" %>
+<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"  %>
+<%@ taglib prefix="fn"  uri="http://java.sun.com/jsp/jstl/functions" %>
+<!DOCTYPE html>
+<html lang="vi">
+<head>
+  <meta charset="UTF-8"/>
+  <title>Đơn đăng ký Manager - SmartBin (Admin)</title>
+  <meta name="viewport" content="width=device-width, initial-scale=1">
+  <!-- Bootstrap & Icons & Font -->
+  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
+  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
+  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
+
+  <style>
+    :root{
+      --primary-green:#22c55e;
+      --secondary-green:#16a34a;
+      --light-green:#f0fdf4;
+      --border-green:#d1fae5;
+      --text-green:#166534;
+      --muted-green:#6b7280;
+      --white:#ffffff;
+      --border-gray:#e5e7eb;
+      --text-dark:#111827;
+    }
+    *{ box-sizing: border-box; }
+    html, body{ height:100%; }
+    body{
+      margin:0; font-family:'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
+      background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 40%, #d1fae5 100%);
+      color: var(--text-dark);
+    }
+    /* Background pattern */
+    .background-pattern{
+      position: fixed; inset: 0; z-index: -1;
+      background-image:
+              radial-gradient(circle at 25% 25%, rgba(34,197,94,0.10) 0%, transparent 50%),
+              radial-gradient(circle at 75% 75%, rgba(16,185,129,0.08) 0%, transparent 50%),
+              radial-gradient(circle at 50% 50%, rgba(34,197,94,0.05) 0%, transparent 70%);
+      background-size: 600px 600px, 800px 800px, 1000px 1000px;
+      animation: float 20s ease-in-out infinite;
+    }
+    @keyframes float{
+      0%,100%{ transform: translate(0,0) rotate(0); }
+      33%{ transform: translate(30px,-30px) rotate(1deg); }
+      66%{ transform: translate(-20px,20px) rotate(-1deg); }
+    }
+
+    /* Wrapper */
+    .page-wrap{ padding: 24px; }
+
+    /* Card */
+    .sb-card{
+      background: var(--white);
+      border: 1px solid var(--border-gray);
+      border-radius: 20px;
+      box-shadow: 0 20px 25px -5px rgba(0,0,0,.1), 0 10px 10px -5px rgba(0,0,0,.04);
+      padding: 24px;
+      position: relative; overflow: hidden;
+    }
+    .sb-card::before{
+      content:''; position:absolute; top:0; left:0; right:0; height:4px;
+      background: linear-gradient(90deg, var(--primary-green), var(--secondary-green));
+    }
+
+    /* Section header */
+    .section-header{
+      display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;
+      margin-bottom: 12px;
+    }
+    .section-title{
+      margin:0; font-size:18px; font-weight:700; letter-spacing:-.01em;
+    }
+    .muted{ color: var(--muted-green); }
+
+    /* Badges */
+    .badge-pill{
+      border-radius: 999px; padding: .35rem .6rem; font-weight:600;
+    }
+    .badge-pending{ background: #fef3c7; color: #92400e; border:1px solid #fde68a; }
+    .badge-approved{ background: #dcfce7; color: #166534; border:1px solid #86efac; }
+    .badge-rejected{ background: #fee2e2; color: #991b1b; border:1px solid #fecaca; }
+
+    /* Table */
+    .table thead th{
+      font-weight:600; color:#374151; border-bottom: 1px solid var(--border-gray);
+      background: #f9fafb;
+    }
+    .table tbody td{ vertical-align: middle; }
+    .table-hover tbody tr:hover{ background: #f9fafb; }
+
+    /* Buttons */
+    .btn-primary{
+      --bs-btn-bg: var(--primary-green);
+      --bs-btn-border-color: var(--primary-green);
+      --bs-btn-hover-bg: var(--secondary-green);
+      --bs-btn-hover-border-color: var(--secondary-green);
+      border-radius:10px; font-weight:600;
+    }
+    .btn-outline-secondary{
+      border-radius:10px; font-weight:600;
+    }
+
+    /* Search input */
+    .search-input{
+      max-width: 360px;
+      border-radius: 10px;
+      border: 1px solid var(--border-gray);
+    }
+    .search-input:focus{
+      border-color: var(--primary-green);
+      box-shadow: 0 0 0 3px rgba(34,197,94,.1);
+    }
+
+    /* Responsive */
+    @media (max-width: 768px){
+      .page-wrap{ padding: 16px; }
+      .sb-card{ padding: 16px; border-radius: 16px; }
+    }
+  </style>
+</head>
+<body>
+<div class="background-pattern"></div>
+
+<jsp:include page="header_admin.jsp"/>
+
+<div class="page-wrap container">
+  <!-- Header tổng quan -->
+  <div class="sb-card mb-4">
+    <div class="d-flex align-items-center justify-content-between flex-wrap gap-3">
+      <div>
+        <h3 class="mb-1" style="letter-spacing:-.02em;">Đơn đăng ký Manager</h3>
+        <div class="muted">Quản trị & duyệt hồ sơ ứng viên Manager</div>
+      </div>
+      <div class="d-flex align-items-center gap-2">
+                <span class="badge-pill badge-pending">
+                    <i class="bi bi-hourglass-split"></i>
+                    <span class="ms-1">Chờ duyệt:</span>
+                    <strong class="ms-1"><c:out value="${fn:length(pending)}"/></strong>
+                </span>
+        <span class="badge-pill badge-approved">
+                    <i class="bi bi-check2-circle"></i>
+                    <span class="ms-1">Đã duyệt:</span>
+                    <strong class="ms-1"><c:out value="${fn:length(approved)}"/></strong>
+                </span>
+        <span class="badge-pill badge-rejected">
+                    <i class="bi bi-x-circle"></i>
+                    <span class="ms-1">Từ chối:</span>
+                    <strong class="ms-1"><c:out value="${fn:length(rejected)}"/></strong>
+                </span>
+      </div>
+    </div>
+
+    <div class="mt-3 d-flex align-items-center gap-2">
+      <div class="input-group search-input">
+        <span class="input-group-text bg-white border-0"><i class="bi bi-search"></i></span>
+        <input type="text" id="q" class="form-control border-0" placeholder="Tìm theo họ tên hoặc email...">
+      </div>
+      <a class="btn btn-outline-secondary" href="${pageContext.request.contextPath}/admin/applications/export">
+        <i class="bi bi-download"></i> Xuất danh sách
+      </a>
+    </div>
+
+    <c:if test="${not empty error}">
+      <div class="alert alert-danger mt-3 mb-0" role="alert">
+        <i class="bi bi-exclamation-triangle-fill me-2"></i>${error}
+      </div>
+    </c:if>
+  </div>
+
+  <!-- Bảng CHỜ DUYỆT -->
+  <div class="sb-card mb-4">
+    <div class="section-header">
+      <h4 class="section-title"><i class="bi bi-hourglass-split me-2"></i>Đang chờ duyệt</h4>
+      <span class="muted">Có <strong>${fn:length(pending)}</strong> đơn</span>
+    </div>
+    <div class="table-responsive">
+      <table class="table table-sm table-hover align-middle" id="tbl-pending">
+        <thead>
+        <tr>
+          <th style="width:80px;">ID</th>
+          <th>Họ tên</th>
+          <th>Email</th>
+          <th style="width:200px;">Ngày nộp</th>
+          <th style="width:120px;"></th>
+        </tr>
+        </thead>
+        <tbody>
+        <c:forEach var="a" items="${pending}">
+          <tr>
+            <td>${a.applicationId}</td>
+            <td>${a.fullName}</td>
+            <td>${a.email}</td>
+            <td><fmt:formatDate value="${a.createdAt}" pattern="dd/MM/yyyy HH:mm"/></td>
+            <td class="text-end">
+              <a class="btn btn-sm btn-primary"
+                 href="${pageContext.request.contextPath}/admin/applications/${a.applicationId}">
+                <i class="bi bi-eye"></i> Xem
+              </a>
+            </td>
+          </tr>
+        </c:forEach>
+        <c:if test="${fn:length(pending) == 0}">
+          <tr><td colspan="5" class="text-center text-muted py-3">Không có đơn chờ duyệt</td></tr>
+        </c:if>
+        </tbody>
+      </table>
+    </div>
+  </div>
+
+  <!-- Bảng ĐÃ DUYỆT -->
+  <div class="sb-card mb-4">
+    <div class="section-header">
+      <h4 class="section-title"><i class="bi bi-check2-circle me-2"></i>Đã duyệt</h4>
+      <span class="muted">Có <strong>${fn:length(approved)}</strong> đơn</span>
+    </div>
+    <div class="table-responsive">
+      <table class="table table-sm table-hover align-middle" id="tbl-approved">
+        <thead>
+        <tr>
+          <th style="width:80px;">ID</th>
+          <th>Họ tên</th>
+          <th>Email</th>
+          <th style="width:200px;">Ngày nộp</th>
+          <th style="width:120px;"></th>
+        </tr>
+        </thead>
+        <tbody>
+        <c:forEach var="a" items="${approved}">
+          <tr>
+            <td>${a.applicationId}</td>
+            <td>${a.fullName}</td>
+            <td>${a.email}</td>
+            <td><fmt:formatDate value="${a.createdAt}" pattern="dd/MM/yyyy HH:mm"/></td>
+            <td class="text-end">
+              <a class="btn btn-sm btn-outline-secondary"
+                 href="${pageContext.request.contextPath}/admin/applications/${a.applicationId}">
+                <i class="bi bi-eye"></i> Xem
+              </a>
+            </td>
+          </tr>
+        </c:forEach>
+        <c:if test="${fn:length(approved) == 0}">
+          <tr><td colspan="5" class="text-center text-muted py-3">Chưa có đơn đã duyệt</td></tr>
+        </c:if>
+        </tbody>
+      </table>
+    </div>
+  </div>
+
+  <!-- Bảng ĐÃ TỪ CHỐI -->
+  <div class="sb-card mb-4">
+    <div class="section-header">
+      <h4 class="section-title"><i class="bi bi-x-circle me-2"></i>Đã từ chối</h4>
+      <span class="muted">Có <strong>${fn:length(rejected)}</strong> đơn</span>
+    </div>
+    <div class="table-responsive">
+      <table class="table table-sm table-hover align-middle" id="tbl-rejected">
+        <thead>
+        <tr>
+          <th style="width:80px;">ID</th>
+          <th>Họ tên</th>
+          <th>Email</th>
+          <th style="width:200px;">Ngày nộp</th>
+          <th style="width:120px;"></th>
+        </tr>
+        </thead>
+        <tbody>
+        <c:forEach var="a" items="${rejected}">
+          <tr>
+            <td>${a.applicationId}</td>
+            <td>${a.fullName}</td>
+            <td>${a.email}</td>
+            <td><fmt:formatDate value="${a.createdAt}" pattern="dd/MM/yyyy HH:mm"/></td>
+            <td class="text-end">
+              <a class="btn btn-sm btn-outline-secondary"
+                 href="${pageContext.request.contextPath}/admin/applications/${a.applicationId}">
+                <i class="bi bi-eye"></i> Xem
+              </a>
+            </td>
+          </tr>
+        </c:forEach>
+        <c:if test="${fn:length(rejected) == 0}">
+          <tr><td colspan="5" class="text-center text-muted py-3">Chưa có đơn bị từ chối</td></tr>
+        </c:if>
+        </tbody>
+      </table>
+    </div>
+  </div>
+</div>
+
+<!-- Scripts -->
+<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
+<script>
+  // Search: lọc cả 3 bảng theo tên/email
+  const q = document.getElementById('q');
+  const tables = ['tbl-pending','tbl-approved','tbl-rejected'].map(id => document.getElementById(id).querySelector('tbody'));
+
+  function normalize(str){ return (str || '').toLowerCase().normalize('NFKD'); }
+
+  q.addEventListener('input', function(){
+    const term = normalize(this.value.trim());
+    tables.forEach(tbody=>{
+      const rows = tbody.querySelectorAll('tr');
+      rows.forEach(row=>{
+        // bỏ qua hàng "không có dữ liệu"
+        if(row.querySelector('td[colspan]')) return;
+        const name  = normalize(row.children[1]?.innerText);
+        const email = normalize(row.children[2]?.innerText);
+        const match = !term || name.includes(term) || email.includes(term);
+        row.style.display = match ? '' : 'none';
+      });
+    });
+  });
+</script>
+</body>
+</html>
Index: src/main/webapp/WEB-INF/views/admin/bins.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/WEB-INF/views/admin/bins.jsp b/src/main/webapp/WEB-INF/views/admin/bins.jsp
new file mode 100644
--- /dev/null	(date 1761372868406)
+++ b/src/main/webapp/WEB-INF/views/admin/bins.jsp	(date 1761372868406)
@@ -0,0 +1,587 @@
+<%@ page contentType="text/html;charset=UTF-8" language="java" %>
+<%@ taglib prefix="c"   uri="http://java.sun.com/jsp/jstl/core" %>
+<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"  %>
+<!DOCTYPE html>
+<html lang="vi">
+<head>
+    <meta charset="UTF-8">
+    <title>Danh sách thùng rác</title>
+    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
+    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
+
+    <style>
+        /* ===== Light Green Theme - Clean & Modern ===== */
+        :root{
+            --primary-green:#22c55e;
+            --secondary-green:#16a34a;
+            --light-green:#f0fdf4;
+            --border-green:#d1fae5;
+            --text-green:#166534;
+            --muted-green:#6b7280;
+            --white:#ffffff;
+            --light-gray:#f9fafb;
+            --border-gray:#e5e7eb;
+            --text-dark:#111827;
+            --success:#10b981;
+            --warning:#f59e0b;
+            --danger:#ef4444;
+            --info:#3b82f6;
+        }
+
+        html,body{
+            height:100%;
+            font-family:'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
+        }
+
+        body{
+            margin:0;
+            background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
+            color: var(--text-dark);
+            overflow-y:auto;
+            line-height: 1.6;
+        }
+
+        /* ===== Page Layout ===== */
+        .page-container{
+            max-width: 1400px;
+            margin: 0 auto;
+            padding: 24px;
+        }
+
+        /* ===== Header Section ===== */
+        .page-header{
+            display: flex;
+            align-items: center;
+            justify-content: space-between;
+            margin-bottom: 24px;
+            flex-wrap: wrap;
+            gap: 16px;
+        }
+
+        .page-title{
+            font-size: 28px;
+            font-weight: 700;
+            color: var(--text-dark);
+            display: flex;
+            align-items: center;
+            gap: 12px;
+            margin: 0;
+        }
+
+        .page-title i {
+            color: var(--primary-green);
+            font-size: 32px;
+        }
+
+        .header-actions {
+            display: flex;
+            align-items: center;
+            gap: 12px;
+            flex-wrap: wrap;
+        }
+
+        /* ===== Search Input ===== */
+        .search-input{
+            min-width: 280px;
+            background: var(--white);
+            border: 1px solid var(--border-gray);
+            border-radius: 8px;
+            padding: 10px 16px;
+            color: var(--text-dark);
+            font-size: 14px;
+            transition: all 0.2s ease;
+        }
+
+        .search-input::placeholder{
+            color: var(--muted-green);
+        }
+
+        .search-input:focus{
+            background: var(--white);
+            border-color: var(--primary-green);
+            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
+            outline: none;
+        }
+
+        /* ===== Buttons ===== */
+        .btn-primary{
+            background: var(--primary-green);
+            border: 1px solid var(--primary-green);
+            color: var(--white);
+            padding: 10px 20px;
+            border-radius: 8px;
+            font-weight: 600;
+            font-size: 14px;
+            transition: all 0.2s ease;
+            display: inline-flex;
+            align-items: center;
+            gap: 8px;
+        }
+
+        .btn-primary:hover{
+            background: var(--secondary-green);
+            border-color: var(--secondary-green);
+            transform: translateY(-1px);
+            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
+        }
+
+        .btn-outline-primary{
+            color: var(--primary-green);
+            border-color: var(--primary-green);
+            background: transparent;
+            padding: 6px 12px;
+            font-size: 12px;
+            border-radius: 6px;
+            font-weight: 500;
+            transition: all 0.2s ease;
+        }
+
+        .btn-outline-primary:hover{
+            background: var(--light-green);
+            color: var(--primary-green);
+            border-color: var(--primary-green);
+        }
+
+        .btn-outline-danger{
+            color: var(--danger);
+            border-color: var(--danger);
+            background: transparent;
+            padding: 6px 12px;
+            font-size: 12px;
+            border-radius: 6px;
+            font-weight: 500;
+            transition: all 0.2s ease;
+        }
+
+        .btn-outline-danger:hover{
+            background: #fef2f2;
+            color: var(--danger);
+            border-color: var(--danger);
+        }
+
+        /* ===== Main Card ===== */
+        .main-card{
+            background: var(--white);
+            border-radius: 16px;
+            border: 1px solid var(--border-green);
+            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
+            overflow: hidden;
+        }
+
+        /* ===== Table Styling ===== */
+        .table-container {
+            overflow-x: auto;
+        }
+
+        table.table{
+            color: var(--text-dark);
+            margin-bottom: 0;
+            font-size: 14px;
+        }
+
+        .table thead{
+            background: var(--light-green);
+            color: var(--text-green);
+        }
+
+        .table thead th{
+            white-space: nowrap;
+            border-color: var(--border-green) !important;
+            font-weight: 600;
+            font-size: 13px;
+            text-transform: uppercase;
+            letter-spacing: 0.025em;
+            padding: 16px 12px;
+        }
+
+        .table tbody td{
+            border-color: var(--border-gray) !important;
+            padding: 14px 12px;
+            vertical-align: middle;
+        }
+
+        .table tbody tr:hover {
+            background: var(--light-gray);
+        }
+
+        /* ===== Status Badges ===== */
+        .badge{
+            padding: 6px 10px;
+            font-size: 11px;
+            font-weight: 600;
+            border-radius: 6px;
+            text-transform: uppercase;
+            letter-spacing: 0.025em;
+        }
+
+        .badge.bg-success{
+            background: var(--success) !important;
+            color: white;
+        }
+
+        .badge.bg-warning{
+            background: var(--warning) !important;
+            color: #111 !important;
+        }
+
+        .badge.bg-danger{
+            background: var(--danger) !important;
+            color: white;
+        }
+
+        /* ===== Alert Messages ===== */
+        .alert{
+            border: 1px solid;
+            border-radius: 8px;
+            padding: 16px;
+            margin-bottom: 24px;
+            display: flex;
+            align-items: center;
+            gap: 12px;
+        }
+
+        .alert-success {
+            background: #f0fdf4;
+            border-color: var(--border-green);
+            color: var(--text-green);
+        }
+
+        .alert-danger {
+            background: #fef2f2;
+            border-color: #fecaca;
+            color: #b91c1c;
+        }
+
+        /* ===== Empty State ===== */
+        .empty-state {
+            text-align: center;
+            padding: 48px 24px;
+            color: var(--muted-green);
+        }
+
+        .empty-state i {
+            font-size: 48px;
+            color: var(--border-green);
+            margin-bottom: 16px;
+        }
+
+        /* ===== Action Buttons Container ===== */
+        .action-buttons {
+            display: flex;
+            gap: 6px;
+            justify-content: flex-end;
+        }
+
+        /* ===== Responsive Design ===== */
+        @media (max-width: 768px) {
+            .page-header {
+                flex-direction: column;
+                align-items: stretch;
+            }
+
+            .header-actions {
+                flex-direction: column;
+                align-items: stretch;
+            }
+
+            .search-input {
+                min-width: auto;
+                width: 100%;
+            }
+
+            .action-buttons {
+                flex-direction: column;
+            }
+
+            .btn-outline-primary,
+            .btn-outline-danger {
+                font-size: 14px;
+                padding: 8px 16px;
+            }
+        }
+
+        /* ===== Loading State (for future use) ===== */
+        .loading {
+            opacity: 0.6;
+            pointer-events: none;
+        }
+
+        /* ===== Data Formatting ===== */
+        .fw-semibold {
+            font-weight: 600;
+            color: var(--primary-green);
+        }
+
+        .text-muted {
+            color: var(--muted-green) !important;
+        }
+
+        /* ===== Statistics Cards (future enhancement) ===== */
+        .stats-card {
+            background: var(--white);
+            border: 1px solid var(--border-gray);
+            border-radius: 12px;
+            padding: 20px;
+            text-align: center;
+        }
+
+        .stats-card h4 {
+            color: var(--primary-green);
+            font-size: 28px;
+            font-weight: 700;
+            margin-bottom: 4px;
+        }
+
+        .stats-card p {
+            color: var(--muted-green);
+            margin: 0;
+            font-size: 14px;
+        }
+    </style>
+</head>
+<body>
+<%@ include file="/WEB-INF/views/admin/header_admin.jsp" %>
+
+<div class="page-container">
+    <div class="page-header">
+        <h1 class="page-title">
+            <i class="bi bi-trash3"></i>
+            Danh sách thùng rác
+        </h1>
+
+        <div class="header-actions">
+            <input id="quickSearch" class="search-input" placeholder="Tìm kiếm mã, đường, phường...">
+            <a href="${pageContext.request.contextPath}/admin/bins/new" class="btn btn-primary">
+                <i class="bi bi-plus-circle"></i>
+                Thêm thùng rác
+            </a>
+        </div>
+    </div>
+
+    <!-- Flash messages -->
+    <c:if test="${not empty success}">
+        <div class="alert alert-success">
+            <i class="bi bi-check-circle"></i>
+            <span>${success}</span>
+        </div>
+    </c:if>
+    <c:if test="${not empty error}">
+        <div class="alert alert-danger">
+            <i class="bi bi-exclamation-triangle"></i>
+            <span>${error}</span>
+        </div>
+    </c:if>
+
+    <div class="main-card">
+        <div class="table-container">
+            <table id="binsTable" class="table align-middle">
+                <thead>
+                <tr>
+                    <th>ID</th>
+                    <th>Mã thùng</th>
+                    <th>Đường</th>
+                    <th>Phường</th>
+                    <th>Tỉnh/TP</th>
+                    <th class="text-end">Dung tích</th>
+                    <th class="text-end">% đầy</th>
+                    <th>Trạng thái</th>
+                    <th>Cập nhật</th>
+                    <th class="text-center">Hành động</th>
+                </tr>
+                </thead>
+                <tbody>
+                <c:choose>
+                    <c:when test="${not empty bins}">
+                        <c:forEach var="b" items="${bins}">
+                            <tr>
+                                <td>
+                                    <span class="text-muted">#${b.binID}</span>
+                                </td>
+                                <td>
+                                    <span class="fw-semibold">${b.binCode}</span>
+                                </td>
+                                <td>${b.street}</td>
+                                <td>${b.wardName}</td>
+                                <td>${b.city}</td>
+                                <td class="text-end">
+                                    <c:choose>
+                                        <c:when test="${not empty b.capacity}">
+                                            <fmt:formatNumber value="${b.capacity}" maxFractionDigits="2"/> L
+                                        </c:when>
+                                        <c:otherwise>
+                                            <span class="text-muted">-</span>
+                                        </c:otherwise>
+                                    </c:choose>
+                                </td>
+                                <td class="text-end">
+                                    <c:choose>
+                                        <c:when test="${not empty b.currentFill}">
+                                            <fmt:formatNumber value="${b.currentFill}" maxFractionDigits="1"/>%
+                                        </c:when>
+                                        <c:otherwise>
+                                            <span class="text-muted">-</span>
+                                        </c:otherwise>
+                                    </c:choose>
+                                </td>
+                                <td>
+                                    <c:choose>
+                                        <c:when test="${b.status == 1}">
+                                            <span class="badge bg-success">
+                                                <i class="bi bi-check-circle me-1"></i>Hoạt động
+                                            </span>
+                                        </c:when>
+                                        <c:when test="${b.status == 0}">
+                                            <span class="badge bg-warning">
+                                                <i class="bi bi-tools me-1"></i>Bảo trì
+                                            </span>
+                                        </c:when>
+                                        <c:otherwise>
+                                            <span class="badge bg-danger">
+                                                <i class="bi bi-x-circle me-1"></i>Lỗi
+                                            </span>
+                                        </c:otherwise>
+                                    </c:choose>
+                                </td>
+                                <td>
+                                    <c:choose>
+                                        <c:when test="${not empty b.lastUpdated}">
+                                            <small class="text-muted">
+                                                <fmt:formatDate value="${b.lastUpdated}" pattern="dd/MM/yyyy"/>
+                                                <br>
+                                                <fmt:formatDate value="${b.lastUpdated}" pattern="HH:mm"/>
+                                            </small>
+                                        </c:when>
+                                        <c:otherwise>
+                                            <span class="text-muted">-</span>
+                                        </c:otherwise>
+                                    </c:choose>
+                                </td>
+                                <td>
+                                    <div class="action-buttons">
+                                        <a class="btn btn-sm btn-outline-primary"
+                                           href="${pageContext.request.contextPath}/admin/bins/${b.binID}/edit"
+                                           title="Chỉnh sửa">
+                                            <i class="bi bi-pencil"></i>
+                                        </a>
+
+                                        <form method="post"
+                                              action="${pageContext.request.contextPath}/admin/bins/${b.binID}/delete"
+                                              style="display:inline"
+                                              onsubmit="return confirm('Bạn có chắc chắn muốn xóa thùng rác ${b.binCode}?\n\nThao tác này không thể hoàn tác.');">
+                                            <c:if test="${not empty _csrf}">
+                                                <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
+                                            </c:if>
+                                            <button class="btn btn-sm btn-outline-danger" title="Xóa">
+                                                <i class="bi bi-trash3"></i>
+                                            </button>
+                                        </form>
+                                    </div>
+                                </td>
+                            </tr>
+                        </c:forEach>
+                    </c:when>
+                    <c:otherwise>
+                        <tr>
+                            <td colspan="10">
+                                <div class="empty-state">
+                                    <i class="bi bi-inbox"></i>
+                                    <h5>Chưa có thùng rác nào</h5>
+                                    <p class="text-muted">Bắt đầu bằng cách thêm thùng rác đầu tiên của bạn.</p>
+                                    <a href="${pageContext.request.contextPath}/admin/bins/new" class="btn btn-primary mt-3">
+                                        <i class="bi bi-plus-circle me-1"></i>
+                                        Thêm thùng rác
+                                    </a>
+                                </div>
+                            </td>
+                        </tr>
+                    </c:otherwise>
+                </c:choose>
+                </tbody>
+            </table>
+        </div>
+    </div>
+</div>
+
+<script>
+    // Enhanced search functionality
+    (function () {
+        const input = document.getElementById('quickSearch');
+        const table = document.getElementById('binsTable').getElementsByTagName('tbody')[0];
+        const noResultsRow = document.createElement('tr');
+        noResultsRow.innerHTML = `
+            <td colspan="10">
+                <div class="empty-state">
+                    <i class="bi bi-search"></i>
+                    <h6>Không tìm thấy kết quả</h6>
+                    <p class="text-muted mb-0">Thử tìm kiếm với từ khóa khác.</p>
+                </div>
+            </td>
+        `;
+        noResultsRow.style.display = 'none';
+        table.appendChild(noResultsRow);
+
+        function normalize(s) {
+            return (s || '').toString().toLowerCase().trim()
+                .replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g, 'a')
+                .replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g, 'e')
+                .replace(/ì|í|ị|ỉ|ĩ/g, 'i')
+                .replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g, 'o')
+                .replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g, 'u')
+                .replace(/ỳ|ý|ỵ|ỷ|ỹ/g, 'y')
+                .replace(/đ/g, 'd');
+        }
+
+        input.addEventListener('input', function () {
+            const query = normalize(this.value);
+            const rows = Array.from(table.getElementsByTagName('tr')).filter(row =>
+                row !== noResultsRow && row.getElementsByTagName('td').length > 1
+            );
+            let visibleCount = 0;
+
+            rows.forEach(row => {
+                const cells = row.getElementsByTagName('td');
+                if (!cells || cells.length === 0) return;
+
+                const binCode = normalize(cells[1].innerText);
+                const street = normalize(cells[2].innerText);
+                const ward = normalize(cells[3].innerText);
+                const city = normalize(cells[4].innerText);
+
+                const match = query === '' ||
+                    binCode.includes(query) ||
+                    street.includes(query) ||
+                    ward.includes(query) ||
+                    city.includes(query);
+
+                row.style.display = match ? '' : 'none';
+                if (match) visibleCount++;
+            });
+
+            // Show/hide no results message
+            noResultsRow.style.display = (query !== '' && visibleCount === 0) ? '' : 'none';
+        });
+
+        // Add search icon to input
+        input.style.paddingLeft = '40px';
+        input.style.backgroundImage = 'url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' fill=\'%236b7280\' viewBox=\'0 0 16 16\'%3e%3cpath d=\'M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z\'/%3e%3c/svg%3e")';
+        input.style.backgroundRepeat = 'no-repeat';
+        input.style.backgroundPosition = '12px center';
+        input.style.backgroundSize = '16px 16px';
+    })();
+
+    // Add loading state to delete buttons
+    document.addEventListener('DOMContentLoaded', function() {
+        const deleteForms = document.querySelectorAll('form[action*="/delete"]');
+        deleteForms.forEach(form => {
+            form.addEventListener('submit', function(e) {
+                const button = this.querySelector('button');
+                button.innerHTML = '<i class="bi bi-hourglass-split"></i>';
+                button.disabled = true;
+            });
+        });
+    });
+</script>
+
+<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
+</body>
+</html>
\ No newline at end of file
Index: src/main/webapp/WEB-INF/views/admin/bin-edit.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/WEB-INF/views/admin/bin-edit.jsp b/src/main/webapp/WEB-INF/views/admin/bin-edit.jsp
new file mode 100644
--- /dev/null	(date 1761372868406)
+++ b/src/main/webapp/WEB-INF/views/admin/bin-edit.jsp	(date 1761372868406)
@@ -0,0 +1,537 @@
+<%@ page contentType="text/html;charset=UTF-8" language="java" %>
+<%@ taglib prefix="c"   uri="http://java.sun.com/jsp/jstl/core" %>
+<!DOCTYPE html>
+<html lang="vi">
+<head>
+  <meta charset="UTF-8">
+  <title>Sửa thùng rác #${bin.binID}</title>
+
+  <!-- Bootstrap & Icons -->
+  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
+  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
+
+  <style>
+    /* ======= Light Green Theme - Clean & Modern ======= */
+    :root{
+      --primary-green:#22c55e;
+      --secondary-green:#16a34a;
+      --light-green:#f0fdf4;
+      --border-green:#d1fae5;
+      --text-green:#166534;
+      --muted-green:#6b7280;
+      --white:#ffffff;
+      --light-gray:#f9fafb;
+      --border-gray:#e5e7eb;
+      --text-dark:#111827;
+      --success:#10b981;
+      --warning:#f59e0b;
+      --danger:#ef4444;
+    }
+
+    html,body{
+      height:100%;
+      font-family:'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
+    }
+
+    body{
+      margin:0;
+      background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);
+      color: var(--text-dark);
+      overflow-y:auto;
+      line-height: 1.6;
+    }
+
+    /* ======= Clean card design ======= */
+    .main-card{
+      background: var(--white);
+      border-radius: 16px;
+      border: 1px solid var(--border-green);
+      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
+      padding: 32px;
+      margin-top: 24px;
+    }
+
+    /* ======= Header styles ======= */
+    .page-header{
+      display: flex;
+      align-items: center;
+      justify-content: space-between;
+      margin-bottom: 24px;
+      padding: 24px 0;
+    }
+
+    .page-title{
+      font-size: 28px;
+      font-weight: 700;
+      color: var(--text-dark);
+      display: flex;
+      align-items: center;
+      gap: 12px;
+      margin: 0;
+    }
+
+    .page-title i {
+      color: var(--primary-green);
+      font-size: 32px;
+    }
+
+    /* ======= Navigation button ======= */
+    .btn-back{
+      background: var(--white);
+      border: 1px solid var(--border-gray);
+      color: var(--muted-green);
+      padding: 10px 20px;
+      border-radius: 8px;
+      text-decoration: none;
+      font-weight: 500;
+      transition: all 0.2s ease;
+      display: inline-flex;
+      align-items: center;
+      gap: 8px;
+    }
+
+    .btn-back:hover{
+      background: var(--light-gray);
+      border-color: var(--primary-green);
+      color: var(--primary-green);
+    }
+
+    /* ======= Info notice ======= */
+    .info-notice{
+      background: var(--light-green);
+      border: 1px solid var(--border-green);
+      border-radius: 8px;
+      padding: 16px;
+      margin-bottom: 24px;
+      display: flex;
+      align-items: center;
+      gap: 12px;
+    }
+
+    .info-notice i {
+      color: var(--primary-green);
+      font-size: 18px;
+    }
+
+    .info-notice span {
+      color: var(--text-green);
+      font-size: 14px;
+    }
+
+    /* ======= Form styles ======= */
+    .form-label{
+      font-weight: 600;
+      color: var(--text-dark);
+      margin-bottom: 8px;
+      font-size: 14px;
+    }
+
+    .form-label .required {
+      color: var(--danger);
+    }
+
+    .form-control, .form-select{
+      background: var(--white);
+      border: 1px solid var(--border-gray);
+      border-radius: 8px;
+      padding: 12px 16px;
+      font-size: 14px;
+      color: var(--text-dark);
+      transition: all 0.2s ease;
+    }
+
+    .form-control::placeholder{
+      color: var(--muted-green);
+      font-size: 14px;
+    }
+
+    .form-control:focus, .form-select:focus{
+      background: var(--white);
+      border-color: var(--primary-green);
+      box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.1);
+      outline: none;
+    }
+
+    .form-text{
+      color: var(--muted-green);
+      font-size: 12px;
+      margin-top: 4px;
+    }
+
+    .invalid-feedback{
+      color: var(--danger);
+      font-size: 12px;
+      margin-top: 4px;
+    }
+
+    /* ======= Form validation states ======= */
+    .form-control.is-valid, .form-select.is-valid {
+      border-color: var(--success);
+    }
+
+    .form-control.is-invalid, .form-select.is-invalid {
+      border-color: var(--danger);
+    }
+
+    /* ======= Readonly input ======= */
+    .form-control[readonly] {
+      background: var(--light-gray);
+      color: var(--muted-green);
+    }
+
+    /* ======= Status select with colors ======= */
+    .status-active { color: var(--success) !important; }
+    .status-maintenance { color: var(--warning) !important; }
+    .status-full { color: var(--danger) !important; }
+
+    /* ======= Button styles ======= */
+    .btn-primary{
+      background: var(--primary-green);
+      border: 1px solid var(--primary-green);
+      color: var(--white);
+      padding: 12px 24px;
+      border-radius: 8px;
+      font-weight: 600;
+      font-size: 14px;
+      transition: all 0.2s ease;
+      display: inline-flex;
+      align-items: center;
+      gap: 8px;
+    }
+
+    .btn-primary:hover{
+      background: var(--secondary-green);
+      border-color: var(--secondary-green);
+      transform: translateY(-1px);
+      box-shadow: 0 4px 12px rgba(34, 197, 94, 0.3);
+    }
+
+    .btn-secondary{
+      background: var(--white);
+      border: 1px solid var(--border-gray);
+      color: var(--muted-green);
+      padding: 12px 24px;
+      border-radius: 8px;
+      font-weight: 500;
+      font-size: 14px;
+      transition: all 0.2s ease;
+      text-decoration: none;
+      display: inline-flex;
+      align-items: center;
+      gap: 8px;
+    }
+
+    .btn-secondary:hover{
+      background: var(--light-gray);
+      color: var(--text-dark);
+    }
+
+    /* ======= Alert styles ======= */
+    .alert-danger {
+      background: #fef2f2;
+      border: 1px solid #fecaca;
+      color: #b91c1c;
+      border-radius: 8px;
+      padding: 16px;
+      display: flex;
+      align-items: center;
+      gap: 12px;
+      margin-bottom: 24px;
+    }
+
+    /* ======= Layout ======= */
+    .page-container{
+      max-width: 1200px;
+      margin: 0 auto;
+      padding: 24px;
+    }
+
+    /* ======= Form grid ======= */
+    .form-row {
+      margin-bottom: 24px;
+    }
+
+    /* ======= Action buttons container ======= */
+    .form-actions {
+      margin-top: 32px;
+      padding-top: 24px;
+      border-top: 1px solid var(--border-gray);
+      display: flex;
+      gap: 16px;
+      justify-content: flex-end;
+    }
+
+    /* ======= Responsive adjustments ======= */
+    @media (max-width: 768px) {
+      .page-header {
+        flex-direction: column;
+        align-items: flex-start;
+        gap: 16px;
+      }
+
+      .main-card {
+        padding: 24px 16px;
+      }
+
+      .form-actions {
+        flex-direction: column-reverse;
+      }
+
+      .btn-primary, .btn-secondary {
+        width: 100%;
+        justify-content: center;
+      }
+    }
+  </style>
+</head>
+
+<body>
+<%@ include file="/WEB-INF/views/admin/header_admin.jsp" %>
+
+<div class="page-container">
+  <div class="page-header">
+    <h1 class="page-title">
+      <i class="bi bi-trash3"></i>
+      Sửa thùng rác #${bin.binID}
+    </h1>
+    <a href="${pageContext.request.contextPath}/admin/bins/list" class="btn-back">
+      <i class="bi bi-arrow-left"></i>
+      Danh sách thùng
+    </a>
+  </div>
+
+  <c:if test="${not empty error}">
+    <div class="alert-danger">
+      <i class="bi bi-exclamation-triangle"></i>
+      <span>${error}</span>
+    </div>
+  </c:if>
+
+  <div class="main-card">
+    <div class="info-notice">
+      <i class="bi bi-info-circle"></i>
+      <span>Mã thùng (BinCode) sẽ được hệ thống tự sinh sau khi lưu.</span>
+    </div>
+
+    <form id="binForm" method="post" action="${pageContext.request.contextPath}/admin/bins/${bin.binID}/update" novalidate>
+      <c:if test="${not empty _csrf}">
+        <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
+      </c:if>
+
+      <div class="row g-4">
+        <!-- BinCode readonly -->
+        <div class="col-md-4">
+          <label class="form-label">Mã thùng (BinCode)</label>
+          <input type="text" class="form-control" value="${bin.binCode}" readonly>
+          <div class="form-text">Mã thùng được hệ thống tự sinh.</div>
+        </div>
+
+        <div class="col-md-8">
+          <label class="form-label">Tên đường</label>
+          <input type="text" name="street" class="form-control" maxlength="255" value="${bin.street}" placeholder="Nhập tên đường">
+        </div>
+
+        <div class="col-md-4">
+          <label class="form-label">Phường <span class="required">*</span></label>
+          <select name="wardID" id="wardID" class="form-select" required>
+            <option value="">-- Chọn phường --</option>
+            <c:forEach var="w" items="${wards}">
+              <option value="${w.wardId}" ${w.wardId == bin.wardID ? 'selected="selected"' : ''}>
+                  ${w.wardName}
+              </option>
+            </c:forEach>
+          </select>
+          <div class="invalid-feedback">Vui lòng chọn phường.</div>
+        </div>
+
+        <div class="col-md-4">
+          <label class="form-label">Vĩ độ (Latitude)</label>
+          <input type="number" step="0.000001" name="latitude" id="latitude" class="form-control" value="${bin.latitude}" placeholder="16.07177">
+          <div class="form-text">Ví dụ: 16.07177</div>
+          <div class="invalid-feedback">Vĩ độ hợp lệ nằm trong [-90, 90].</div>
+        </div>
+
+        <div class="col-md-4">
+          <label class="form-label">Kinh độ (Longitude)</label>
+          <input type="number" step="0.000001" name="longitude" id="longitude" class="form-control" value="${bin.longitude}" placeholder="108.22057">
+          <div class="form-text">Ví dụ: 108.22057</div>
+          <div class="invalid-feedback">Kinh độ hợp lệ nằm trong [-180, 180].</div>
+        </div>
+
+        <div class="col-md-4">
+          <label class="form-label">Dung tích (lít) <span class="required">*</span></label>
+          <input type="number" step="0.01" name="capacity" id="capacity" class="form-control" value="${bin.capacity}" placeholder="120">
+          <div class="form-text">Dung tích tối đa của thùng</div>
+          <div class="invalid-feedback">Dung tích phải lớn hơn 0.</div>
+        </div>
+
+        <div class="col-md-4">
+          <label class="form-label">% đầy hiện tại</label>
+          <input type="number" step="0.01" name="currentFill" id="currentFill" class="form-control" value="${bin.currentFill}" placeholder="0">
+          <div class="form-text">Mức đầy hiện tại (%)</div>
+          <div class="invalid-feedback">% đầy không được âm.</div>
+        </div>
+
+        <div class="col-md-4">
+          <label class="form-label">Trạng thái</label>
+          <select name="status" class="form-select">
+            <option value="1" class="status-active" ${bin.status == 1 ? 'selected' : ''}>● Hoạt động</option>
+            <option value="0" class="status-maintenance" ${bin.status == 0 ? 'selected' : ''}>● Bảo trì</option>
+            <option value="2" class="status-full" ${bin.status == 2 ? 'selected' : ''}>● Đầy / Mất kết nối</option>
+          </select>
+        </div>
+      </div>
+
+      <div class="form-actions">
+        <a href="${pageContext.request.contextPath}/admin/bins/list" class="btn-secondary">
+          <i class="bi bi-x-lg"></i>
+          Hủy
+        </a>
+        <button type="submit" class="btn-primary">
+          <i class="bi bi-check-lg"></i>
+          Lưu thùng rác
+        </button>
+      </div>
+    </form>
+  </div>
+</div>
+
+<!-- Bootstrap JS -->
+<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
+
+<script>
+  // Enhanced client-side validation
+  (function () {
+    const form  = document.getElementById('binForm');
+
+    // Real-time validation
+    const inputs = form.querySelectorAll('input, select');
+    inputs.forEach(input => {
+      input.addEventListener('blur', validateField);
+      input.addEventListener('input', clearValidation);
+    });
+
+    function clearValidation(e) {
+      e.target.classList.remove('is-invalid', 'is-valid');
+    }
+
+    function validateField(e) {
+      const field = e.target;
+      const value = field.value.trim();
+      let isValid = true;
+
+      switch(field.id) {
+        case 'wardID':
+          isValid = value !== '';
+          break;
+        case 'latitude':
+          if (value) {
+            const lat = parseFloat(value);
+            isValid = !isNaN(lat) && lat >= -90 && lat <= 90;
+          }
+          break;
+        case 'longitude':
+          if (value) {
+            const lng = parseFloat(value);
+            isValid = !isNaN(lng) && lng >= -180 && lng <= 180;
+          }
+          break;
+        case 'capacity':
+          if (value) {
+            const cap = parseFloat(value);
+            isValid = !isNaN(cap) && cap > 0;
+          }
+          break;
+        case 'currentFill':
+          if (value) {
+            const cf = parseFloat(value);
+            isValid = !isNaN(cf) && cf >= 0;
+          }
+          break;
+      }
+
+      if (value !== '') {
+        field.classList.toggle('is-invalid', !isValid);
+        field.classList.toggle('is-valid', isValid);
+      }
+    }
+
+    // Form submission validation
+    form.addEventListener('submit', function (e) {
+      let ok = true;
+      const wardID = document.getElementById('wardID');
+      const latEl  = document.getElementById('latitude');
+      const lngEl  = document.getElementById('longitude');
+      const capEl  = document.getElementById('capacity');
+      const fillEl = document.getElementById('currentFill');
+
+      // Validate required fields
+      if (!wardID.value) {
+        wardID.classList.add('is-invalid');
+        ok = false;
+      } else {
+        wardID.classList.remove('is-invalid');
+        wardID.classList.add('is-valid');
+      }
+
+      // Validate optional fields if filled
+      if (latEl.value) {
+        const lat = parseFloat(latEl.value);
+        if (isNaN(lat) || lat < -90 || lat > 90) {
+          latEl.classList.add('is-invalid');
+          ok = false;
+        } else {
+          latEl.classList.remove('is-invalid');
+          latEl.classList.add('is-valid');
+        }
+      }
+
+      if (lngEl.value) {
+        const lng = parseFloat(lngEl.value);
+        if (isNaN(lng) || lng < -180 || lng > 180) {
+          lngEl.classList.add('is-invalid');
+          ok = false;
+        } else {
+          lngEl.classList.remove('is-invalid');
+          lngEl.classList.add('is-valid');
+        }
+      }
+
+      if (capEl.value) {
+        const cap = parseFloat(capEl.value);
+        if (isNaN(cap) || cap <= 0) {
+          capEl.classList.add('is-invalid');
+          ok = false;
+        } else {
+          capEl.classList.remove('is-invalid');
+          capEl.classList.add('is-valid');
+        }
+      }
+
+      if (fillEl.value) {
+        const cf = parseFloat(fillEl.value);
+        if (isNaN(cf) || cf < 0) {
+          fillEl.classList.add('is-invalid');
+          ok = false;
+        } else {
+          fillEl.classList.remove('is-invalid');
+          fillEl.classList.add('is-valid');
+        }
+      }
+
+      if (!ok) {
+        e.preventDefault();
+        e.stopPropagation();
+
+        // Smooth scroll to first invalid field
+        const firstInvalid = form.querySelector('.is-invalid');
+        if (firstInvalid) {
+          firstInvalid.scrollIntoView({ behavior: 'smooth', block: 'center' });
+          setTimeout(() => firstInvalid.focus(), 300);
+        }
+      }
+    });
+  })();
+</script>
+</body>
+</html>
\ No newline at end of file
Index: src/main/webapp/index.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%>\r\n<%@ taglib uri=\"http://java.sun.com/jsp/jstl/core\" prefix=\"c\" %>\r\n<c:redirect url=\"/manager\"/>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/index.jsp b/src/main/webapp/index.jsp
--- a/src/main/webapp/index.jsp	(revision d5967c2b6ed473a29e85a3d5aec3773d786b9f66)
+++ b/src/main/webapp/index.jsp	(date 1761372868408)
@@ -1,3 +1,0 @@
-<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
-<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
-<c:redirect url="/manager"/>
Index: src/main/webapp/WEB-INF/views/admin/header_admin.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/WEB-INF/views/admin/header_admin.jsp b/src/main/webapp/WEB-INF/views/admin/header_admin.jsp
new file mode 100644
--- /dev/null	(date 1761372868406)
+++ b/src/main/webapp/WEB-INF/views/admin/header_admin.jsp	(date 1761372868406)
@@ -0,0 +1,149 @@
+<%@ page contentType="text/html;charset=UTF-8" language="java" %>
+<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
+
+<div class="d-flex flex-column vh-100 bg-dark text-white position-fixed start-0 top-0" style="width: 250px; z-index: 1000;">
+  <!-- Header -->
+  <div class="p-4 border-bottom border-secondary">
+    <h4 class="mb-0 text-success fw-bold">
+      ♻️ SmartBin Admin
+    </h4>
+    <small class="text-muted">Hệ thống quản trị SmartBin</small>
+  </div>
+
+  <!-- Navigation Menu -->
+  <nav class="flex-grow-1 py-3">
+    <ul class="nav nav-pills flex-column px-3" id="sidebar-menu">
+      <li class="nav-item mb-2">
+        <a href="${pageContext.request.contextPath}/admin/overview"
+           class="nav-link text-white d-flex align-items-center py-3 px-3 rounded sidebar-link"
+           data-path="/admin/overview">
+          <span class="me-3 fs-5">📊</span>
+          <span class="fw-semibold">Dashboard</span>
+        </a>
+      </li>
+
+      <li class="nav-item mb-2">
+        <a href="${pageContext.request.contextPath}/admin/accounts"
+           class="nav-link text-white d-flex align-items-center py-3 px-3 rounded sidebar-link"
+           data-path="/admin/accounts">
+          <span class="me-3 fs-5">🧑‍💼</span>
+          <span class="fw-semibold">Tài khoản</span>
+        </a>
+      </li>
+
+      <li class="nav-item mb-2">
+        <a href="${pageContext.request.contextPath}/admin/areas"
+           class="nav-link text-white d-flex align-items-center py-3 px-3 rounded sidebar-link"
+           data-path="/admin/areas">
+          <span class="me-3 fs-5">📍</span>
+          <span class="fw-semibold">Khu vực</span>
+        </a>
+      </li>
+
+      <li class="nav-item mb-2">
+        <a href="${pageContext.request.contextPath}/admin/applications"
+           class="nav-link text-white d-flex align-items-center py-3 px-3 rounded sidebar-link"
+           data-path="/admin/applications">
+          <span class="me-3 fs-5">📑</span>
+          <span class="fw-semibold">Hợp đồng</span>
+        </a>
+      </li>
+
+      <li class="nav-item mb-2">
+        <a href="${pageContext.request.contextPath}/admin/reports"
+           class="nav-link text-white d-flex align-items-center py-3 px-3 rounded sidebar-link"
+           data-path="/admin/reports">
+          <span class="me-3 fs-5">📈</span>
+          <span class="fw-semibold">Báo cáo</span>
+        </a>
+      </li>
+
+      <li class="nav-item mb-2">
+        <a href="${pageContext.request.contextPath}/chat/admin"
+           class="nav-link text-white d-flex align-items-center py-3 px-3 rounded sidebar-link"
+           data-path="/chat/admin">
+          <span class="me-3 fs-5">💬</span>
+          <span class="fw-semibold">Chat</span>
+        </a>
+      </li>
+    </ul>
+  </nav>
+
+  <!-- User Info Footer -->
+  <div class="mt-auto p-3 border-top border-secondary">
+    <div class="d-flex align-items-center">
+      <div class="bg-success rounded-circle d-flex align-items-center justify-content-center me-3"
+           style="width: 45px; height: 45px;">
+        <span class="text-white fs-5">👤</span>
+      </div>
+      <div class="flex-grow-1">
+        <div class="fw-bold small text-white">
+          <c:choose>
+            <c:when test="${not empty sessionScope.user}">
+              ${sessionScope.user.username}
+            </c:when>
+            <c:otherwise>
+              Admin
+            </c:otherwise>
+          </c:choose>
+        </div>
+        <div class="text-muted small">Quản trị viên</div>
+      </div>
+      <a href="${pageContext.request.contextPath}/logout"
+         class="btn btn-outline-light btn-sm"
+         title="Đăng xuất">
+        <i class="bi bi-box-arrow-right"></i>
+      </a>
+    </div>
+  </div>
+</div>
+
+<!-- Bootstrap JS -->
+<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
+
+<style>
+  .sidebar-link {
+    transition: all 0.3s ease;
+    border: none;
+  }
+
+  .sidebar-link:hover {
+    background-color: rgba(255, 255, 255, 0.1) !important;
+    transform: translateX(5px);
+  }
+
+  .sidebar-link.active {
+    background-color: #198754 !important; /* Xanh lá Admin */
+    box-shadow: 0 2px 8px rgba(25, 135, 84, 0.3);
+  }
+
+  .dropdown-item {
+    transition: all 0.2s ease;
+  }
+
+  .dropdown-item:hover {
+    background-color: rgba(255, 255, 255, 0.1) !important;
+    padding-left: 20px !important;
+  }
+
+  .nav-item .dropdown-toggle::after {
+    margin-left: auto;
+  }
+</style>
+
+<script>
+  document.addEventListener('DOMContentLoaded', function() {
+    let currentPath = window.location.pathname;
+    const contextPath = '${pageContext.request.contextPath}';
+    if (contextPath && currentPath.startsWith(contextPath)) {
+      currentPath = currentPath.substring(contextPath.length);
+    }
+
+    document.querySelectorAll('.sidebar-link').forEach(link => {
+      const linkPath = link.getAttribute('data-path');
+      if (linkPath && currentPath.startsWith(linkPath)) {
+        link.classList.add('active');
+      }
+    });
+  });
+</script>
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"ArtifactsWorkspaceSettings\">\r\n    <artifacts-to-build>\r\n      <artifact name=\"SmartBinWeb:war\" />\r\n    </artifacts-to-build>\r\n  </component>\r\n  <component name=\"AutoImportSettings\">\r\n    <option name=\"autoReloadType\" value=\"SELECTIVE\" />\r\n  </component>\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"849682ca-ca30-4ed2-b49d-5dee5331a97f\" name=\"Changes\" comment=\"comiit\">\r\n      <change beforePath=\"$PROJECT_DIR$/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\r\n    </list>\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"FileTemplateManagerImpl\">\r\n    <option name=\"RECENT_TEMPLATES\">\r\n      <list>\r\n        <option value=\"Class\" />\r\n        <option value=\"Jsp File\" />\r\n      </list>\r\n    </option>\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\r\n  </component>\r\n  <component name=\"LogFilters\">\r\n    <option name=\"FILTER_ERRORS\" value=\"false\" />\r\n    <option name=\"FILTER_WARNINGS\" value=\"false\" />\r\n    <option name=\"FILTER_INFO\" value=\"true\" />\r\n    <option name=\"FILTER_DEBUG\" value=\"true\" />\r\n    <option name=\"CUSTOM_FILTER\" />\r\n  </component>\r\n  <component name=\"MarkdownSettingsMigration\">\r\n    <option name=\"stateVersion\" value=\"1\" />\r\n  </component>\r\n  <component name=\"ProjectId\" id=\"30pL3yyOEXRKVcM3MrJMKBrKM2u\" />\r\n  <component name=\"ProjectLevelVcsManager\" settingsEditedManually=\"true\">\r\n    <ConfirmationsSetting value=\"1\" id=\"Add\" />\r\n  </component>\r\n  <component name=\"ProjectViewState\">\r\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\r\n    <option name=\"showLibraryContents\" value=\"true\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\"><![CDATA[{\r\n  \"keyToString\": {\r\n    \"RunOnceActivity.OpenProjectViewOnStart\": \"true\",\r\n    \"RunOnceActivity.ShowReadmeOnStart\": \"true\",\r\n    \"WebServerToolWindowFactoryState\": \"false\",\r\n    \"last_opened_file_path\": \"D:/TestSpring/springmvc-java-config-jpa-master/SmartBinWeb/src/main/java/com/example/service\",\r\n    \"node.js.detected.package.eslint\": \"true\",\r\n    \"node.js.detected.package.tslint\": \"true\",\r\n    \"node.js.selected.package.eslint\": \"(autodetect)\",\r\n    \"node.js.selected.package.tslint\": \"(autodetect)\",\r\n    \"nodejs_package_manager_path\": \"npm\",\r\n    \"project.structure.last.edited\": \"Libraries\",\r\n    \"project.structure.proportion\": \"0.15\",\r\n    \"project.structure.side.proportion\": \"0.2\",\r\n    \"settings.editor.selected.configurable\": \"spring.boot.initializr\",\r\n    \"spring.configuration.checksum\": \"587566023d1145a0fe9811126ca1e331\"\r\n  }\r\n}]]></component>\r\n  <component name=\"RecentsManager\">\r\n    <key name=\"CopyFile.RECENT_KEYS\">\r\n      <recent name=\"D:\\TestSpring\\springmvc-java-config-jpa-master\\SmartBinWeb\\src\\main\\java\\com\\example\\service\" />\r\n      <recent name=\"D:\\TestSpring\\springmvc-java-config-jpa-master\\SmartBinWeb\\src\\main\\webapp\\WEB-INF\\views\\manager\" />\r\n      <recent name=\"D:\\TestSpring\\springmvc-java-config-jpa-master\\SmartBinWeb\\src\\main\\webapp\\WEB-INF\" />\r\n      <recent name=\"D:\\TestSpring\\springmvc-java-config-jpa-master\\SmartBin\\src\\main\" />\r\n    </key>\r\n    <key name=\"CopyClassDialog.RECENTS_KEY\">\r\n      <recent name=\"com.example.model\" />\r\n      <recent name=\"com.example.controller.app\" />\r\n    </key>\r\n  </component>\r\n  <component name=\"RunManager\">\r\n    <configuration name=\"Tomcat VIP\" type=\"#com.intellij.j2ee.web.tomcat.TomcatRunConfigurationFactory\" factoryName=\"Local\" APPLICATION_SERVER_NAME=\"Tomcat VIP\" ALTERNATIVE_JRE_ENABLED=\"false\" nameIsGenerated=\"true\">\r\n      <option name=\"OPEN_IN_BROWSER_URL\" value=\"http://localhost:8080/SmartBinWeb_war/home\" />\r\n      <option name=\"UPDATING_POLICY\" value=\"restart-server\" />\r\n      <deployment>\r\n        <artifact name=\"SmartBinWeb:war\">\r\n          <settings>\r\n            <option name=\"CONTEXT_PATH\" value=\"/SmartBinWeb_war\" />\r\n          </settings>\r\n        </artifact>\r\n      </deployment>\r\n      <server-settings>\r\n        <option name=\"BASE_DIRECTORY_NAME\" value=\"26571206-e5e0-4008-a514-c1cd94c979f4\" />\r\n      </server-settings>\r\n      <predefined_log_file enabled=\"true\" id=\"Tomcat\" />\r\n      <predefined_log_file enabled=\"true\" id=\"Tomcat Catalina\" />\r\n      <predefined_log_file id=\"Tomcat Manager\" />\r\n      <predefined_log_file id=\"Tomcat Host Manager\" />\r\n      <predefined_log_file id=\"Tomcat Localhost Access\" />\r\n      <RunnerSettings RunnerId=\"Debug\">\r\n        <option name=\"DEBUG_PORT\" value=\"49386\" />\r\n      </RunnerSettings>\r\n      <ConfigurationWrapper VM_VAR=\"JAVA_OPTS\" RunnerId=\"Cover\">\r\n        <option name=\"USE_ENV_VARIABLES\" value=\"true\" />\r\n        <STARTUP>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </STARTUP>\r\n        <SHUTDOWN>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </SHUTDOWN>\r\n      </ConfigurationWrapper>\r\n      <ConfigurationWrapper VM_VAR=\"JAVA_OPTS\" RunnerId=\"Debug\">\r\n        <option name=\"USE_ENV_VARIABLES\" value=\"true\" />\r\n        <STARTUP>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </STARTUP>\r\n        <SHUTDOWN>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </SHUTDOWN>\r\n      </ConfigurationWrapper>\r\n      <ConfigurationWrapper VM_VAR=\"JAVA_OPTS\" RunnerId=\"Profile\">\r\n        <option name=\"USE_ENV_VARIABLES\" value=\"true\" />\r\n        <STARTUP>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </STARTUP>\r\n        <SHUTDOWN>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </SHUTDOWN>\r\n      </ConfigurationWrapper>\r\n      <ConfigurationWrapper VM_VAR=\"JAVA_OPTS\" RunnerId=\"Run\">\r\n        <option name=\"USE_ENV_VARIABLES\" value=\"true\" />\r\n        <STARTUP>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </STARTUP>\r\n        <SHUTDOWN>\r\n          <option name=\"USE_DEFAULT\" value=\"true\" />\r\n          <option name=\"SCRIPT\" value=\"\" />\r\n          <option name=\"VM_PARAMETERS\" value=\"\" />\r\n          <option name=\"PROGRAM_PARAMETERS\" value=\"\" />\r\n        </SHUTDOWN>\r\n      </ConfigurationWrapper>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n        <option name=\"BuildArtifacts\" enabled=\"true\">\r\n          <artifact name=\"SmartBinWeb:war\" />\r\n        </option>\r\n      </method>\r\n    </configuration>\r\n  </component>\r\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\r\n  <component name=\"TaskManager\">\r\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\r\n      <changelist id=\"849682ca-ca30-4ed2-b49d-5dee5331a97f\" name=\"Changes\" comment=\"\" />\r\n      <created>1754319374370</created>\r\n      <option name=\"number\" value=\"Default\" />\r\n      <option name=\"presentableId\" value=\"Default\" />\r\n      <updated>1754319374370</updated>\r\n      <workItem from=\"1754319376056\" duration=\"769000\" />\r\n      <workItem from=\"1754495850102\" duration=\"1164000\" />\r\n      <workItem from=\"1754497038001\" duration=\"17000\" />\r\n      <workItem from=\"1754497261567\" duration=\"1175000\" />\r\n      <workItem from=\"1754498867293\" duration=\"2358000\" />\r\n      <workItem from=\"1754675005921\" duration=\"2245000\" />\r\n      <workItem from=\"1754925330255\" duration=\"1813000\" />\r\n      <workItem from=\"1754927903177\" duration=\"168000\" />\r\n      <workItem from=\"1754928168021\" duration=\"1922000\" />\r\n      <workItem from=\"1754985779617\" duration=\"3726000\" />\r\n      <workItem from=\"1755013857560\" duration=\"410000\" />\r\n      <workItem from=\"1755014370578\" duration=\"1202000\" />\r\n      <workItem from=\"1755016442713\" duration=\"5831000\" />\r\n      <workItem from=\"1755026370125\" duration=\"923000\" />\r\n      <workItem from=\"1755933453913\" duration=\"2208000\" />\r\n      <workItem from=\"1755944794991\" duration=\"294000\" />\r\n      <workItem from=\"1755945736234\" duration=\"84000\" />\r\n      <workItem from=\"1755946726774\" duration=\"352000\" />\r\n      <workItem from=\"1755947570220\" duration=\"3990000\" />\r\n      <workItem from=\"1755964707426\" duration=\"2789000\" />\r\n      <workItem from=\"1755974985789\" duration=\"177000\" />\r\n      <workItem from=\"1755975526748\" duration=\"2737000\" />\r\n      <workItem from=\"1756034056618\" duration=\"291000\" />\r\n      <workItem from=\"1756034430328\" duration=\"426000\" />\r\n      <workItem from=\"1756034888540\" duration=\"195000\" />\r\n      <workItem from=\"1756049671387\" duration=\"2596000\" />\r\n      <workItem from=\"1756054434141\" duration=\"1829000\" />\r\n      <workItem from=\"1756056292376\" duration=\"5571000\" />\r\n      <workItem from=\"1756065257439\" duration=\"4250000\" />\r\n      <workItem from=\"1756129029285\" duration=\"599000\" />\r\n      <workItem from=\"1756180828024\" duration=\"1953000\" />\r\n    </task>\r\n    <task id=\"LOCAL-00001\" summary=\"comiit\">\r\n      <created>1754319433468</created>\r\n      <option name=\"number\" value=\"00001\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00001\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1754319433468</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00002\" summary=\"comiit\">\r\n      <created>1754496085432</created>\r\n      <option name=\"number\" value=\"00002\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00002\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1754496085432</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00003\" summary=\"comiit\">\r\n      <created>1754675452414</created>\r\n      <option name=\"number\" value=\"00003\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00003\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1754675452414</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00004\" summary=\"comiit\">\r\n      <created>1754675585718</created>\r\n      <option name=\"number\" value=\"00004\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00004\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1754675585718</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00005\" summary=\"comiit\">\r\n      <created>1754676574276</created>\r\n      <option name=\"number\" value=\"00005\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00005\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1754676574276</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00006\" summary=\"comiit\">\r\n      <created>1754926548512</created>\r\n      <option name=\"number\" value=\"00006\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00006\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1754926548512</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00007\" summary=\"comiit\">\r\n      <created>1754927955631</created>\r\n      <option name=\"number\" value=\"00007\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00007\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1754927955631</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00008\" summary=\"comiit\">\r\n      <created>1754928027831</created>\r\n      <option name=\"number\" value=\"00008\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00008\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1754928027831</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00009\" summary=\"comiit\">\r\n      <created>1754928338350</created>\r\n      <option name=\"number\" value=\"00009\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00009\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1754928338350</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00010\" summary=\"comiit\">\r\n      <created>1754929457409</created>\r\n      <option name=\"number\" value=\"00010\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00010\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1754929457409</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00011\" summary=\"comiit\">\r\n      <created>1756100696659</created>\r\n      <option name=\"number\" value=\"00011\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00011\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1756100696659</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00012\" summary=\"comiit\">\r\n      <created>1756180864431</created>\r\n      <option name=\"number\" value=\"00012\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00012\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1756180864431</updated>\r\n    </task>\r\n    <task id=\"LOCAL-00013\" summary=\"comiit\">\r\n      <created>1756182676354</created>\r\n      <option name=\"number\" value=\"00013\" />\r\n      <option name=\"presentableId\" value=\"LOCAL-00013\" />\r\n      <option name=\"project\" value=\"LOCAL\" />\r\n      <updated>1756182676354</updated>\r\n    </task>\r\n    <option name=\"localTasksCounter\" value=\"14\" />\r\n    <servers />\r\n  </component>\r\n  <component name=\"TypeScriptGeneratedFilesManager\">\r\n    <option name=\"version\" value=\"3\" />\r\n  </component>\r\n  <component name=\"Vcs.Log.Tabs.Properties\">\r\n    <option name=\"TAB_STATES\">\r\n      <map>\r\n        <entry key=\"MAIN\">\r\n          <value>\r\n            <State />\r\n          </value>\r\n        </entry>\r\n      </map>\r\n    </option>\r\n  </component>\r\n  <component name=\"VcsManagerConfiguration\">\r\n    <MESSAGE value=\"comiit\" />\r\n    <option name=\"LAST_COMMIT_MESSAGE\" value=\"comiit\" />\r\n  </component>\r\n  <component name=\"XDebuggerManager\">\r\n    <breakpoint-manager>\r\n      <breakpoints>\r\n        <breakpoint enabled=\"true\" type=\"java-exception\">\r\n          <properties class=\"java.lang.RuntimeException\" package=\"java.lang\" />\r\n          <option name=\"timeStamp\" value=\"1\" />\r\n        </breakpoint>\r\n      </breakpoints>\r\n    </breakpoint-manager>\r\n  </component>\r\n  <component name=\"XSLT-Support.FileAssociations.UIState\">\r\n    <expand />\r\n    <select />\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision d5967c2b6ed473a29e85a3d5aec3773d786b9f66)
+++ b/.idea/workspace.xml	(date 1761374350131)
@@ -9,8 +9,51 @@
     <option name="autoReloadType" value="SELECTIVE" />
   </component>
   <component name="ChangeListManager">
-    <list default="true" id="849682ca-ca30-4ed2-b49d-5dee5331a97f" name="Changes" comment="comiit">
+    <list default="true" id="849682ca-ca30-4ed2-b49d-5dee5331a97f" name="Changes" comment="commmit WebSocketConfig new">
+      <change afterPath="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_9_25_2025_10_44_PM_[Changes]/shelved.patch" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_9_25_2025_10_44_PM__Changes_.xml" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/controller/AdminAccountController.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/controller/AdminApplicationController.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/controller/AdminBinController.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/controller/AdminFileController.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/controller/AdminOverviewController.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/controller/ChatController.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/controller/FileDownloadController.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/controller/RegisterManagerController.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/model/AccountConst.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/model/Chat.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/model/ManagerApplication.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/repository/ChatRepository.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/repository/ManagerApplicationRepository.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/repository/TaskGateway.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/service/AdminAccountService.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/service/ChatService.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/service/FileStorageService.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/java/com/example/service/ManagerApplicationService.java" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/views/admin/accounts-role-table.jsp" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/views/admin/accounts.jsp" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/views/admin/admin_chat_list.jsp" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/views/admin/application-detail.jsp" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/views/admin/applications.jsp" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/views/admin/bin-add.jsp" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/views/admin/bin-edit.jsp" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/views/admin/bins.jsp" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/views/admin/chat_room.jsp" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/views/admin/header_admin.jsp" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/views/admin/overview.jsp" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/views/index.jsp" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/views/manage/register-manager.jsp" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/src/main/webapp/assets/contracts/HopDong_SmartBin.docx" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_9_6_2025_8_04_PM__Changes_.xml" beforeDir="false" />
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/pom.xml" beforeDir="false" afterPath="$PROJECT_DIR$/pom.xml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/com/example/config/GoogleCloudConfig.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/com/example/config/GoogleCloudConfig.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/com/example/controller/HomeController.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/com/example/controller/HomeController.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/com/example/controller/app/NotificationController.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/com/example/controller/app/NotificationController.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/com/example/model/Task.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/com/example/model/Task.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/java/com/example/service/TasksService.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/com/example/service/TasksService.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/webapp/WEB-INF/applicationContext.xml" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/webapp/WEB-INF/applicationContext.xml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/src/main/webapp/index.jsp" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/webapp/index.jsp" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
@@ -46,24 +89,24 @@
     <option name="hideEmptyMiddlePackages" value="true" />
     <option name="showLibraryContents" value="true" />
   </component>
-  <component name="PropertiesComponent"><![CDATA[{
-  "keyToString": {
-    "RunOnceActivity.OpenProjectViewOnStart": "true",
-    "RunOnceActivity.ShowReadmeOnStart": "true",
-    "WebServerToolWindowFactoryState": "false",
-    "last_opened_file_path": "D:/TestSpring/springmvc-java-config-jpa-master/SmartBinWeb/src/main/java/com/example/service",
-    "node.js.detected.package.eslint": "true",
-    "node.js.detected.package.tslint": "true",
-    "node.js.selected.package.eslint": "(autodetect)",
-    "node.js.selected.package.tslint": "(autodetect)",
-    "nodejs_package_manager_path": "npm",
-    "project.structure.last.edited": "Libraries",
-    "project.structure.proportion": "0.15",
-    "project.structure.side.proportion": "0.2",
-    "settings.editor.selected.configurable": "spring.boot.initializr",
-    "spring.configuration.checksum": "587566023d1145a0fe9811126ca1e331"
+  <component name="PropertiesComponent">{
+  &quot;keyToString&quot;: {
+    &quot;RunOnceActivity.OpenProjectViewOnStart&quot;: &quot;true&quot;,
+    &quot;RunOnceActivity.ShowReadmeOnStart&quot;: &quot;true&quot;,
+    &quot;WebServerToolWindowFactoryState&quot;: &quot;false&quot;,
+    &quot;last_opened_file_path&quot;: &quot;D:/TestSpring/springmvc-java-config-jpa-master/SmartBinWeb/src/main/java/com/example/service&quot;,
+    &quot;node.js.detected.package.eslint&quot;: &quot;true&quot;,
+    &quot;node.js.detected.package.tslint&quot;: &quot;true&quot;,
+    &quot;node.js.selected.package.eslint&quot;: &quot;(autodetect)&quot;,
+    &quot;node.js.selected.package.tslint&quot;: &quot;(autodetect)&quot;,
+    &quot;nodejs_package_manager_path&quot;: &quot;npm&quot;,
+    &quot;project.structure.last.edited&quot;: &quot;Libraries&quot;,
+    &quot;project.structure.proportion&quot;: &quot;0.15&quot;,
+    &quot;project.structure.side.proportion&quot;: &quot;0.2&quot;,
+    &quot;settings.editor.selected.configurable&quot;: &quot;spring.boot.initializr&quot;,
+    &quot;spring.configuration.checksum&quot;: &quot;587566023d1145a0fe9811126ca1e331&quot;
   }
-}]]></component>
+}</component>
   <component name="RecentsManager">
     <key name="CopyFile.RECENT_KEYS">
       <recent name="D:\TestSpring\springmvc-java-config-jpa-master\SmartBinWeb\src\main\java\com\example\service" />
@@ -316,7 +359,8 @@
   </component>
   <component name="VcsManagerConfiguration">
     <MESSAGE value="comiit" />
-    <option name="LAST_COMMIT_MESSAGE" value="comiit" />
+    <MESSAGE value="commmit WebSocketConfig new" />
+    <option name="LAST_COMMIT_MESSAGE" value="commmit WebSocketConfig new" />
   </component>
   <component name="XDebuggerManager">
     <breakpoint-manager>
Index: src/main/webapp/WEB-INF/views/admin/chat_room.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/WEB-INF/views/admin/chat_room.jsp b/src/main/webapp/WEB-INF/views/admin/chat_room.jsp
new file mode 100644
--- /dev/null	(date 1761372868406)
+++ b/src/main/webapp/WEB-INF/views/admin/chat_room.jsp	(date 1761372868406)
@@ -0,0 +1,176 @@
+<%@ page contentType="text/html;charset=UTF-8" %>
+<%@ taglib prefix="c"  uri="http://java.sun.com/jsp/jstl/core" %>
+<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
+
+<!DOCTYPE html>
+<html lang="vi">
+<head>
+    <title>Chat – Hội thoại</title>
+    <meta name="viewport" content="width=device-width, initial-scale=1"/>
+    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
+
+    <style>
+        :root{
+            --primary-green:#22c55e; --secondary-green:#16a34a;
+            --light-green:#f0fdf4; --border-green:#d1fae5; --text-green:#166534;
+            --bg:#f8fafc;
+        }
+        body{ background:var(--bg); }
+        .chat-shell{ max-width:900px; margin:auto; }
+        .chat-card{ border:1px solid var(--border-green); border-radius:16px; overflow:hidden; box-shadow:0 2px 6px rgba(0,0,0,.06); background:#fff; }
+        .chat-header{ background:var(--light-green); border-bottom:1px solid var(--border-green); color:var(--text-green); font-weight:700; }
+        .chat-body{ height:60vh; overflow-y:auto; padding:16px; background:#fff; }
+        .msg{ max-width:68%; padding:10px 12px; border-radius:12px; margin-bottom:10px; word-break:break-word; }
+        .from-me{ margin-left:auto; background:#dcfce7; border:1px solid var(--border-green); }
+        .from-them{ margin-right:auto; background:#f3f4f6; border:1px solid #e5e7eb; }
+        .msg-time{ font-size:.75rem; color:#64748b; margin-top:4px; }
+        .chat-footer{ border-top:1px solid var(--border-green); background:#fff; }
+        .btn-send{ background:var(--primary-green); border-color:var(--secondary-green); color:#fff; }
+        .btn-send:hover{ background:var(--secondary-green); border-color:var(--secondary-green); color:#fff; }
+    </style>
+</head>
+<body>
+<jsp:include page="/WEB-INF/views/admin/header_admin.jsp"/>
+
+<div class="container py-4 chat-shell">
+    <div class="chat-card">
+        <div class="chat-header p-3 d-flex justify-content-between align-items-center">
+            <div><i class="bi bi-chat-dots me-2"></i>Hội thoại</div>
+            <div>
+                <a class="btn btn-sm btn-outline-success" href="javascript:location.reload()">Làm mới</a>
+            </div>
+        </div>
+
+        <!-- Lịch sử -->
+        <div id="chatBody" class="chat-body">
+            <c:set var="meId" value="${sessionScope.currentUser != null ? sessionScope.currentUser.accountId : 0}"/>
+            <c:forEach var="m" items="${conversation}">
+                <div class="d-flex ${m.sender.accountId == meId ? 'justify-content-end' : 'justify-content-start'}">
+                    <div class="msg ${m.sender.accountId == meId ? 'from-me' : 'from-them'}">
+                        <div><c:out value="${m.message}"/></div>
+                        <div class="msg-time">
+                            <fmt:formatDate value="${m.sentAt}" pattern="dd/MM/yyyy HH:mm"/>
+                            <c:if test="${m.sender.accountId == meId}">
+                                • <span><c:out value="${m.read ? 'Đã đọc' : 'Đã gửi'}"/></span>
+                            </c:if>
+                        </div>
+                    </div>
+                </div>
+            </c:forEach>
+
+            <c:if test="${empty conversation}">
+                <div class="text-center text-muted py-5">Chưa có tin nhắn. Hãy gửi tin đầu tiên 👋</div>
+            </c:if>
+        </div>
+
+        <!-- Gửi tin -->
+        <div class="chat-footer p-3">
+            <form method="post" action="${pageContext.request.contextPath}/chat/send" class="row g-2"
+                  onsubmit="return trimCheck()">
+                <input type="hidden" name="receiverId" value="${receiverId}"/>
+                <div class="col-12 col-md-10">
+                    <textarea class="form-control" name="message" rows="2" placeholder="Nhập tin nhắn..." required></textarea>
+                </div>
+                <div class="col-12 col-md-2 d-grid">
+                    <button class="btn btn-send" type="submit">
+                        <i class="bi bi-send-fill me-1"></i> Gửi
+                    </button>
+                </div>
+            </form>
+        </div>
+    </div>
+
+    <div class="mt-3">
+        <c:if test="${sessionScope.currentUser != null && sessionScope.currentUser.role == 1}">
+            <a class="btn btn-outline-secondary" href="${pageContext.request.contextPath}/chat/admin">
+                ← Danh sách Manager
+            </a>
+        </c:if>
+    </div>
+</div>
+
+<!-- Lib SockJS + STOMP -->
+<script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
+<script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
+
+<script>
+    // Auto scroll về cuối khi mở trang
+    (function(){ var el = document.getElementById('chatBody'); if(el){ el.scrollTop = el.scrollHeight; } })();
+
+    function trimCheck(){
+        var ta = document.querySelector('textarea[name="message"]'); // <-- FIX selector
+        if(!ta) return true;
+        ta.value = ta.value.trim();
+        return ta.value.length > 0;
+    }
+
+    // ===== Realtime subscribe qua STOMP =====
+    (function(){
+        var meId = ${meId};
+        var receiverId = ${receiverId};
+
+        // cùng quy ước với server: /topic/chat.{minId}.{maxId}
+        var a = Math.min(meId, receiverId);
+        var b = Math.max(meId, receiverId);
+        var topic = "/topic/chat." + a + "." + b;
+
+        var ctx = "${pageContext.request.contextPath}";
+        var sock = new SockJS(ctx + "/ws");
+        var stomp = Stomp.over(sock);
+        stomp.debug = null;
+
+        stomp.connect({}, function(){
+            stomp.subscribe(topic, function(frame){
+                try {
+                    var msg = JSON.parse(frame.body);
+                    appendMessage(msg);
+                } catch(e){
+                    console.error("Parse message error", e);
+                }
+            });
+        });
+
+        function appendMessage(m){
+            var chatBody = document.getElementById('chatBody');
+            if(!chatBody) return;
+
+            var isMe = (m.senderId === meId);
+
+            var row = document.createElement('div');
+            row.className = 'd-flex ' + (isMe ? 'justify-content-end' : 'justify-content-start');
+
+            var msg = document.createElement('div');
+            msg.className = 'msg ' + (isMe ? 'from-me' : 'from-them');
+
+            var content = document.createElement('div');
+            content.textContent = m.message;
+            msg.appendChild(content);
+
+            var meta = document.createElement('div');
+            meta.className = 'msg-time';
+            var dateStr = formatDate(m.sentAt);
+            meta.innerHTML = dateStr + (isMe ? ' • <span>' + (m.read ? 'Đã đọc' : 'Đã gửi') + '</span>' : '');
+            msg.appendChild(meta);
+
+            row.appendChild(msg);
+            chatBody.appendChild(row);
+            chatBody.scrollTop = chatBody.scrollHeight;
+        }
+
+        function formatDate(d){
+            try{
+                var dt = new Date(d);
+                var pad = n => (n<10?'0':'') + n;
+                return pad(dt.getDate()) + "/" + pad(dt.getMonth()+1) + "/" + dt.getFullYear()
+                    + " " + pad(dt.getHours()) + ":" + pad(dt.getMinutes());
+            }catch(e){
+                return '';
+            }
+        }
+    })();
+</script>
+
+<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
+<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
+</body>
+</html>
Index: src/main/java/com/example/config/GoogleCloudConfig.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.config;\r\nimport com.google.auth.oauth2.GoogleCredentials;\r\nimport com.google.cloud.storage.Storage;\r\nimport com.google.cloud.storage.StorageOptions;\r\nimport org.springframework.beans.factory.annotation.Value;\r\nimport org.springframework.context.annotation.Bean;\r\nimport org.springframework.context.annotation.Configuration;\r\n\r\nimport javax.annotation.PostConstruct;\r\nimport java.io.FileInputStream;\r\nimport java.io.IOException;\r\nimport java.util.Arrays;\r\nimport java.util.Collections;\r\n\r\n@Configuration\r\npublic class GoogleCloudConfig {\r\n\r\n    @Value(\"${gcp.credentials.location}\")\r\n    private String credentialsPath;\r\n\r\n    @Bean\r\n    public Storage googleStorage() throws IOException {\r\n        GoogleCredentials credentials = GoogleCredentials\r\n                .fromStream(new FileInputStream(credentialsPath))\r\n                .createScoped(Collections.singletonList(\"https://www.googleapis.com/auth/cloud-platform\"));\r\n\r\n        return StorageOptions.newBuilder().setCredentials(credentials).build().getService();\r\n    }\r\n\r\n    @PostConstruct\r\n    public void init() {\r\n        System.out.println(\">>>>> GCP CREDENTIAL PATH = \" + credentialsPath);\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/config/GoogleCloudConfig.java b/src/main/java/com/example/config/GoogleCloudConfig.java
--- a/src/main/java/com/example/config/GoogleCloudConfig.java	(revision d5967c2b6ed473a29e85a3d5aec3773d786b9f66)
+++ b/src/main/java/com/example/config/GoogleCloudConfig.java	(date 1761372868397)
@@ -1,39 +1,34 @@
-package com.example.config;
-import com.google.auth.oauth2.GoogleCredentials;
-import com.google.cloud.storage.Storage;
-import com.google.cloud.storage.StorageOptions;
-import org.springframework.beans.factory.annotation.Value;
-import org.springframework.context.annotation.Bean;
-import org.springframework.context.annotation.Configuration;
-
-import javax.annotation.PostConstruct;
-import java.io.FileInputStream;
-import java.io.IOException;
-import java.util.Arrays;
-import java.util.Collections;
-
-@Configuration
-public class GoogleCloudConfig {
-
-    @Value("${gcp.credentials.location}")
-    private String credentialsPath;
-
-    @Bean
-    public Storage googleStorage() throws IOException {
-        GoogleCredentials credentials = GoogleCredentials
-                .fromStream(new FileInputStream(credentialsPath))
-                .createScoped(Collections.singletonList("https://www.googleapis.com/auth/cloud-platform"));
-
-        return StorageOptions.newBuilder().setCredentials(credentials).build().getService();
-    }
-
-    @PostConstruct
-    public void init() {
-        System.out.println(">>>>> GCP CREDENTIAL PATH = " + credentialsPath);
-    }
-}
-
-
-
-
-
+//package com.example.config;
+//import com.google.auth.oauth2.GoogleCredentials;
+//import com.google.cloud.storage.Storage;
+//import com.google.cloud.storage.StorageOptions;
+//import org.springframework.beans.factory.annotation.Value;
+//import org.springframework.context.annotation.Bean;
+//import org.springframework.context.annotation.Configuration;
+//
+//import javax.annotation.PostConstruct;
+//import java.io.FileInputStream;
+//import java.io.IOException;
+//import java.util.Arrays;
+//import java.util.Collections;
+//
+//@Configuration
+//public class GoogleCloudConfig {
+//
+//    @Value("${gcp.credentials.location}")
+//    private String credentialsPath;
+//
+//    @Bean
+//    public Storage googleStorage() throws IOException {
+//        GoogleCredentials credentials = GoogleCredentials
+//                .fromStream(new FileInputStream(credentialsPath))
+//                .createScoped(Collections.singletonList("https://www.googleapis.com/auth/cloud-platform"));
+//
+//        return StorageOptions.newBuilder().setCredentials(credentials).build().getService();
+//    }
+//
+//    @PostConstruct
+//    public void init() {
+//        System.out.println(">>>>> GCP CREDENTIAL PATH = " + credentialsPath);
+//    }
+//}
\ No newline at end of file
Index: src/main/webapp/WEB-INF/views/admin/overview.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/WEB-INF/views/admin/overview.jsp b/src/main/webapp/WEB-INF/views/admin/overview.jsp
new file mode 100644
--- /dev/null	(date 1761372868407)
+++ b/src/main/webapp/WEB-INF/views/admin/overview.jsp	(date 1761372868407)
@@ -0,0 +1,404 @@
+<%@ page contentType="text/html;charset=UTF-8" language="java" %>
+<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
+<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %>
+
+<!DOCTYPE html>
+<html>
+<%@include file="../include/head.jsp"%>
+<body class="bg-light">
+<div class="d-flex">
+    <!-- Sidebar -->
+    <%@ include file="/WEB-INF/views/admin/header_admin.jsp" %>
+
+    <!-- Main Content -->
+    <div class="flex-grow-1" style="margin-left: 250px;">
+        <!-- Header -->
+        <div class="bg-white border-bottom px-4 py-3 d-flex justify-content-between align-items-center">
+            <h1 class="h4 mb-0 text-dark">Dashboard Quản lý Thùng Rác</h1>
+            <div class="d-flex align-items-center">
+                <button class="btn btn-outline-secondary position-relative">
+                    🔔
+                    <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
+                        3
+                    </span>
+                </button>
+            </div>
+        </div>
+
+        <div class="p-4">
+            <!-- Stats Cards -->
+            <div class="row g-4 mb-4">
+                <div class="col-md-4">
+                    <div class="card border-0 shadow-sm h-100">
+                        <div class="card-body d-flex align-items-center">
+                            <div class="bg-primary text-white rounded-3 p-3 me-3">
+                                <span class="fs-4">🗑️</span>
+                            </div>
+                            <div>
+                                <h3 class="h4 mb-1">${totalBins}</h3>
+                                <p class="text-muted mb-0">Tổng số thùng</p>
+                            </div>
+                        </div>
+                    </div>
+                </div>
+
+                <div class="col-md-4">
+                    <div class="card border-0 shadow-sm h-100">
+                        <div class="card-body d-flex align-items-center">
+                            <div class="bg-warning text-white rounded-3 p-3 me-3">
+                                <span class="fs-4">⚠️</span>
+                            </div>
+                            <div>
+                                <h3 class="h4 mb-1">${alertCount}</h3>
+                                <p class="text-muted mb-0">Cảnh báo</p>
+                            </div>
+                        </div>
+                    </div>
+                </div>
+
+                <div class="col-md-4">
+                    <div class="card border-0 shadow-sm h-100">
+                        <div class="card-body d-flex align-items-center">
+                            <div class="bg-success text-white rounded-3 p-3 me-3">
+                                <span class="fs-4">📄</span>
+                            </div>
+                            <div>
+                                <h3 class="h4 mb-1">${newReports}</h3>
+                                <p class="text-muted mb-0">Báo cáo mới</p>
+                            </div>
+                        </div>
+                    </div>
+                </div>
+            </div>
+
+            <!-- Main Layout: Filter Left, Map Right -->
+            <div class="row g-4 mb-4">
+                <!-- Filter Panel - Left Side -->
+                <div class="col-md-4">
+                    <div class="card border-0 shadow-sm h-100">
+                        <div class="card-header bg-white border-bottom-0">
+                            <h5 class="mb-0">
+                                <i class="fas fa-filter me-2"></i>Bộ lọc
+                            </h5>
+                        </div>
+                        <div class="card-body">
+                            <div class="mb-3">
+                                <label for="cityFilter" class="form-label fw-semibold">
+                                    <i class="fas fa-city me-1 text-primary"></i>Khu vực:
+                                </label>
+                                <select class="form-select" id="cityFilter">
+                                    <option value="">-- Tất cả --</option>
+                                    <c:forEach var="city" items="${cities}">
+                                        <option value="${city}">${city}</option>
+                                    </c:forEach>
+                                </select>
+                            </div>
+
+                            <div class="mb-3">
+                                <label for="wardFilter" class="form-label fw-semibold">
+                                    <i class="fas fa-map-marker-alt me-1 text-success"></i>Phường/Xã:
+                                </label>
+                                <select class="form-select" id="wardFilter">
+                                    <option value="">-- Tất cả --</option>
+                                    <c:forEach var="ward" items="${wards}">
+                                        <option value="${ward}">${ward}</option>
+                                    </c:forEach>
+                                </select>
+                            </div>
+
+                            <div class="mb-3">
+                                <label for="fillFilter" class="form-label fw-semibold">
+                                    <i class="fas fa-chart-bar me-1 text-warning"></i>Mức đầy:
+                                </label>
+                                <select class="form-select" id="fillFilter">
+                                    <option value="">-- Tất cả --</option>
+                                    <c:forEach var="f" items="${currentFills}">
+                                        <option value="${f}">
+                                            <c:choose>
+                                                <c:when test="${f == 80}">Cảnh báo (>=80%)</c:when>
+                                                <c:when test="${f == 40}">Trung bình (40–79%)</c:when>
+                                                <c:when test="${f == 0}">Bình thường (&lt;40%)</c:when>
+                                            </c:choose>
+                                        </option>
+                                    </c:forEach>
+                                </select>
+                            </div>
+
+
+
+
+                            <div class="mb-3">
+                                <label class="form-label fw-semibold">Hoạt động:</label>
+                                <select class="form-select" id="statusFilter">
+                                    <option value="">-- Tất cả --</option>
+                                    <c:forEach var="s" items="${statuses}">
+                                        <option value="${s}">
+                                            <c:choose>
+                                                <c:when test="${s == 1}">Online</c:when>
+                                                <c:when test="${s == 2}">Offline</c:when>
+                                            </c:choose>
+                                        </option>
+                                    </c:forEach>
+                                </select>
+                            </div>
+
+                            <!-- Results Summary -->
+                            <div class="alert alert-info">
+                                <small>
+                                    <strong id="resultCount">0</strong> thùng rác được tìm thấy
+                                </small>
+                            </div>
+
+                            <!-- Quick Actions -->
+                            <div class="d-grid gap-2">
+                                <button class="btn btn-success btn-sm" onclick="exportReport()">
+                                    📊 Xuất báo cáo
+                                </button>
+                                <button class="btn btn-outline-primary btn-sm" onclick="focusOnResults()">
+                                    📍 Xem trên bản đồ
+                                </button>
+                            </div>
+                        </div>
+                    </div>
+                </div>
+
+                <!-- Map Section - Right Side -->
+                <div class="col-md-8">
+                    <div class="card border-0 shadow-sm h-100">
+                        <div class="card-header bg-white border-bottom d-flex justify-content-between align-items-center">
+                            <h5 class="mb-0">🗺️ Bản đồ thùng rác</h5>
+                            <div class="btn-group btn-group-sm" role="group">
+                                <button type="button" class="btn btn-outline-secondary" onclick="map.zoomIn()">
+                                    ➕
+                                </button>
+                                <button type="button" class="btn btn-outline-secondary" onclick="map.zoomOut()">
+                                    ➖
+                                </button>
+                                <button type="button" class="btn btn-outline-secondary" onclick="resetMapView()">
+                                    🏠
+                                </button>
+                            </div>
+                        </div>
+                        <div class="card-body p-0">
+                            <div id="map" style="height: 500px;" class="rounded-bottom"></div>
+                        </div>
+                    </div>
+                </div>
+            </div>
+
+            <!-- Table Section with Pagination -->
+            <div class="card border-0 shadow-sm">
+                <div class="card-header bg-white border-bottom d-flex justify-content-between align-items-center">
+                    <h5 class="mb-0">📋 Danh sách thùng rác</h5>
+                </div>
+                <div class="card-body p-0">
+                    <div class="table-responsive">
+                        <table class="table table-hover mb-0" id="binTable">
+                            <thead class="table-light">
+                            <tr>
+                                <th class="fw-semibold">Mã</th>
+                                <th class="fw-semibold">Địa chỉ</th>
+                                <th class="fw-semibold">Đầy (%)</th>
+                                <th class="fw-semibold">Mức Chứa</th>
+                                <th class="fw-semibold">Hoạt Động</th>
+                                <th class="fw-semibold">Chi tiết</th>
+                            </tr>
+                            </thead>
+                            <tbody id="binTableBody">
+                            <c:forEach var="bin" items="${bins}">
+                                <tr data-city="${bin.ward.province.provinceName}"
+                                    data-ward="${bin.ward.wardName}"
+                                    data-status="${bin.status}"
+                                    data-fill="${bin.currentFill}">
+                                    <td class="fw-medium">${bin.binCode}</td>
+                                    <td>
+                                            ${bin.street}<c:if test="${not empty bin.ward}">, ${bin.ward.wardName}</c:if><c:if test="${not empty bin.ward and not empty bin.ward.province}">, ${bin.ward.province.provinceName}</c:if>
+                                    </td>
+                                    <td>
+                                        <span class="badge ${bin.currentFill >= 80 ? 'bg-danger' : bin.currentFill >= 40 ? 'bg-warning' : 'bg-success'}">
+                                            ${bin.currentFill}%
+                                        </span>
+                                    </td>
+                                    <td>${bin.capacity}</td>
+                                    <td>
+                                        <c:choose>
+                                            <c:when test="${bin.status == 1}">
+                                                <span class="badge bg-success">Online</span>
+                                            </c:when>
+                                            <c:when test="${bin.status == 2}">
+                                                <span class="badge bg-secondary">Offline</span>
+                                            </c:when>
+                                        </c:choose>
+                                    </td>
+                                    <td>
+                                        <a href="${pageContext.request.contextPath}/manage/bin/${bin.binID}"
+                                           class="btn btn-primary btn-sm">
+                                            Chi tiết
+                                        </a>
+                                    </td>
+                                </tr>
+                            </c:forEach>
+                            </tbody>
+                        </table>
+                    </div>
+
+                    <!-- Pagination -->
+                    <div class="d-flex justify-content-between align-items-center p-3 border-top">
+                        <div class="text-muted">
+                            Hiển thị <span id="showingFrom">1</span> đến <span id="showingTo">25</span>
+                            trong tổng số <span id="totalItems">0</span> mục
+                        </div>
+                        <nav>
+                            <ul class="pagination pagination-sm mb-0" id="pagination">
+                                <!-- Pagination sẽ được tạo bởi JavaScript -->
+                            </ul>
+                        </nav>
+                    </div>
+                </div>
+            </div>
+        </div>
+    </div>
+</div>
+
+<script>
+    // Hàm chọn icon theo mức đầy
+    function getBinIcon(level, status) {
+        if (status == 2) {
+            return "data:image/svg+xml;charset=UTF-8," + encodeURIComponent(`
+                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="gray" viewBox="0 0 24 24">
+                    <path d="M3 6h18v2H3zm2 2h14v14H5z"/>
+                    <rect x="5" y="16" width="14" height="4" fill="rgba(0,0,0,0.3)"/>
+                </svg>
+            `);
+        } else if (level >= 80) {
+            return "data:image/svg+xml;charset=UTF-8," + encodeURIComponent(`
+                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="red" viewBox="0 0 24 24">
+                    <path d="M3 6h18v2H3zm2 2h14v14H5z"/>
+                    <rect x="5" y="8" width="14" height="12" fill="rgba(0,0,0,0.3)"/>
+                </svg>
+            `);
+        } else if (level >= 40) {
+            return "data:image/svg+xml;charset=UTF-8," + encodeURIComponent(`
+                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="orange" viewBox="0 0 24 24">
+                    <path d="M3 6h18v2H3zm2 2h14v14H5z"/>
+                    <rect x="5" y="12" width="14" height="8" fill="rgba(0,0,0,0.3)"/>
+                </svg>
+            `);
+        } else {
+            return "data:image/svg+xml;charset=UTF-8," + encodeURIComponent(`
+                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="green" viewBox="0 0 24 24">
+                    <path d="M3 6h18v2H3zm2 2h14v14H5z"/>
+                    <rect x="5" y="16" width="14" height="4" fill="rgba(0,0,0,0.3)"/>
+                </svg>
+            `);
+        }
+    }
+
+    // Khởi tạo bản đồ VietMap
+    var map = new vietmapgl.Map({
+        container: "map",
+        style: "https://maps.vietmap.vn/maps/styles/tm/style.json?apikey=ecdbd35460b2d399e18592e6264186757aaaddd8755b774c",
+        center: [108.2068, 16.0471],
+        zoom: 12
+    });
+
+    map.addControl(new vietmapgl.NavigationControl());
+
+    var bins = [
+        <c:forEach var="bin" items="${bins}" varStatus="loop">
+        {
+            code: '${bin.binCode}',
+            lat: ${bin.latitude},
+            lng: ${bin.longitude},
+            fullness: ${bin.currentFill != null ? bin.currentFill : 0},
+            address: '${bin.street}, ${bin.ward.wardName}, ${bin.ward.province.provinceName}',
+            updated: '${bin.lastUpdated}',
+            city: '${bin.ward.province.provinceName}',
+            ward: '${bin.ward.wardName}',
+            status: '${bin.status}'
+        }<c:if test="${!loop.last}">,</c:if>
+        </c:forEach>
+    ];
+
+    var markers = [];
+
+    map.on('load', function() {
+        bins.forEach(function(bin) {
+            var el = document.createElement("img");
+            el.src = getBinIcon(bin.fullness, bin.status);
+            el.style.width = "32px";
+            el.style.height = "32px";
+
+            var popup = new vietmapgl.Popup({ offset: 25 }).setHTML(
+                "<b>Mã:</b> " + bin.code +
+                "<br><b>Địa chỉ:</b> " + bin.address +
+                "<br><b>Đầy:</b> " + bin.fullness + "%" +
+                "<br><b>Trạng thái:</b> " + (bin.status == 1 ? "Online" : "Offline") +
+                "<br><b>Cập nhật:</b> " + bin.updated
+            );
+
+            var marker = new vietmapgl.Marker({ element: el })
+                .setLngLat([bin.lng, bin.lat])
+                .setPopup(popup)
+                .addTo(map);
+
+            marker.bin = bin;
+            markers.push(marker);
+        });
+    });
+
+    function applyFilter() {
+        var city = document.getElementById("cityFilter").value;
+        var ward = document.getElementById("wardFilter").value;
+        var status = document.getElementById("statusFilter").value;
+        var fill = document.getElementById("fillFilter").value;
+
+        document.querySelectorAll("#binTable tbody tr").forEach(function(row) {
+            var rowCity = row.getAttribute("data-city");
+            var rowWard = row.getAttribute("data-ward");
+            var rowStatus = row.getAttribute("data-status");
+            var rowFill = parseInt(row.getAttribute("data-fill")) || 0;
+
+            var matchFill = true;
+            if (fill) {
+                if (fill == 80) matchFill = rowFill >= 80;
+                else if (fill == 40) matchFill = rowFill >= 40 && rowFill < 80;
+                else if (fill == 0) matchFill = rowFill < 40;
+            }
+
+            var match = (!city || city === rowCity)
+                && (!ward || ward === rowWard)
+                && (!status || status === rowStatus)
+                && matchFill;
+
+            row.style.display = match ? "" : "none";
+        });
+
+        markers.forEach(function(m) {
+            var matchFill = true;
+            if (fill) {
+                if (fill == 80) matchFill = m.bin.fullness >= 80;
+                else if (fill == 40) matchFill = m.bin.fullness >= 40 && m.bin.fullness < 80;
+                else if (fill == 0) matchFill = m.bin.fullness < 40;
+            }
+
+            var match = (!city || city === m.bin.city)
+                && (!ward || ward === m.bin.ward)
+                && (!status || status == m.bin.status)
+                && matchFill;
+
+            if (match) {
+                if (!m._map) m.addTo(map);
+            } else {
+                if (m._map) m.remove();
+            }
+        });
+    }
+
+    document.getElementById("cityFilter").addEventListener("change", applyFilter);
+    document.getElementById("wardFilter").addEventListener("change", applyFilter);
+    document.getElementById("statusFilter").addEventListener("change", applyFilter);
+    document.getElementById("fillFilter").addEventListener("change", applyFilter);
+</script>
+</body>
+</html>
\ No newline at end of file
Index: src/main/java/com/example/model/ManagerApplication.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/model/ManagerApplication.java b/src/main/java/com/example/model/ManagerApplication.java
new file mode 100644
--- /dev/null	(date 1761372868402)
+++ b/src/main/java/com/example/model/ManagerApplication.java	(date 1761372868402)
@@ -0,0 +1,96 @@
+package com.example.model;
+
+import javax.persistence.*;
+import java.util.Date;
+
+@Entity
+@Table(name = "ManagerApplications")
+public class ManagerApplication {
+
+    @Id
+    @GeneratedValue(strategy = GenerationType.IDENTITY)
+    @Column(name = "ApplicationID")
+    private int applicationId;
+
+    @Column(name = "FullName", nullable = false, length = 100)
+    private String fullName;
+
+    @Column(name = "Email", nullable = false, length = 100)
+    private String email;
+
+    @Column(name = "Phone", length = 20)
+    private String phone;
+
+    @Column(name = "Address", length = 255)
+    private String address;
+
+    @Column(name = "WardID", nullable = false)
+    private int wardID;
+
+    @Column(name = "ContractPath", length = 255)
+    private String contractPath;
+
+    @Column(name = "CMNDPath", length = 255)
+    private String cmndPath;
+
+    @Column(name = "Status")
+    private int status;   // 0=Pending, 2=Approved, 3=Rejected
+
+    @Column(name = "AdminNotes", length = 500)
+    private String adminNotes;
+
+    @Column(name = "RejectionReason", length = 500)
+    private String rejectionReason;
+
+    @Column(name = "AccountID")
+    private Integer accountId;
+
+    @Temporal(TemporalType.TIMESTAMP)
+    @Column(name = "CreatedAt", updatable = false)
+    private Date createdAt;
+
+    @PrePersist
+    protected void onCreate() {
+        this.createdAt = new Date();
+    }
+
+    // ===== Getters/Setters =====
+    public int getApplicationId() { return applicationId; }
+    public void setApplicationId(int applicationId) { this.applicationId = applicationId; }
+
+    public String getFullName() { return fullName; }
+    public void setFullName(String fullName) { this.fullName = fullName; }
+
+    public String getEmail() { return email; }
+    public void setEmail(String email) { this.email = email; }
+
+    public String getPhone() { return phone; }
+    public void setPhone(String phone) { this.phone = phone; }
+
+    public String getAddress() { return address; }
+    public void setAddress(String address) { this.address = address; }
+
+    public int getWardID() { return wardID; }
+    public void setWardID(int wardID) { this.wardID = wardID; }
+
+    public String getContractPath() { return contractPath; }
+    public void setContractPath(String contractPath) { this.contractPath = contractPath; }
+
+    public String getCmndPath() { return cmndPath; }
+    public void setCmndPath(String cmndPath) { this.cmndPath = cmndPath; }
+
+    public int getStatus() { return status; }
+    public void setStatus(int status) { this.status = status; }
+
+    public String getAdminNotes() { return adminNotes; }
+    public void setAdminNotes(String adminNotes) { this.adminNotes = adminNotes; }
+
+    public String getRejectionReason() { return rejectionReason; }
+    public void setRejectionReason(String rejectionReason) { this.rejectionReason = rejectionReason; }
+
+    public Integer getAccountId() { return accountId; }
+    public void setAccountId(Integer accountId) { this.accountId = accountId; }
+
+    public Date getCreatedAt() { return createdAt; }
+    public void setCreatedAt(Date createdAt) { this.createdAt = createdAt; }
+}
Index: .idea/shelf/Uncommitted_changes_before_Update_at_9_25_2025_10_44_PM__Changes_.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/shelf/Uncommitted_changes_before_Update_at_9_25_2025_10_44_PM__Changes_.xml b/.idea/shelf/Uncommitted_changes_before_Update_at_9_25_2025_10_44_PM__Changes_.xml
new file mode 100644
--- /dev/null	(date 1761372878249)
+++ b/.idea/shelf/Uncommitted_changes_before_Update_at_9_25_2025_10_44_PM__Changes_.xml	(date 1761372878249)
@@ -0,0 +1,4 @@
+<changelist name="Uncommitted_changes_before_Update_at_9_25_2025_10_44_PM_[Changes]" date="1758815047005" recycled="false" toDelete="true">
+  <option name="PATH" value="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Update_at_9_25_2025_10_44_PM_[Changes]/shelved.patch" />
+  <option name="DESCRIPTION" value="Uncommitted changes before Update at 9/25/2025 10:44 PM [Changes]" />
+</changelist>
\ No newline at end of file
Index: src/main/java/com/example/model/Chat.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/model/Chat.java b/src/main/java/com/example/model/Chat.java
new file mode 100644
--- /dev/null	(date 1761372868401)
+++ b/src/main/java/com/example/model/Chat.java	(date 1761372868401)
@@ -0,0 +1,88 @@
+package com.example.model;
+
+import javax.persistence.*;
+import java.util.Date;
+
+@Entity
+@Table(name = "Chats")
+public class Chat {
+
+    @Id
+    @GeneratedValue(strategy = GenerationType.IDENTITY)
+    @Column(name = "ChatID")
+    private int chatId;
+
+    @ManyToOne
+    @JoinColumn(name = "SenderID", nullable = false)
+    private Account sender;
+
+    @ManyToOne
+    @JoinColumn(name = "ReceiverID", nullable = false)
+    private Account receiver;
+
+    @Column(name = "Message", length = 1000, nullable = false)
+    private String message;
+
+    @Temporal(TemporalType.TIMESTAMP)
+    @Column(name = "SentAt", nullable = false)
+    private Date sentAt = new Date();
+
+    @Column(name = "IsRead")
+    private boolean isRead = false;
+
+    // ====== Constructors ======
+    public Chat() {}
+
+    public Chat(Account sender, Account receiver, String message) {
+        this.sender = sender;
+        this.receiver = receiver;
+        this.message = message;
+        this.sentAt = new Date();
+        this.isRead = false;
+    }
+
+    // ====== Getters & Setters ======
+    public int getChatId() {
+        return chatId;
+    }
+
+    public Account getSender() {
+        return sender;
+    }
+
+    public void setSender(Account sender) {
+        this.sender = sender;
+    }
+
+    public Account getReceiver() {
+        return receiver;
+    }
+
+    public void setReceiver(Account receiver) {
+        this.receiver = receiver;
+    }
+
+    public String getMessage() {
+        return message;
+    }
+
+    public void setMessage(String message) {
+        this.message = message;
+    }
+
+    public Date getSentAt() {
+        return sentAt;
+    }
+
+    public void setSentAt(Date sentAt) {
+        this.sentAt = sentAt;
+    }
+
+    public boolean isRead() {
+        return isRead;
+    }
+
+    public void setRead(boolean read) {
+        isRead = read;
+    }
+}
Index: src/main/java/com/example/model/AccountConst.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/model/AccountConst.java b/src/main/java/com/example/model/AccountConst.java
new file mode 100644
--- /dev/null	(date 1761372868401)
+++ b/src/main/java/com/example/model/AccountConst.java	(date 1761372868401)
@@ -0,0 +1,21 @@
+package com.example.model;
+
+public final class AccountConst {
+    private AccountConst() {}
+
+    // Role mapping mới
+    public static final class Roles {
+        public static final int ADMIN   = 1;
+        public static final int MANAGER = 2;
+        public static final int WORKER  = 3;
+        public static final int USER    = 4;
+        private Roles() {}
+    }
+
+    // Status
+    public static final class Status {
+        public static final int ACTIVE = 1;
+        public static final int BANNED = 0;
+        private Status() {}
+    }
+}
Index: src/main/java/com/example/service/ManagerApplicationService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/service/ManagerApplicationService.java b/src/main/java/com/example/service/ManagerApplicationService.java
new file mode 100644
--- /dev/null	(date 1761372868403)
+++ b/src/main/java/com/example/service/ManagerApplicationService.java	(date 1761372868403)
@@ -0,0 +1,131 @@
+package com.example.service;
+
+import com.example.model.Account;
+import com.example.model.ManagerApplication;
+import com.example.model.Ward;
+import com.example.repository.AccountRepository;
+import com.example.repository.ManagerApplicationRepository;
+import com.example.repository.WardRepository;
+import org.springframework.beans.factory.annotation.Autowired;
+import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;
+import org.springframework.stereotype.Service;
+import org.springframework.transaction.annotation.Transactional;
+
+@Service
+public class ManagerApplicationService {
+
+    @Autowired
+    private ManagerApplicationRepository appRepo;
+
+    @Autowired
+    private AccountRepository accountRepo;
+
+    @Autowired
+    private WardRepository wardRepo; // giả định bạn đã có repository này
+
+    @Autowired
+    private EmailService emailService;
+
+    @Autowired
+    private RandomService randomService;
+
+    private final BCryptPasswordEncoder passwordEncoder = new BCryptPasswordEncoder();
+
+    /** Người dùng submit đơn (điền form + upload xong, truyền vào các path) */
+    @Transactional
+    public ManagerApplication submitApplication(String fullName, String email, String phone, String address,
+                                                int wardId, String contractPath, String cmndPath) {
+        ManagerApplication app = new ManagerApplication();
+        app.setFullName(fullName);
+        app.setEmail(email);
+        app.setPhone(phone);
+        app.setAddress(address);
+        app.setWardID(wardId);
+        app.setContractPath(contractPath);
+        app.setCmndPath(cmndPath);
+        app.setStatus(0); // Pending
+        return appRepo.save(app);
+    }
+
+    /** Admin REJECT đơn kèm lý do, gửi email báo */
+    @Transactional
+    public ManagerApplication rejectApplication(int applicationId, String reason) {
+        ManagerApplication app = appRepo.findByApplicationId(applicationId);
+        if (app == null) throw new IllegalArgumentException("Application not found: " + applicationId);
+        app.setStatus(3); // Rejected
+        app.setRejectionReason(reason);
+        appRepo.save(app);
+
+        // Gửi email thông báo reject
+        emailService.sendManagerRejectedEmail(app.getEmail(), app.getFullName(), reason);
+        return app;
+    }
+
+    @Transactional
+    public ManagerApplication approveApplication(int applicationId, String adminNotes) {
+        ManagerApplication app = appRepo.findByApplicationId(applicationId);
+        if (app == null) throw new IllegalArgumentException("Application not found: " + applicationId);
+        if (app.getStatus() == 2 && app.getAccountId() != null) {
+            // đã approve trước đó
+            return app;
+        }
+
+        // 1) Login dùng CHÍNH email ứng viên (chuẩn hoá)
+        String loginEmail = app.getEmail().trim().toLowerCase();
+
+        // 2) CHẶN nếu email đã tồn tại trong hệ thống
+        if (accountRepo.existsByEmail(loginEmail)) {
+            throw new IllegalStateException("Email đã tồn tại trong hệ thống, vui lòng dùng email khác.");
+        }
+
+        // 3) Tạo mật khẩu tạm
+        String tempPassword = randomService.generateTempPassword();
+
+        // 4) Tạo account Manager MỚI
+        Account acc = new Account();
+        acc.setEmail(loginEmail);
+        acc.setFullName(app.getFullName());
+        acc.setPassword(passwordEncoder.encode(tempPassword));
+        acc.setRole(2);            // Manager
+        acc.setStatus(1);          // Active
+        acc.setWardID(app.getWardID());
+        acc.setIsVerified(true);   // đúng với field trong Account
+        accountRepo.save(acc);
+
+        // 5) Cập nhật application
+        app.setStatus(2); // Approved
+        app.setAdminNotes(adminNotes);
+        app.setAccountId(acc.getAccountId());
+        appRepo.save(app);
+
+        // 6) Gửi email chào mừng kèm thông tin đăng nhập
+        String wardName = "";
+        Ward ward = wardRepo.findById(app.getWardID()).orElse(null);
+        if (ward != null) wardName = ward.getWardName();
+
+        emailService.sendManagerApprovedEmail(
+                loginEmail,           // gửi tới email cá nhân (cũng là email đăng nhập)
+                app.getFullName(),
+                loginEmail,           // email đăng nhập
+                tempPassword,         // mật khẩu tạm
+                wardName              // tên phường
+        );
+
+        return app;
+    }
+
+    /** Tạo email hệ thống dạng manager.ward{wardId}[.seq]@smartbin.com */
+    private String generateSystemEmailForManager(int wardId) {
+        String domain = "smartbin.com";
+        String baseLocal = "manager.ward" + wardId;
+        String candidate = baseLocal + "@" + domain;
+        int seq = 1;
+
+        while (accountRepo.existsByEmail(candidate)) {
+            candidate = baseLocal + "." + seq + "@" + domain;
+            seq++;
+        }
+        return candidate;
+    }
+
+}
Index: src/main/java/com/example/service/FileStorageService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/service/FileStorageService.java b/src/main/java/com/example/service/FileStorageService.java
new file mode 100644
--- /dev/null	(date 1761372868403)
+++ b/src/main/java/com/example/service/FileStorageService.java	(date 1761372868403)
@@ -0,0 +1,67 @@
+package com.example.service;
+
+import org.springframework.stereotype.Service;
+import org.springframework.web.multipart.MultipartFile;
+
+import java.io.File;
+import java.nio.file.Files;
+import java.nio.file.Paths;
+import java.util.*;
+
+@Service
+public class FileStorageService {
+
+    // Thư mục gốc lưu upload (đổi theo máy bạn)
+    private static final String ROOT_UPLOAD_DIR = "C:/smartbin-uploads"; // Windows ví dụ
+    // Linux: "/var/smartbin/uploads"
+
+    // Cho phép các đuôi file này
+    private static final Set<String> ALLOWED_EXT = new HashSet<>(Arrays.asList(
+            ".pdf", ".jpg", ".jpeg", ".png"
+    ));
+
+    // Giới hạn dung lượng 15MB / file
+    private static final long MAX_FILE_SIZE = 15L * 1024 * 1024; // 15MB
+
+    /**
+     * Lưu file vào thư mục con (vd: "contracts", "idcards") và trả về path lưu trong DB
+     * Ví dụ trả về: /uploads/contracts/xxxx.pdf
+     */
+    public String save(MultipartFile file, String subFolder) {
+        if (file == null || file.isEmpty()) return null;
+
+        // 1) Kiểm tra dung lượng
+        if (file.getSize() > MAX_FILE_SIZE) {
+            throw new IllegalArgumentException("File vượt quá 15MB");
+        }
+
+        // 2) Kiểm tra phần mở rộng
+        String original = file.getOriginalFilename();
+        String ext = (original != null && original.lastIndexOf('.') >= 0)
+                ? original.substring(original.lastIndexOf('.')).toLowerCase()
+                : "";
+        if (!ALLOWED_EXT.contains(ext)) {
+            throw new IllegalArgumentException("Định dạng không hợp lệ (chỉ .pdf, .jpg, .jpeg, .png)");
+        }
+
+        try {
+            // 3) Tạo thư mục đích nếu chưa có
+            String folder = ROOT_UPLOAD_DIR + "/" + (subFolder == null ? "" : subFolder);
+            Files.createDirectories(Paths.get(folder));
+
+            // 4) Tạo tên file ngẫu nhiên, giữ nguyên phần mở rộng
+            String savedName = UUID.randomUUID().toString().replace("-", "") + ext;
+
+            // 5) Lưu file vật lý
+            File dest = new File(folder, savedName);
+            file.transferTo(dest);
+
+            // 6) Trả về đường dẫn lưu trong DB (relative path, sẽ dùng controller để tải)
+            return "/uploads/" + (subFolder == null ? "" : (subFolder + "/")) + savedName;
+
+        } catch (Exception e) {
+            e.printStackTrace();
+            throw new IllegalStateException("Không thể lưu file. Vui lòng thử lại.");
+        }
+    }
+}
Index: src/main/java/com/example/service/ChatService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/service/ChatService.java b/src/main/java/com/example/service/ChatService.java
new file mode 100644
--- /dev/null	(date 1761372868403)
+++ b/src/main/java/com/example/service/ChatService.java	(date 1761372868403)
@@ -0,0 +1,162 @@
+package com.example.service;
+
+import com.example.model.Account;
+import com.example.model.AccountConst;
+import com.example.model.Chat;
+import com.example.repository.AccountRepository;
+import com.example.repository.ChatRepository;
+import org.springframework.stereotype.Service;
+import org.springframework.transaction.annotation.Transactional;
+
+import java.util.*;
+import java.util.stream.Collectors;
+
+@Service
+public class ChatService {
+
+    private final ChatRepository chatRepository;
+    private final AccountRepository accountRepository;
+
+    public ChatService(ChatRepository chatRepository, AccountRepository accountRepository) {
+        this.chatRepository = chatRepository;
+        this.accountRepository = accountRepository;
+    }
+
+    // ===== Helpers =====
+    private Account getAccountOrThrow(int id) {
+        return accountRepository.findById(id)
+                .orElseThrow(() -> new IllegalArgumentException("Không tìm thấy account id=" + id));
+    }
+
+    private void assertAdminManagerPair(Account a, Account b) {
+        int ra = a.getRole();
+        int rb = b.getRole();
+
+        boolean ok = (ra == AccountConst.Roles.ADMIN && rb == AccountConst.Roles.MANAGER)
+                || (ra == AccountConst.Roles.MANAGER && rb == AccountConst.Roles.ADMIN);
+
+        if (!ok) {
+            throw new IllegalArgumentException("Chỉ cho phép chat giữa Admin (role=1) và Manager (role=2).");
+        }
+    }
+
+    // ===== Core APIs =====
+
+    /**
+     * Lấy toàn bộ hội thoại (2 chiều) giữa 2 tài khoản (chỉ cho phép ADMIN <-> MANAGER).
+     * Kết quả được merge và sort theo thời gian tăng dần.
+     */
+    @Transactional(readOnly = true)
+    public List<Chat> getConversation(int accountIdA, int accountIdB) {
+        Account a = getAccountOrThrow(accountIdA);
+        Account b = getAccountOrThrow(accountIdB);
+        assertAdminManagerPair(a, b);
+
+        List<Chat> ab = chatRepository.findBySenderAndReceiverOrderBySentAtAsc(a, b);
+        List<Chat> ba = chatRepository.findBySenderAndReceiverOrderBySentAtAsc(b, a);
+
+        // gộp + sort
+        List<Chat> merged = new ArrayList<>(ab.size() + ba.size());
+        merged.addAll(ab);
+        merged.addAll(ba);
+        merged.sort(Comparator.comparing(Chat::getSentAt));
+        return merged;
+    }
+
+    /**
+     * Gửi tin nhắn (chỉ cho phép ADMIN <-> MANAGER).
+     * Trả về bản ghi Chat đã lưu.
+     */
+    @Transactional
+    public Chat sendMessage(int senderId, int receiverId, String message) {
+        if (message == null || message.trim().length() == 0) {
+            throw new IllegalArgumentException("Nội dung tin nhắn không được trống.");
+        }
+        Account sender = getAccountOrThrow(senderId);
+        Account receiver = getAccountOrThrow(receiverId);
+        assertAdminManagerPair(sender, receiver);
+
+        Chat c = new Chat(sender, receiver, message.trim());
+        return chatRepository.save(c);
+    }
+
+    /**
+     * Đánh dấu đã đọc toàn bộ tin nhắn mà 'viewerId' nhận từ 'otherId'.
+     */
+    @Transactional
+    public int markConversationRead(int viewerId, int otherId) {
+        Account viewer = getAccountOrThrow(viewerId);
+        Account other  = getAccountOrThrow(otherId);
+        assertAdminManagerPair(viewer, other);
+
+        // lấy tất cả tin nhắn other -> viewer chưa đọc
+        List<Chat> unread = chatRepository.findBySenderAndReceiverOrderBySentAtAsc(other, viewer)
+                .stream()
+                .filter(c -> !c.isRead())
+                .collect(Collectors.toList());
+
+        unread.forEach(c -> c.setRead(true));
+        chatRepository.saveAll(unread);
+        return unread.size();
+    }
+
+    /**
+     * Đếm số tin chưa đọc từ 'fromId' gửi tới 'toId'.
+     */
+    @Transactional(readOnly = true)
+    public long countUnreadFromTo(int fromId, int toId) {
+        Account from = getAccountOrThrow(fromId);
+        Account to   = getAccountOrThrow(toId);
+        assertAdminManagerPair(from, to);
+        return chatRepository.countByReceiverAndSenderAndIsReadFalse(to, from);
+    }
+
+    /**
+     * Dùng cho phía Admin: lấy danh sách các Manager có hội thoại với Admin này,
+     * kèm tin nhắn cuối cùng & số chưa đọc. (Dữ liệu thô, Controller sẽ format)
+     */
+    @Transactional(readOnly = true)
+    public List<ManagerChatSummary> listManagersForAdmin(int adminId) {
+        Account admin = getAccountOrThrow(adminId);
+        if (admin.getRole() != AccountConst.Roles.ADMIN) {
+            throw new IllegalArgumentException("Chỉ Admin mới xem danh sách hội thoại với Manager.");
+        }
+
+        // Lấy toàn bộ manager (tuỳ bạn có muốn filter theo ward hay không)
+        // Ở đây lấy tất cả role=MANAGER
+        List<Account> managers = accountRepository.findByRole(AccountConst.Roles.MANAGER, org.springframework.data.domain.PageRequest.of(0, Integer.MAX_VALUE))
+                .getContent();
+
+        List<ManagerChatSummary> result = new ArrayList<>();
+        for (Account m : managers) {
+            // gộp 2 chiều rồi lấy last
+            List<Chat> conv = getConversation(admin.getAccountId(), m.getAccountId());
+            Chat last = conv.isEmpty() ? null : conv.get(conv.size() - 1);
+            long unread = countUnreadFromTo(m.getAccountId(), admin.getAccountId()); // chưa đọc từ manager -> admin
+            result.add(new ManagerChatSummary(m, last, unread));
+        }
+        // Sắp xếp manager theo thời điểm tin nhắn cuối (mới nhất lên đầu)
+        result.sort((x, y) -> {
+            Date dx = x.getLastMessage() != null ? x.getLastMessage().getSentAt() : new Date(0);
+            Date dy = y.getLastMessage() != null ? y.getLastMessage().getSentAt() : new Date(0);
+            return dy.compareTo(dx);
+        });
+        return result;
+    }
+
+    // ===== DTO tóm tắt cho danh sách hội thoại của Admin =====
+    public static class ManagerChatSummary {
+        private final Account manager;
+        private final Chat lastMessage;
+        private final long unreadCount;
+
+        public ManagerChatSummary(Account manager, Chat lastMessage, long unreadCount) {
+            this.manager = manager;
+            this.lastMessage = lastMessage;
+            this.unreadCount = unreadCount;
+        }
+        public Account getManager() { return manager; }
+        public Chat getLastMessage() { return lastMessage; }
+        public long getUnreadCount() { return unreadCount; }
+    }
+}
Index: src/main/java/com/example/service/AdminAccountService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/service/AdminAccountService.java b/src/main/java/com/example/service/AdminAccountService.java
new file mode 100644
--- /dev/null	(date 1761372868402)
+++ b/src/main/java/com/example/service/AdminAccountService.java	(date 1761372868402)
@@ -0,0 +1,115 @@
+package com.example.service;
+
+import com.example.model.Account;
+import com.example.model.AccountConst;
+import com.example.repository.AccountRepository;
+import org.springframework.beans.factory.annotation.Autowired;
+import org.springframework.data.domain.*;
+import org.springframework.stereotype.Service;
+import org.springframework.transaction.annotation.Transactional;
+
+import java.util.*;
+
+@Service
+public class AdminAccountService {
+
+    @Autowired
+    private AccountRepository accountRepository;
+
+    @Autowired
+    private EmailService emailService;
+
+    // ================= LIST =================
+    public Page<Account> listManagers(Integer status, String keyword, int page, int size, Sort sort) {
+        return listByRole(AccountConst.Roles.MANAGER, status, keyword, page, size, sort);
+    }
+
+    public Page<Account> listWorkers(Integer status, String keyword, int page, int size, Sort sort) {
+        return listByRole(AccountConst.Roles.WORKER, status, keyword, page, size, sort);
+    }
+
+    public Page<Account> listUsers(Integer status, String keyword, int page, int size, Sort sort) {
+        return listByRole(AccountConst.Roles.USER, status, keyword, page, size, sort);
+    }
+
+    private Page<Account> listByRole(int role, Integer status, String keyword, int page, int size, Sort sort) {
+        Pageable pageable = PageRequest.of(Math.max(page,0), Math.max(size,1),
+                sort == null ? Sort.by("createdAt").descending() : sort);
+
+        String kw = (keyword!=null && !keyword.trim().isEmpty()) ? keyword.trim() : null;
+
+        if (status == null && kw == null) {
+            return accountRepository.findByRole(role, pageable);
+        }
+
+        if (status != null && kw == null) {
+            return accountRepository.findByRoleAndStatus(role, status, pageable);
+        }
+
+        if (status == null) {
+            Page<Account> p1 = accountRepository.findByRoleAndEmailContainingIgnoreCase(role, kw, pageable);
+            Page<Account> p2 = accountRepository.findByRoleAndFullNameContainingIgnoreCase(role, kw, pageable);
+            return mergePages(p1, p2, pageable);
+        }
+
+        Page<Account> p1 = accountRepository.findByRoleAndStatusAndEmailContainingIgnoreCase(role, status, kw, pageable);
+        Page<Account> p2 = accountRepository.findByRoleAndStatusAndFullNameContainingIgnoreCase(role, status, kw, pageable);
+        return mergePages(p1, p2, pageable);
+    }
+
+    private Page<Account> mergePages(Page<Account> p1, Page<Account> p2, Pageable pageable) {
+        Set<Integer> seen = new HashSet<>();
+        List<Account> combined = new ArrayList<>();
+
+        for (Account a : p1.getContent()) {
+            if (seen.add(a.getAccountId())) combined.add(a);
+        }
+        for (Account a : p2.getContent()) {
+            if (seen.add(a.getAccountId())) combined.add(a);
+        }
+
+        return new PageImpl<>(combined, pageable, combined.size());
+    }
+
+    // ================= BAN / UNBAN =================
+    @Transactional
+    public void banAccount(int accountId, String reason, int adminId) {
+        if (accountId == adminId) {
+            throw new IllegalArgumentException("Không thể tự khóa chính mình.");
+        }
+        if (reason == null || reason.trim().length() < 3) {
+            throw new IllegalArgumentException("Lý do phải >= 3 ký tự.");
+        }
+
+        Account acc = accountRepository.findById(accountId)
+                .orElseThrow(() -> new IllegalArgumentException("Không tìm thấy account id=" + accountId));
+
+        if (acc.getStatus() == AccountConst.Status.BANNED) return;
+
+        acc.setStatus(AccountConst.Status.BANNED);
+        accountRepository.save(acc);
+
+        try {
+            emailService.sendAccountBannedEmail(acc.getEmail(), acc.getFullName(), reason);
+        } catch (Exception e) {
+            System.err.println("❌ Lỗi gửi mail ban: " + e.getMessage());
+        }
+    }
+
+    @Transactional
+    public void unbanAccount(int accountId, int adminId) {
+        Account acc = accountRepository.findById(accountId)
+                .orElseThrow(() -> new IllegalArgumentException("Không tìm thấy account id=" + accountId));
+
+        if (acc.getStatus() == AccountConst.Status.ACTIVE) return;
+
+        acc.setStatus(AccountConst.Status.ACTIVE);
+        accountRepository.save(acc);
+
+        try {
+            emailService.sendAccountReactivatedEmail(acc.getEmail(), acc.getFullName());
+        } catch (Exception e) {
+            System.err.println("❌ Lỗi gửi mail unban: " + e.getMessage());
+        }
+    }
+}
Index: src/main/java/com/example/controller/FileDownloadController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/controller/FileDownloadController.java b/src/main/java/com/example/controller/FileDownloadController.java
new file mode 100644
--- /dev/null	(date 1761372868399)
+++ b/src/main/java/com/example/controller/FileDownloadController.java	(date 1761372868399)
@@ -0,0 +1,37 @@
+package com.example.controller;
+
+import org.springframework.core.io.FileSystemResource;
+import org.springframework.core.io.Resource;
+import org.springframework.http.HttpHeaders;
+import org.springframework.http.ResponseEntity;
+import org.springframework.stereotype.Controller;
+import org.springframework.web.bind.annotation.*;
+
+import java.io.File;
+
+@Controller
+@RequestMapping("/uploads")
+public class FileDownloadController {
+
+    // Cùng path với FileStorageService
+    private static final String ROOT_UPLOAD_DIR = "C:/smartbin-uploads";
+
+    @GetMapping("/{subFolder}/{fileName:.+}")
+    @ResponseBody
+    public ResponseEntity<Resource> downloadFile(
+            @PathVariable String subFolder,
+            @PathVariable String fileName
+    ) {
+        File file = new File(ROOT_UPLOAD_DIR + "/" + subFolder + "/" + fileName);
+        if (!file.exists()) {
+            return ResponseEntity.notFound().build();
+        }
+
+        Resource resource = new FileSystemResource(file);
+
+        return ResponseEntity.ok()
+                .header(HttpHeaders.CONTENT_DISPOSITION,
+                        "attachment; filename=\"" + fileName + "\"")
+                .body(resource);
+    }
+}
Index: src/main/java/com/example/controller/ChatController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/controller/ChatController.java b/src/main/java/com/example/controller/ChatController.java
new file mode 100644
--- /dev/null	(date 1761372868399)
+++ b/src/main/java/com/example/controller/ChatController.java	(date 1761372868399)
@@ -0,0 +1,112 @@
+package com.example.controller;
+
+import com.example.model.Account;
+import com.example.model.AccountConst;
+import com.example.model.Chat;
+import com.example.service.ChatService;
+import org.springframework.beans.factory.annotation.Autowired;
+import org.springframework.messaging.simp.SimpMessagingTemplate;   // <-- phát socket
+import org.springframework.stereotype.Controller;
+import org.springframework.ui.Model;
+import org.springframework.web.bind.annotation.*;
+
+import javax.servlet.http.HttpSession;
+import java.util.HashMap;
+import java.util.List;
+import java.util.Map;
+
+@Controller
+@RequestMapping("/chat")
+public class ChatController {
+
+    @Autowired
+    private ChatService chatService;
+
+    @Autowired
+    private SimpMessagingTemplate messagingTemplate;  // để publish ra /topic/...
+
+    // ========== 1️⃣ Màn hình cho Admin: chọn Manager để chat ==========
+    @GetMapping("/admin")
+    public String adminChatList(HttpSession session, Model model) {
+        Account current = (Account) session.getAttribute("currentUser");
+        if (current == null || current.getRole() != AccountConst.Roles.ADMIN) {
+            return "redirect:/login";
+        }
+        model.addAttribute("managerChats", chatService.listManagersForAdmin(current.getAccountId()));
+        return "admin/admin_chat_list"; // JSP: danh sách managers
+    }
+
+    // ========== 2️⃣ Mở khung chat giữa Admin và 1 Manager ==========
+    @GetMapping("/admin/{managerId}")
+    public String adminChatRoom(@PathVariable int managerId, HttpSession session, Model model) {
+        Account current = (Account) session.getAttribute("currentUser");
+        if (current == null || current.getRole() != AccountConst.Roles.ADMIN) {
+            return "redirect:/login";
+        }
+
+        List<Chat> conversation = chatService.getConversation(current.getAccountId(), managerId);
+        chatService.markConversationRead(current.getAccountId(), managerId);
+
+        model.addAttribute("conversation", conversation);
+        model.addAttribute("receiverId", managerId);
+        return "admin/chat_room"; // JSP: khung chat chung
+    }
+
+    // ========== 3️⃣ Manager chat với Admin ==========
+    @GetMapping("/manager")
+    public String managerChat(HttpSession session, Model model) {
+        Account current = (Account) session.getAttribute("currentUser");
+        if (current == null || current.getRole() != AccountConst.Roles.MANAGER) {
+            return "redirect:/login";
+        }
+
+        int adminId = 1; // TODO: nếu nhiều admin, query admin phù hợp
+        List<Chat> conversation = chatService.getConversation(current.getAccountId(), adminId);
+        chatService.markConversationRead(current.getAccountId(), adminId);
+
+        model.addAttribute("conversation", conversation);
+        model.addAttribute("receiverId", adminId);
+        return "admin/chat_room";
+    }
+
+    // ========== 4️⃣ Gửi tin nhắn (lưu DB + broadcast realtime) ==========
+    @PostMapping("/send")
+    public String sendMessage(
+            @RequestParam int receiverId,
+            @RequestParam String message,
+            HttpSession session
+    ) {
+        Account current = (Account) session.getAttribute("currentUser");
+        if (current == null) return "redirect:/login";
+
+        // 1) Lưu DB
+        Chat saved = chatService.sendMessage(current.getAccountId(), receiverId, message);
+
+        // 2) Broadcast realtime tới topic hội thoại chung
+        String topic = toTopic(current.getAccountId(), receiverId);
+
+        Map<String, Object> payload = new HashMap<>();
+        payload.put("chatId", saved.getChatId());
+        payload.put("senderId", saved.getSender().getAccountId());
+        payload.put("receiverId", saved.getReceiver().getAccountId());
+        payload.put("message", saved.getMessage());
+        payload.put("sentAt", saved.getSentAt());
+        payload.put("read", saved.isRead());
+
+        messagingTemplate.convertAndSend(topic, payload);
+
+        // 3) Quay lại đúng phòng chat
+        if (current.getRole() == AccountConst.Roles.ADMIN) {
+            return "redirect:/chat/admin/" + receiverId;
+        } else {
+            return "redirect:/chat/manager";
+        }
+    }
+
+    // ===== Helper: sinh topic chung cho 2 user (thứ tự không quan trọng) =====
+    private String toTopic(int aId, int bId) {
+        int min = Math.min(aId, bId);
+        int max = Math.max(aId, bId);
+        return "/topic/chat." + min + "." + max;
+    }
+}
Index: src/main/java/com/example/controller/AdminFileController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/controller/AdminFileController.java b/src/main/java/com/example/controller/AdminFileController.java
new file mode 100644
--- /dev/null	(date 1761372868399)
+++ b/src/main/java/com/example/controller/AdminFileController.java	(date 1761372868399)
@@ -0,0 +1,59 @@
+package com.example.controller;
+
+import org.springframework.core.io.FileSystemResource;
+import org.springframework.core.io.Resource;
+import org.springframework.http.HttpHeaders;
+import org.springframework.http.MediaType;
+import org.springframework.http.ResponseEntity;
+import org.springframework.stereotype.Controller;
+import org.springframework.util.StringUtils;
+import org.springframework.web.bind.annotation.GetMapping;
+import org.springframework.web.bind.annotation.RequestMapping;
+import org.springframework.web.bind.annotation.RequestParam;
+
+import java.io.File;
+import java.io.UnsupportedEncodingException;
+import java.net.URLEncoder;
+import java.nio.file.Path;
+import java.nio.file.Paths;
+
+@Controller
+@RequestMapping("/admin/uploads")
+public class AdminFileController {
+
+    private static final String ROOT_UPLOAD_DIR = "C:/smartbin-uploads";
+
+    @GetMapping("/download")
+    public ResponseEntity<Resource> download(@RequestParam("path") String path) {
+        if (!StringUtils.hasText(path)) return ResponseEntity.badRequest().build();
+
+        String clean = path.replace("\\", "/");
+        if (!clean.startsWith("/uploads/")) return ResponseEntity.badRequest().build();
+
+        String relative = clean.replaceFirst("^/uploads/", "");
+        Path filePath = Paths.get(ROOT_UPLOAD_DIR, relative).normalize();
+        File file = filePath.toFile();
+        if (!file.exists() || !file.isFile()) return ResponseEntity.notFound().build();
+
+        String filename = file.getName();
+
+        // encode tên file về RFC5987 (filename*)
+        String encoded;
+        try {
+            encoded = URLEncoder.encode(filename, "UTF-8").replace("+", "%20");
+        } catch (UnsupportedEncodingException e) {
+            // Java 8 luôn có UTF-8, nhưng fallback để tránh compile error
+            encoded = filename;
+        }
+
+        Resource resource = new FileSystemResource(file);
+
+        MediaType type = MediaType.APPLICATION_OCTET_STREAM;
+        if (filename.toLowerCase().endsWith(".pdf")) type = MediaType.APPLICATION_PDF;
+
+        return ResponseEntity.ok()
+                .contentType(type)
+                .header(HttpHeaders.CONTENT_DISPOSITION, "attachment; filename*=UTF-8''" + encoded)
+                .body(resource);
+    }
+}
Index: src/main/webapp/WEB-INF/applicationContext.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><beans xmlns=\"http://www.springframework.org/schema/beans\"\r\n       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n       xmlns:context=\"http://www.springframework.org/schema/context\"\r\n       xmlns:tx=\"http://www.springframework.org/schema/tx\"\r\n       xmlns:jpa=\"http://www.springframework.org/schema/data/jpa\"\r\n       xsi:schemaLocation=\"\r\n           http://www.springframework.org/schema/beans\r\n           http://www.springframework.org/schema/beans/spring-beans.xsd\r\n           http://www.springframework.org/schema/context\r\n           http://www.springframework.org/schema/context/spring-context.xsd\r\n           http://www.springframework.org/schema/tx\r\n           http://www.springframework.org/schema/tx/spring-tx.xsd\r\n           http://www.springframework.org/schema/data/jpa\r\n           http://www.springframework.org/schema/data/jpa/spring-jpa.xsd\">\r\n\r\n    <!-- Quét Service, Repository -->\r\n    <context:component-scan base-package=\"com.example.service, com.example.repository\" />\r\n\r\n    <!-- Enable Repository JPA -->\r\n    <jpa:repositories base-package=\"com.example.repository\"\r\n                      entity-manager-factory-ref=\"entityManagerFactory\"\r\n                      transaction-manager-ref=\"transactionManager\"/>\r\n\r\n    <!-- DataSource -->\r\n<!--    <bean id=\"dataSource\" class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\">-->\r\n<!--        <property name=\"driverClassName\" value=\"com.microsoft.sqlserver.jdbc.SQLServerDriver\" />-->\r\n<!--        <property name=\"url\" value=\"jdbc:sqlserver://34.16.112.143:1433;databaseName=SmartBin;encrypt=false;characterEncoding=UTF-8;\" />-->\r\n<!--        <property name=\"username\" value=\"sqlserver\" />-->\r\n<!--        <property name=\"password\" value=\"030303\" />-->\r\n<!--    </bean>-->\r\n\r\n    <bean id=\"dataSource\" class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\">\r\n        <property name=\"driverClassName\" value=\"com.microsoft.sqlserver.jdbc.SQLServerDriver\" />\r\n        <property name=\"url\" value=\"jdbc:sqlserver://localhost:1433;databaseName=SmartBinManagement;encrypt=false;characterEncoding=UTF-8;\" />\r\n        <property name=\"username\" value=\"sa\" />\r\n        <property name=\"password\" value=\"030303\" />\r\n    </bean>\r\n    <!-- EntityManager -->\r\n    <bean id=\"entityManagerFactory\" class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\">\r\n        <property name=\"dataSource\" ref=\"dataSource\" />\r\n        <property name=\"packagesToScan\" value=\"com.example.model\" />\r\n        <property name=\"jpaVendorAdapter\">\r\n            <bean class=\"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter\">\r\n                <property name=\"database\" value=\"SQL_SERVER\" />\r\n                <property name=\"showSql\" value=\"true\" />\r\n            </bean>\r\n        </property>\r\n        <property name=\"jpaProperties\">\r\n            <props>\r\n                <prop key=\"hibernate.dialect\">org.hibernate.dialect.SQLServer2012Dialect</prop>\r\n                <prop key=\"hibernate.hbm2ddl.auto\">update</prop>\r\n            </props>\r\n        </property>\r\n    </bean>\r\n\r\n    <!-- Transaction -->\r\n    <bean id=\"transactionManager\" class=\"org.springframework.orm.jpa.JpaTransactionManager\">\r\n        <property name=\"entityManagerFactory\" ref=\"entityManagerFactory\"/>\r\n    </bean>\r\n    <tx:annotation-driven transaction-manager=\"transactionManager\"/>\r\n\r\n    <!-- Mail -->\r\n    <bean id=\"mailSender\" class=\"org.springframework.mail.javamail.JavaMailSenderImpl\">\r\n        <property name=\"host\" value=\"smtp.gmail.com\" />\r\n        <property name=\"port\" value=\"587\" />\r\n        <property name=\"username\" value=\"phuongnam121103@gmail.com\" />\r\n        <property name=\"password\" value=\"eqna xeml exop mnzc\" />\r\n        <property name=\"javaMailProperties\">\r\n            <props>\r\n                <prop key=\"mail.smtp.auth\">true</prop>\r\n                <prop key=\"mail.smtp.starttls.enable\">true</prop>\r\n            </props>\r\n        </property>\r\n    </bean>\r\n</beans>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/WEB-INF/applicationContext.xml b/src/main/webapp/WEB-INF/applicationContext.xml
--- a/src/main/webapp/WEB-INF/applicationContext.xml	(revision d5967c2b6ed473a29e85a3d5aec3773d786b9f66)
+++ b/src/main/webapp/WEB-INF/applicationContext.xml	(date 1761372868404)
@@ -31,9 +31,9 @@
 
     <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
         <property name="driverClassName" value="com.microsoft.sqlserver.jdbc.SQLServerDriver" />
-        <property name="url" value="jdbc:sqlserver://localhost:1433;databaseName=SmartBinManagement;encrypt=false;characterEncoding=UTF-8;" />
+        <property name="url" value="jdbc:sqlserver://localhost:1433;databaseName=SmartBin;encrypt=false;characterEncoding=UTF-8;" />
         <property name="username" value="sa" />
-        <property name="password" value="030303" />
+        <property name="password" value="123" />
     </bean>
     <!-- EntityManager -->
     <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
Index: src/main/java/com/example/controller/AdminApplicationController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/controller/AdminApplicationController.java b/src/main/java/com/example/controller/AdminApplicationController.java
new file mode 100644
--- /dev/null	(date 1761372868398)
+++ b/src/main/java/com/example/controller/AdminApplicationController.java	(date 1761372868398)
@@ -0,0 +1,82 @@
+package com.example.controller;
+
+import com.example.model.ManagerApplication;
+import com.example.repository.ManagerApplicationRepository;
+import com.example.repository.WardRepository;
+import com.example.service.ManagerApplicationService;
+import org.springframework.beans.factory.annotation.Autowired;
+import org.springframework.stereotype.Controller;
+import org.springframework.ui.Model;
+import org.springframework.util.StringUtils;
+import org.springframework.web.bind.annotation.*;
+
+@Controller
+@RequestMapping("/admin/applications")
+public class AdminApplicationController {
+
+    @Autowired
+    private ManagerApplicationRepository appRepo;
+
+    @Autowired
+    private WardRepository wardRepository;
+
+    @Autowired
+    private ManagerApplicationService appService;
+
+    // Danh sách
+    @GetMapping
+    public String list(Model model) {
+        model.addAttribute("pending",  appRepo.findByStatus(0));
+        model.addAttribute("approved", appRepo.findByStatus(2));
+        model.addAttribute("rejected", appRepo.findByStatus(3));
+        return "admin/applications"; // /WEB-INF/views/admin-applications.jsp
+    }
+
+    // Chi tiết
+    @GetMapping("/{id}")
+    public String detail(@PathVariable("id") int id, Model model) {
+        ManagerApplication app = appRepo.findByApplicationId(id);
+        if (app == null) {
+            model.addAttribute("error", "Không tìm thấy đơn đăng ký #" + id);
+            return "admin/applications";
+        }
+        model.addAttribute("app", app);
+        model.addAttribute("ward",
+                wardRepository.findByWardId(app.getWardID()));
+
+
+        return "admin/application-detail"; // /WEB-INF/views/admin-application-detail.jsp
+    }
+
+    // Approve
+    @PostMapping("/{id}/approve")
+    public String approve(@PathVariable("id") int id,
+                          @RequestParam(required = false) String adminNotes,
+                          Model model) {
+        try {
+            appService.approveApplication(id, adminNotes);
+            return "redirect:/admin/applications/" + id + "?approved=1";
+        } catch (Exception e) {
+            model.addAttribute("error", e.getMessage());
+            return detail(id, model);
+        }
+    }
+
+    // Reject
+    @PostMapping("/{id}/reject")
+    public String reject(@PathVariable("id") int id,
+                         @RequestParam String reason,
+                         Model model) {
+        if (!StringUtils.hasText(reason)) {
+            model.addAttribute("error", "Vui lòng nhập lý do từ chối.");
+            return detail(id, model);
+        }
+        try {
+            appService.rejectApplication(id, reason);
+            return "redirect:/admin/applications/" + id + "?rejected=1";
+        } catch (Exception e) {
+            model.addAttribute("error", e.getMessage());
+            return detail(id, model);
+        }
+    }
+}
Index: src/main/java/com/example/controller/AdminAccountController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/controller/AdminAccountController.java b/src/main/java/com/example/controller/AdminAccountController.java
new file mode 100644
--- /dev/null	(date 1761372868398)
+++ b/src/main/java/com/example/controller/AdminAccountController.java	(date 1761372868398)
@@ -0,0 +1,202 @@
+package com.example.controller;
+
+import com.example.model.Account;
+import com.example.model.AccountConst;
+import com.example.service.AdminAccountService;
+import org.springframework.beans.factory.annotation.Autowired;
+import org.springframework.data.domain.Page;
+import org.springframework.data.domain.Sort;
+import org.springframework.stereotype.Controller;
+import org.springframework.ui.Model;
+import org.springframework.web.bind.annotation.*;
+import org.springframework.web.servlet.mvc.support.RedirectAttributes;
+
+import javax.servlet.http.HttpSession;
+
+@Controller
+@RequestMapping("/admin/accounts")
+public class AdminAccountController {
+
+    @Autowired
+    private AdminAccountService adminAccountService;
+
+    // ========================== 1 trang – 3 khung ==========================
+    @GetMapping({"", "/"})
+    public String all(
+            @RequestParam(value = "status", required = false) Integer status,
+            @RequestParam(value = "q", required = false) String q,
+            @RequestParam(value = "pageM", defaultValue = "0") int pageM, // page cho Managers
+            @RequestParam(value = "pageW", defaultValue = "0") int pageW, // page cho Workers
+            @RequestParam(value = "pageU", defaultValue = "0") int pageU, // page cho Users
+            @RequestParam(value = "size", defaultValue = "10") int size,
+            Model model
+    ) {
+        Sort sort = Sort.by("createdAt").descending();
+
+        Page<Account> managers = adminAccountService.listManagers(status, q, pageM, size, sort);
+        Page<Account> workers  = adminAccountService.listWorkers(status,  q, pageW, size, sort);
+        Page<Account> users    = adminAccountService.listUsers(status,    q, pageU, size, sort);
+
+        model.addAttribute("status", status);
+        model.addAttribute("q", q);
+        model.addAttribute("managers", managers);
+        model.addAttribute("workers", workers);
+        model.addAttribute("users", users);
+        model.addAttribute("AccountConst", AccountConst.class); // để JSP gọi T(...)
+
+        return "admin/accounts"; // JSP hợp nhất (bước kế)
+    }
+
+    // ========================== Ban / Unban (Managers) ==========================
+    @PostMapping("/managers/{id}/ban")
+    public String banManager(@PathVariable("id") int id,
+                             @RequestParam("reason") String reason,
+                             HttpSession session,
+                             RedirectAttributes ra,
+                             @RequestParam(value = "status", required = false) Integer status,
+                             @RequestParam(value = "q", required = false) String q,
+                             @RequestParam(value = "pageM", defaultValue = "0") int pageM,
+                             @RequestParam(value = "pageW", defaultValue = "0") int pageW,
+                             @RequestParam(value = "pageU", defaultValue = "0") int pageU) {
+        int adminId = currentAdminId(session);
+        try {
+            adminAccountService.banAccount(id, reason, adminId);
+            ra.addFlashAttribute("success", "Đã khóa tài khoản #" + id);
+        } catch (Exception e) {
+            ra.addFlashAttribute("error", e.getMessage());
+        }
+        return redirectAll(status, q, pageM, pageW, pageU, "#managers");
+    }
+
+    @PostMapping("/managers/{id}/unban")
+    public String unbanManager(@PathVariable("id") int id,
+                               HttpSession session,
+                               RedirectAttributes ra,
+                               @RequestParam(value = "status", required = false) Integer status,
+                               @RequestParam(value = "q", required = false) String q,
+                               @RequestParam(value = "pageM", defaultValue = "0") int pageM,
+                               @RequestParam(value = "pageW", defaultValue = "0") int pageW,
+                               @RequestParam(value = "pageU", defaultValue = "0") int pageU) {
+        int adminId = currentAdminId(session);
+        try {
+            adminAccountService.unbanAccount(id, adminId);
+            ra.addFlashAttribute("success", "Đã mở khóa tài khoản #" + id);
+        } catch (Exception e) {
+            ra.addFlashAttribute("error", e.getMessage());
+        }
+        return redirectAll(status, q, pageM, pageW, pageU, "#managers");
+    }
+
+    // ========================== Ban / Unban (Workers) ==========================
+    @PostMapping("/workers/{id}/ban")
+    public String banWorker(@PathVariable("id") int id,
+                            @RequestParam("reason") String reason,
+                            HttpSession session,
+                            RedirectAttributes ra,
+                            @RequestParam(value = "status", required = false) Integer status,
+                            @RequestParam(value = "q", required = false) String q,
+                            @RequestParam(value = "pageM", defaultValue = "0") int pageM,
+                            @RequestParam(value = "pageW", defaultValue = "0") int pageW,
+                            @RequestParam(value = "pageU", defaultValue = "0") int pageU) {
+        int adminId = currentAdminId(session);
+        try {
+            adminAccountService.banAccount(id, reason, adminId);
+            ra.addFlashAttribute("success", "Đã khóa tài khoản #" + id);
+        } catch (Exception e) {
+            ra.addFlashAttribute("error", e.getMessage());
+        }
+        return redirectAll(status, q, pageM, pageW, pageU, "#workers");
+    }
+
+    @PostMapping("/workers/{id}/unban")
+    public String unbanWorker(@PathVariable("id") int id,
+                              HttpSession session,
+                              RedirectAttributes ra,
+                              @RequestParam(value = "status", required = false) Integer status,
+                              @RequestParam(value = "q", required = false) String q,
+                              @RequestParam(value = "pageM", defaultValue = "0") int pageM,
+                              @RequestParam(value = "pageW", defaultValue = "0") int pageW,
+                              @RequestParam(value = "pageU", defaultValue = "0") int pageU) {
+        int adminId = currentAdminId(session);
+        try {
+            adminAccountService.unbanAccount(id, adminId);
+            ra.addFlashAttribute("success", "Đã mở khóa tài khoản #" + id);
+        } catch (Exception e) {
+            ra.addFlashAttribute("error", e.getMessage());
+        }
+        return redirectAll(status, q, pageM, pageW, pageU, "#workers");
+    }
+
+    // ========================== Ban / Unban (Users) ==========================
+    @PostMapping("/users/{id}/ban")
+    public String banUser(@PathVariable("id") int id,
+                          @RequestParam("reason") String reason,
+                          HttpSession session,
+                          RedirectAttributes ra,
+                          @RequestParam(value = "status", required = false) Integer status,
+                          @RequestParam(value = "q", required = false) String q,
+                          @RequestParam(value = "pageM", defaultValue = "0") int pageM,
+                          @RequestParam(value = "pageW", defaultValue = "0") int pageW,
+                          @RequestParam(value = "pageU", defaultValue = "0") int pageU) {
+        int adminId = currentAdminId(session);
+        try {
+            adminAccountService.banAccount(id, reason, adminId);
+            ra.addFlashAttribute("success", "Đã khóa tài khoản #" + id);
+        } catch (Exception e) {
+            ra.addFlashAttribute("error", e.getMessage());
+        }
+        return redirectAll(status, q, pageM, pageW, pageU, "#users");
+    }
+
+    @PostMapping("/users/{id}/unban")
+    public String unbanUser(@PathVariable("id") int id,
+                            HttpSession session,
+                            RedirectAttributes ra,
+                            @RequestParam(value = "status", required = false) Integer status,
+                            @RequestParam(value = "q", required = false) String q,
+                            @RequestParam(value = "pageM", defaultValue = "0") int pageM,
+                            @RequestParam(value = "pageW", defaultValue = "0") int pageW,
+                            @RequestParam(value = "pageU", defaultValue = "0") int pageU) {
+        int adminId = currentAdminId(session);
+        try {
+            adminAccountService.unbanAccount(id, adminId);
+            ra.addFlashAttribute("success", "Đã mở khóa tài khoản #" + id);
+        } catch (Exception e) {
+            ra.addFlashAttribute("error", e.getMessage());
+        }
+        return redirectAll(status, q, pageM, pageW, pageU, "#users");
+    }
+
+    // ========================== Helpers ==========================
+    private String redirectAll(Integer status, String q, int pageM, int pageW, int pageU, String anchor) {
+        String ctx = "/admin/accounts";
+        StringBuilder sb = new StringBuilder("redirect:").append(ctx).append("?");
+        boolean first = true;
+        if (status != null) { sb.append("status=").append(status); first = false; }
+        if (q != null && !q.trim().isEmpty()) { sb.append(first?"":"&").append("q=").append(url(q)); first=false; }
+        if (pageM > 0) { sb.append(first?"":"&").append("pageM=").append(pageM); first=false; }
+        if (pageW > 0) { sb.append(first?"":"&").append("pageW=").append(pageW); first=false; }
+        if (pageU > 0) { sb.append(first?"":"&").append("pageU=").append(pageU); }
+        if (anchor != null) sb.append(anchor);
+        return sb.toString();
+    }
+
+    private String url(String s) {
+        try { return java.net.URLEncoder.encode(s, "UTF-8"); }
+        catch (Exception e) { return s; }
+    }
+
+    /**z
+     * Lấy adminId đang đăng nhập.
+     * Tùy dự án, bạn thay cho đúng (Spring Security hoặc session).
+     */
+    private int currentAdminId(HttpSession session) {
+        Object id = session.getAttribute("currentAccountId"); // đổi theo app của bạn
+        if (id instanceof Integer) return (Integer) id;
+
+        Object acc = session.getAttribute("account");
+        if (acc instanceof Account) return ((Account) acc).getAccountId();
+
+        throw new IllegalStateException("Không xác định admin đang đăng nhập.");
+    }
+}
Index: src/main/java/com/example/controller/AdminBinController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/controller/AdminBinController.java b/src/main/java/com/example/controller/AdminBinController.java
new file mode 100644
--- /dev/null	(date 1761372868398)
+++ b/src/main/java/com/example/controller/AdminBinController.java	(date 1761372868398)
@@ -0,0 +1,101 @@
+package com.example.controller;
+
+import com.example.model.Bin;
+import com.example.repository.WardRepository;
+import com.example.service.BinService;
+import org.springframework.stereotype.Controller;
+import org.springframework.ui.Model;
+import org.springframework.web.bind.annotation.*;
+import org.springframework.web.servlet.mvc.support.RedirectAttributes;
+
+@Controller
+@RequestMapping("/admin/bins")
+public class AdminBinController {
+
+    private final BinService binService;
+    private final WardRepository wardRepository;
+
+    public AdminBinController(BinService binService, WardRepository wardRepository) {
+        this.binService = binService;
+        this.wardRepository = wardRepository;
+    }
+
+    // Trang danh sách
+    @GetMapping("/list")
+    public String list(Model model) {
+        model.addAttribute("bins", binService.getAllBins());
+        return "admin/bins"; // JSP: /WEB-INF/views/admin/bins.jsp
+    }
+
+    // Form thêm mới
+    @GetMapping("/new")
+    public String showCreateForm(Model model) {
+        model.addAttribute("bin", new Bin());
+        model.addAttribute("wards", wardRepository.findAll());
+        return "admin/bin-add";
+    }
+
+    // Submit thêm mới
+    @PostMapping
+    public String create(@ModelAttribute("bin") Bin bin,
+                         RedirectAttributes ra,
+                         Model model) {
+        try {
+            binService.saveOrUpdateBin(bin);
+            ra.addFlashAttribute("success", "Thêm thùng rác thành công");
+            return "redirect:/admin/bins/list";
+        } catch (Exception e) {
+            model.addAttribute("wards", wardRepository.findAll());
+            model.addAttribute("error", e.getMessage());
+            return "admin/bin-add";
+        }
+    }
+
+    // Form edit
+    @GetMapping("/{id}/edit")
+    public String showEdit(@PathVariable int id, Model model, RedirectAttributes ra) {
+        Bin b = binService.getBinById(id);
+        if (b == null) {
+            ra.addFlashAttribute("error", "Không tìm thấy BinID=" + id);
+            return "redirect:/admin/bins/list";
+        }
+        model.addAttribute("bin", b);
+        model.addAttribute("wards", wardRepository.findAll());
+        return "admin/bin-edit";
+    }
+
+    // Submit update
+    @PostMapping("/{id}/update")
+    public String doUpdate(@PathVariable int id,
+                           @ModelAttribute("bin") Bin form,
+                           RedirectAttributes ra,
+                           Model model) {
+        try {
+            binService.updateBin(id, form);
+            ra.addFlashAttribute("success", "Cập nhật thành công");
+            return "redirect:/admin/bins/list";
+        } catch (Exception e) {
+            model.addAttribute("wards", wardRepository.findAll());
+            model.addAttribute("error", e.getMessage());
+            return "admin/bin-edit";
+        }
+    }
+
+    // Xoá
+    @PostMapping("/{id}/delete")
+    public String doDelete(@PathVariable int id, RedirectAttributes ra) {
+        try {
+            binService.delete(id);
+            ra.addFlashAttribute("success", "Đã xoá BinID=" + id);
+        } catch (Exception e) {
+            ra.addFlashAttribute("error", "Không thể xoá: " + e.getMessage());
+        }
+        return "redirect:/admin/bins/list";
+    }
+    @org.springframework.web.bind.annotation.InitBinder
+    public void initBinder(org.springframework.web.bind.WebDataBinder binder) {
+        // Không cho client bind vào binCode từ request (kể cả ai đó tự tạo field ẩn)
+        binder.setDisallowedFields("binCode");
+    }
+
+}
Index: src/main/java/com/example/controller/RegisterManagerController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/controller/RegisterManagerController.java b/src/main/java/com/example/controller/RegisterManagerController.java
new file mode 100644
--- /dev/null	(date 1761372868400)
+++ b/src/main/java/com/example/controller/RegisterManagerController.java	(date 1761372868400)
@@ -0,0 +1,73 @@
+package com.example.controller;
+
+import com.example.repository.WardRepository;
+import com.example.service.FileStorageService;
+import com.example.service.ManagerApplicationService;
+import org.springframework.beans.factory.annotation.Autowired;
+import org.springframework.stereotype.Controller;
+import org.springframework.ui.Model;
+import org.springframework.util.StringUtils;
+import org.springframework.web.bind.annotation.*;
+import org.springframework.web.multipart.MultipartFile;
+
+@Controller
+public class RegisterManagerController {
+
+    @Autowired
+    private WardRepository wardRepository;
+
+    @Autowired
+    private FileStorageService fileStorageService;
+
+    @Autowired
+    private ManagerApplicationService managerApplicationService;
+
+    @GetMapping("/register-manager")
+    public String showForm(Model model) {
+        model.addAttribute("wards", wardRepository.findAllByOrderByWardNameAsc());
+        // Trả về đúng view theo cây thư mục của bạn: /WEB-INF/views/manager/register-manager.jsp
+        return "manage/register-manager";
+    }
+
+    @PostMapping("/register-manager")
+    public String submit(
+            @RequestParam String fullName,
+            @RequestParam String email,
+            @RequestParam(required = false) String phone,
+            @RequestParam(required = false) String address,
+            @RequestParam int wardID,
+            @RequestParam("contractFile") MultipartFile contractFile,
+            @RequestParam("cmndFile") MultipartFile cmndFile,
+            Model model
+    ) {
+        // Validate cơ bản
+        if (!StringUtils.hasText(fullName) || !StringUtils.hasText(email) || wardID <= 0) {
+            model.addAttribute("error", "Vui lòng nhập đầy đủ Họ tên, Email và chọn Phường.");
+            model.addAttribute("wards", wardRepository.findAllByOrderByWardNameAsc());
+            return "manage/register-manager";
+        }
+
+        try {
+            // Lưu file
+            String contractPath = fileStorageService.save(contractFile, "contracts");
+            String cmndPath     = fileStorageService.save(cmndFile, "idcards");
+
+            // Ghi đơn đăng ký
+            managerApplicationService.submitApplication(
+                    fullName, email, phone, address, wardID, contractPath, cmndPath
+            );
+
+            model.addAttribute("message", "Đã gửi đơn đăng ký. Vui lòng chờ Admin xét duyệt.");
+        } catch (IllegalArgumentException ex) {
+            // Lỗi do mình chủ động ném ra (size/định dạng)
+            model.addAttribute("error", ex.getMessage());
+        } catch (Exception ex) {
+            // Lỗi khác (IO, v.v.)
+            model.addAttribute("error", "Có lỗi khi upload/lưu dữ liệu. Vui lòng thử lại.");
+        }
+
+        // Luôn nạp lại danh sách phường cho view
+        model.addAttribute("wards", wardRepository.findAllByOrderByWardNameAsc());
+        return "manage/register-manager";
+    }
+}
Index: src/main/java/com/example/controller/AdminOverviewController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/controller/AdminOverviewController.java b/src/main/java/com/example/controller/AdminOverviewController.java
new file mode 100644
--- /dev/null	(date 1761372868399)
+++ b/src/main/java/com/example/controller/AdminOverviewController.java	(date 1761372868399)
@@ -0,0 +1,33 @@
+package com.example.controller;
+
+import com.example.model.Bin;
+import com.example.service.BinService;
+import org.springframework.beans.factory.annotation.Autowired;
+import org.springframework.stereotype.Controller;
+import org.springframework.ui.Model;
+import org.springframework.web.bind.annotation.GetMapping;
+
+import java.util.List;
+
+@Controller
+public class AdminOverviewController {
+
+    @Autowired
+    private BinService binService;
+
+    // ✅ Khi bấm vào Dashboard hoặc truy cập /admin/overview
+    @GetMapping("/admin/overview")
+    public String showDashboard(Model model) {
+        // Lấy toàn bộ danh sách thùng rác
+        List<Bin> bins = binService.getAllBins();
+
+        model.addAttribute("bins", bins);
+        model.addAttribute("totalBins", bins.size());
+        model.addAttribute("alertCount", bins.stream()
+                .filter(b -> b.getCurrentFill() >= 80)
+                .count());
+        model.addAttribute("newReports", 0);
+
+        return "admin/overview"; // 👉 Trỏ tới file JSP bạn vừa gửi
+    }
+}
Index: src/main/java/com/example/repository/TaskGateway.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/repository/TaskGateway.java b/src/main/java/com/example/repository/TaskGateway.java
new file mode 100644
--- /dev/null	(date 1761372868402)
+++ b/src/main/java/com/example/repository/TaskGateway.java	(date 1761372868402)
@@ -0,0 +1,21 @@
+package com.example.repository;
+
+import org.springframework.stereotype.Repository;
+
+import javax.persistence.EntityManager;
+import javax.persistence.PersistenceContext;
+
+@Repository
+public class TaskGateway {
+
+    @PersistenceContext
+    private EntityManager em;
+
+    public long countByBinId(int binId) {
+        Number n = (Number) em.createNativeQuery(
+                        "SELECT COUNT(*) FROM Tasks WHERE BinID = :binId"
+                ).setParameter("binId", binId)
+                .getSingleResult();
+        return n.longValue();
+    }
+}
Index: src/main/java/com/example/repository/ChatRepository.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/repository/ChatRepository.java b/src/main/java/com/example/repository/ChatRepository.java
new file mode 100644
--- /dev/null	(date 1761372868402)
+++ b/src/main/java/com/example/repository/ChatRepository.java	(date 1761372868402)
@@ -0,0 +1,18 @@
+package com.example.repository;
+
+import com.example.model.Chat;
+import com.example.model.Account;
+import org.springframework.data.jpa.repository.JpaRepository;
+import org.springframework.stereotype.Repository;
+
+import java.util.List;
+
+@Repository
+public interface ChatRepository extends JpaRepository<Chat, Integer> {
+    List<Chat> findBySenderAndReceiverOrderBySentAtAsc(Account sender, Account receiver);
+    List<Chat> findByReceiverAndSenderOrderBySentAtAsc(Account receiver, Account sender);
+    // 1 chiều
+
+    // đếm chưa đọc (from -> to)
+    long countByReceiverAndSenderAndIsReadFalse(Account receiver, Account sender);
+}
Index: src/main/webapp/WEB-INF/views/manage/register-manager.jsp
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/webapp/WEB-INF/views/manage/register-manager.jsp b/src/main/webapp/WEB-INF/views/manage/register-manager.jsp
new file mode 100644
--- /dev/null	(date 1761372868407)
+++ b/src/main/webapp/WEB-INF/views/manage/register-manager.jsp	(date 1761372868407)
@@ -0,0 +1,337 @@
+<%@ page contentType="text/html;charset=UTF-8" language="java" %>
+<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
+<!DOCTYPE html>
+<html lang="vi">
+<head>
+    <meta charset="UTF-8">
+    <title>Đăng ký Manager - SmartBin</title>
+    <meta name="viewport" content="width=device-width, initial-scale=1">
+    <!-- Bootstrap & Icons -->
+    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
+    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
+    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
+
+    <style>
+        :root{
+            --primary-green:#22c55e;
+            --secondary-green:#16a34a;
+            --light-green:#f0fdf4;
+            --border-green:#d1fae5;
+            --text-green:#166534;
+            --muted-green:#6b7280;
+            --white:#ffffff;
+            --light-gray:#f9fafb;
+            --border-gray:#e5e7eb;
+            --text-dark:#111827;
+            --danger:#ef4444;
+            --success:#10b981;
+        }
+
+        *{ box-sizing:border-box; }
+        html,body{ height:100%; margin:0; padding:0; }
+        body{
+            font-family:'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
+            background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 40%, #d1fae5 100%);
+            color: var(--text-dark);
+            line-height: 1.6;
+        }
+
+        /* Background Pattern */
+        .background-pattern{
+            position:fixed; inset:0; z-index:-1;
+            background-image:
+                    radial-gradient(circle at 25% 25%, rgba(34,197,94,.10) 0%, transparent 50%),
+                    radial-gradient(circle at 75% 75%, rgba(16,185,129,.08) 0%, transparent 50%),
+                    radial-gradient(circle at 50% 50%, rgba(34,197,94,.05) 0%, transparent 70%);
+            background-size:600px 600px, 800px 800px, 1000px 1000px;
+            animation: float 20s ease-in-out infinite;
+        }
+        @keyframes float{
+            0%,100%{ transform:translate(0,0) rotate(0deg); }
+            33%{ transform:translate(30px,-30px) rotate(1deg); }
+            66%{ transform:translate(-20px,20px) rotate(-1deg); }
+        }
+
+        /* Container */
+        .auth-container{
+            min-height:100vh; display:flex; align-items:center; justify-content:center; padding:24px;
+        }
+
+        /* Card (tái dùng style login-card) */
+        .form-card{
+            width:100%; max-width:720px; background:var(--white);
+            border:1px solid var(--border-gray); border-radius:20px; overflow:hidden; position:relative;
+            box-shadow:0 20px 25px -5px rgba(0,0,0,.1), 0 10px 10px -5px rgba(0,0,0,.04);
+            padding:40px 36px;
+        }
+        .form-card::before{
+            content:''; position:absolute; top:0; left:0; right:0; height:4px;
+            background:linear-gradient(90deg, var(--primary-green), var(--secondary-green));
+        }
+
+        /* Brand */
+        .brand-section{ text-align:center; margin-bottom:24px; }
+        .brand-logo{
+            width:64px; height:64px; margin:0 auto 12px; border-radius:16px;
+            display:flex; align-items:center; justify-content:center;
+            background:var(--light-green); border:1px solid var(--border-green);
+        }
+        .brand-logo i{ font-size:32px; color:var(--primary-green); }
+        .brand-name{ font-size:24px; font-weight:700; letter-spacing:-.025em; margin:0; }
+        .brand-tagline{ color:var(--muted-green); font-size:14px; margin:4px 0 0; }
+
+        /* Title */
+        .form-title{ font-size:28px; font-weight:700; text-align:center; margin:16px 0 8px; letter-spacing:-.025em; }
+        .form-sub{ text-align:center; color:var(--muted-green); margin-bottom:24px; }
+
+        /* Form */
+        .form-label{ font-weight:600; color:var(--text-dark); margin-bottom:8px; font-size:14px; }
+        .form-control, .form-select{
+            padding:14px 14px; border:1px solid var(--border-gray); border-radius:10px; font-size:16px; background:var(--white);
+            transition:all .2s ease;
+        }
+        .form-control::placeholder{ color:var(--muted-green); }
+        .form-control:focus, .form-select:focus{
+            outline:none; border-color:var(--primary-green); box-shadow:0 0 0 3px rgba(34,197,94,.1);
+        }
+
+        /* Alert */
+        .alert{ border-radius:10px; border:none; padding:16px; display:flex; align-items:flex-start; gap:12px; }
+        .alert-danger{ background:#fef2f2; color:#b91c1c; border:1px solid #fecaca; }
+        .alert-success{ background:var(--light-green); color:var(--text-green); border:1px solid var(--border-green); }
+        .btn-close{
+            background:none; border:none; font-size:20px; margin-left:auto; cursor:pointer;
+        }
+
+        /* Buttons */
+        .btn-primary{
+            --bs-btn-bg: var(--primary-green);
+            --bs-btn-border-color: var(--primary-green);
+            --bs-btn-hover-bg: var(--secondary-green);
+            --bs-btn-hover-border-color: var(--secondary-green);
+            --bs-btn-active-bg: var(--secondary-green);
+            --bs-btn-active-border-color: var(--secondary-green);
+            border-radius:10px; padding:14px 16px; font-weight:600;
+            display:inline-flex; align-items:center; gap:8px;
+            box-shadow:none; transition:transform .15s ease, box-shadow .2s ease;
+        }
+        .btn-primary:hover{ transform:translateY(-1px); box-shadow:0 10px 20px rgba(34,197,94,.25); }
+        .btn-outline-success{
+            border-color:var(--border-green); color:var(--text-green); background:var(--light-green);
+        }
+        .btn-outline-success:hover{ background:#dcfce7; border-color:#86efac; color:var(--text-green); }
+
+        /* Divider */
+        .divider{ display:flex; align-items:center; color:var(--muted-green); font-size:14px; margin:16px 0 8px; }
+        .divider::before, .divider::after{ content:''; flex:1; height:1px; background:var(--border-gray); }
+        .divider span{ padding:0 12px; background:var(--white); }
+
+        /* Grid */
+        .g-16{ gap:16px; }
+
+        /* Loading */
+        .btn-primary .spinner{
+            width:20px; height:20px; border:2px solid rgba(255,255,255,.3); border-radius:50%;
+            border-top-color:#fff; animation:spin 1s linear infinite; display:none;
+        }
+        @keyframes spin{ to{ transform:rotate(360deg); } }
+        .btn-primary:disabled{ opacity:.7; cursor:not-allowed; }
+
+        /* Responsive */
+        @media (max-width: 640px){
+            .form-card{ padding:28px 22px; border-radius:16px; }
+            .form-title{ font-size:24px; }
+        }
+
+        /* Focus visible */
+        .btn-primary:focus-visible, .form-control:focus-visible, .form-select:focus-visible, a:focus-visible{
+            outline:2px solid var(--primary-green);
+            outline-offset:2px;
+        }
+    </style>
+</head>
+<body>
+<div class="background-pattern"></div>
+
+<div class="auth-container">
+    <div class="form-card">
+        <!-- Brand -->
+        <div class="brand-section">
+            <div class="brand-logo">
+                <i class="bi bi-recycle"></i>
+            </div>
+            <h1 class="brand-name">SmartBin</h1>
+            <p class="brand-tagline">Hệ thống quản lý thùng rác thông minh</p>
+        </div>
+
+        <!-- Title -->
+        <h2 class="form-title">Đăng ký trở thành Manager</h2>
+        <p class="form-sub">Điền thông tin bên dưới và tải lên hồ sơ theo yêu cầu.</p>
+
+        <!-- Alerts -->
+        <c:if test="${not empty error}">
+            <div class="alert alert-danger" role="alert">
+                <i class="bi bi-exclamation-triangle mt-1"></i>
+                <div>
+                    <strong>Gửi đơn thất bại!</strong><br/>
+                        ${error}
+                </div>
+                <button type="button" class="btn-close" onclick="this.parentElement.remove()">
+                    <i class="bi bi-x"></i>
+                </button>
+            </div>
+        </c:if>
+        <c:if test="${not empty message}">
+            <div class="alert alert-success" role="alert">
+                <i class="bi bi-check-circle mt-1"></i>
+                <div>${message}</div>
+                <button type="button" class="btn-close" onclick="this.parentElement.remove()">
+                    <i class="bi bi-x"></i>
+                </button>
+            </div>
+        </c:if>
+
+        <!-- Form -->
+        <form id="registerForm" action="${pageContext.request.contextPath}/register-manager" method="post" enctype="multipart/form-data" autocomplete="on">
+            <c:if test="${_csrf != null}">
+                <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
+            </c:if>
+
+            <div class="row g-3 g-16">
+                <div class="col-12">
+                    <label class="form-label" for="fullName">Họ và tên</label>
+                    <input type="text" id="fullName" name="fullName" class="form-control" placeholder="Nguyễn Văn A" required autocomplete="name">
+                </div>
+
+                <div class="col-12 col-md-6">
+                    <label class="form-label" for="email">Email cá nhân</label>
+                    <input type="email" id="email" name="email" class="form-control" placeholder="email@domain.com" required autocomplete="email">
+                </div>
+
+                <div class="col-12 col-md-6">
+                    <label class="form-label" for="phone">Số điện thoại</label>
+                    <input type="text" id="phone" name="phone" class="form-control" placeholder="09xx xxx xxx" autocomplete="tel">
+                </div>
+
+                <div class="col-12">
+                    <label class="form-label" for="address">Địa chỉ</label>
+                    <input type="text" id="address" name="address" class="form-control" placeholder="Số nhà, đường, phường/xã, quận/huyện, tỉnh/thành">
+                </div>
+
+                <div class="col-12 col-md-6">
+                    <label class="form-label" for="wardID">Phường muốn quản lý</label>
+                    <select id="wardID" name="wardID" class="form-select" required>
+                        <option value="">-- Chọn phường --</option>
+                        <c:forEach var="w" items="${wards}">
+                            <option value="${w.wardId}">${w.wardName}</option>
+                        </c:forEach>
+                    </select>
+                </div>
+
+                <div class="col-12 col-md-6">
+                    <label class="form-label">Mẫu hợp đồng</label>
+                    <div class="d-flex gap-2">
+                        <a class="btn btn-outline-success"
+                           href="<c:url value='/assets/contracts/HopDong_SmartBin.docx'/>" download>
+                            <i class="bi bi-download"></i> Tải file mẫu
+                        </a>
+
+                    </div>
+                </div>
+
+                <div class="col-12 col-md-6">
+                    <label class="form-label" for="contractFile">Upload hợp đồng đã ký (PDF/JPG/PNG)</label>
+                    <input type="file" id="contractFile" name="contractFile" class="form-control" accept=".pdf,.jpg,.jpeg,.png" required>
+                    <small class="text-muted">Tối đa 10MB mỗi tệp.</small>
+                </div>
+
+                <div class="col-12 col-md-6">
+                    <label class="form-label" for="cmndFile">Upload CMND/CCCD (PDF/JPG/PNG)</label>
+                    <input type="file" id="cmndFile" name="cmndFile" class="form-control" accept=".pdf,.jpg,.jpeg,.png" required>
+                    <small class="text-muted">Che mờ số nếu cần để bảo mật.</small>
+                </div>
+            </div>
+
+            <div class="divider mt-4 mb-3">
+                <span>Lưu ý</span>
+            </div>
+            <ul class="mb-4" style="color:var(--muted-green);">
+                <li>Thông tin phải chính xác để xác minh.</li>
+                <li>Định dạng tệp: PDF/JPG/PNG. Không hỗ trợ HEIC.</li>
+            </ul>
+
+            <button type="submit" class="btn btn-primary w-100" id="submitBtn">
+                <span class="btn-text"><i class="bi bi-send"></i> Gửi đơn đăng ký</span>
+                <div class="spinner"></div>
+            </button>
+
+            <div class="text-center mt-3">
+                <a href="${pageContext.request.contextPath}/login" class="link-success" style="text-decoration:none; font-weight:600;">
+                    <i class="bi bi-box-arrow-in-right"></i> Quay lại đăng nhập
+                </a>
+            </div>
+        </form>
+    </div>
+</div>
+
+<script>
+    // Loading state
+    document.getElementById('registerForm').addEventListener('submit', function() {
+        const btn = document.getElementById('submitBtn');
+        const text = btn.querySelector('.btn-text');
+        const spinner = btn.querySelector('.spinner');
+        btn.disabled = true;
+        text.style.display = 'none';
+        spinner.style.display = 'block';
+
+        // Phòng trường hợp treo
+        setTimeout(() => {
+            btn.disabled = false;
+            text.style.display = 'inline-flex';
+            spinner.style.display = 'none';
+        }, 4000);
+    });
+
+    // Auto-dismiss alerts
+    document.addEventListener('DOMContentLoaded', function() {
+        const alerts = document.querySelectorAll('.alert');
+        alerts.forEach(alert => {
+            setTimeout(() => {
+                if (alert.parentElement) {
+                    alert.style.opacity = '0';
+                    alert.style.transform = 'translateY(-10px)';
+                    setTimeout(() => alert.remove(), 300);
+                }
+            }, 5000);
+        });
+    });
+
+    // Nhấn chọn file → hiển thị tên file đẹp hơn
+    ['contractFile','cmndFile'].forEach(id=>{
+        const el = document.getElementById(id);
+        el.addEventListener('change', function(){
+            if(this.files && this.files.length>0){
+                this.title = Array.from(this.files).map(f=>f.name).join(', ');
+            }
+        });
+    });
+
+    // Viền đỏ khi trống (UX giống login)
+    const inputs = document.querySelectorAll('.form-control, .form-select');
+    inputs.forEach(input=>{
+        input.addEventListener('blur', function(){
+            if ((this.type === 'file' && this.files.length === 0) || (this.value || '').trim() === '') {
+                this.style.borderColor = '#ef4444';
+            } else {
+                this.style.borderColor = '#d1fae5';
+            }
+        });
+        input.addEventListener('focus', function(){
+            this.style.borderColor = '#22c55e';
+        });
+    });
+</script>
+
+<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
+</body>
+</html>
Index: src/main/java/com/example/repository/ManagerApplicationRepository.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/example/repository/ManagerApplicationRepository.java b/src/main/java/com/example/repository/ManagerApplicationRepository.java
new file mode 100644
--- /dev/null	(date 1761372868402)
+++ b/src/main/java/com/example/repository/ManagerApplicationRepository.java	(date 1761372868402)
@@ -0,0 +1,13 @@
+package com.example.repository;
+
+import com.example.model.ManagerApplication;
+import org.springframework.data.jpa.repository.JpaRepository;
+
+import java.util.List;
+
+public interface ManagerApplicationRepository extends JpaRepository<ManagerApplication, Integer> {
+
+    List<ManagerApplication> findByStatus(int status);
+
+    ManagerApplication findByApplicationId(int applicationId);
+}
